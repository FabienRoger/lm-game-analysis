["The", " RAND", "()", " function", " in", " SQL", " Server", " is", " a", " basically", " a", " pseudo", " random", " number", " generator", ".", " In", " reality", ",", " there", " is", " no", " such", " thing", " as", " a", " random", " number", " but", " using", " this", " function", " allows", " you", " to", " retrieve", " a", " randomly", " generated", " FL", "O", "AT", " value", " between", " 0", " and", " 1", ".", " Though", " the", " uses", " for", " this", " function", " are", " somewhat", " limited", " I", " recently", " spent", " some", " time", " tink", "ering", " with", " this", " function", " in", " an", " attempt", " to", " select", " random", " values", " from", " a", " table", ".", "\n", "\n", "Why", ",", " you", " might", " ask", "?", " Well", ",", " first", " and", " foremost", " I", " was", " bored", " and", " looking", " to", " kill", " some", " time", ".", " Though", " I", " didn", "\ufffd", "\ufffd", "t", " set", " out", " to", " build", " anything", " \ufffd", "\ufffd", "use", "ful", "\ufffd", "\ufffd", ",", " I", " ended", " up", " with", " an", " interesting", " tool", " for", " randomly", " selecting", " restaurants", " from", " a", " table", " I", " had", " populated", ".", " In", " the", " end", " I", " thought", ",", " at", " the", " very", " least", ",", " this", " could", " make", " an", " interesting", " post", " detailing", " how", " to", " better", " use", " the", " RAND", "()", " function", " to", " work", " with", " actual", " data", ",", " not", " just", " random", " FL", "O", "AT", " values", ".", "\n", "\n", "Before", " I", " get", " around", " to", " explaining", " the", " details", " of", " the", " script", " we", "\ufffd", "\ufffd", "ll", " need", " to", " create", " a", " database", " table", " to", " store", " the", " data", " that", " will", " be", " referenced", ".", " As", " mentioned", " above", ",", " I", "\ufffd", "\ufffd", "m", " illustrating", " this", " concept", " by", " using", " the", " RAND", "()", " function", " to", " randomly", " select", " a", " restaurant", " from", " a", " table", " containing", " a", " list", " of", " restaurants", ".", "\n", "\n", "The", " following", " script", " will", " create", " the", " necessary", " table", ".", "\n", "\n", "Create", " Restaur", "ants", " Table", " /*", "Create", " Restaur", "ants", " Table", "*/", " CRE", "ATE", " TABLE", " Restaur", "ants", " (", " ID", " INT", "EG", "ER", " ID", "ENT", "ITY", "(", "1", ",", "1", ")", " PR", "IM", "ARY", " KEY", ",", " R", "_", "Name", " V", "ARCH", "AR", "(", "50", "),", " FRE", "QU", "ENCY", " INT", "EG", "ER", " )", " 1", " 2", " 3", " 4", " 5", " 6", " /*", "Create", " Restaur", "ants", " Table", "*/", " CRE", "ATE", " TABLE", " Restaur", "ants", " (", " ID", " INT", "EG", "ER", " ID", "ENT", "ITY", " (", " 1", ",", " 1", " )", " PR", "IM", "ARY", " KEY", ",", " R", "_", "Name", " V", "ARCH", "AR", " (", " 50", " )", ",", " FRE", "QU", "ENCY", " INT", "EG", "ER", " )", "\n", "\n", "This", " script", " will", " create", " a", " table", " named", " Restaur", "ants", " with", " three", " columns", ".", " The", " first", " is", " an", " auto", "-", "incre", "ment", "ing", " identity", " column", " to", " act", " as", " the", " primary", " key", ".", " Though", " having", " a", " PK", " for", " this", " example", " is", " probably", " over", "kill", ",", " it", "\ufffd", "\ufffd", "s", " never", " a", " bad", " idea", " to", " keep", " best", " practices", " in", " play", ".", " The", " R", "_", "Name", " column", " stores", " the", " restaurant", " name", " and", " the", " FRE", "QU", "ENCY", " column", " will", " keep", " track", " of", " how", " often", " that", " record", " is", " retrieved", ".", "\n", "\n", "Once", " the", " table", " has", " been", " created", " the", " next", " step", " is", " to", " populate", " it", " with", " some", " data", ".", " The", " following", " script", " will", " insert", " 10", " records", " into", " the", " newly", " created", " Restaur", "ants", " table", ".", "\n", "\n", "Add", " Restaur", "ants", " to", " Table", " /*", "Add", " Restaur", "ants", " to", " Table", "*/", " INS", "ERT", " INTO", " d", "bo", ".", "Rest", "aur", "ants", " (", "R", "_", "Name", ",", " FRE", "QU", "ENCY", ")", " VAL", "UES", " ('", "Apple", "bees", "',", " 0", "),", " ('", "Ch", "il", "is", "',", " 0", "),", " ('", "In", "-", "N", "-", "Out", " Burger", "',", " 0", "),", " ('", "Five", " Guys", "',", " 0", "),", " ('", "Carl", "s", " Jr", "',", " 0", "),", " ('", "Ruby", " Tuesday", "',", " 0", "),", " ('", "Bad", " D", "add", "ys", " Burger", " Bar", "',", " 0", "),", " ('", "Mc", "Al", "isters", " Del", "i", "',", " 0", "),", " ('", "East", " Coast", " Wings", "',", " 0", "),", " ('", "Jer", "sey", " M", "ikes", "',", " 0", ")", " 1", " 2", " 3", " 4", " 5", " 6", " 7", " 8", " 9", " 10", " 11", " 12", " 13", " 14", " /*", "Add", " Restaur", "ants", " to", " Table", "*/", " INS", "ERT", " INTO", " d", "bo", ".", " Restaur", "ants", " (", " R", "_", "Name", ",", " FRE", "QU", "ENCY", " )", " VAL", "UES", " (", " '", "Apple", "bees", "'", ",", " 0", " )", ",", " (", " '", "Ch", "il", "is", "'", ",", " 0", " )", ",", " (", " '", "In", "-", "N", "-", "Out", " Burger", "'", ",", " 0", " )", ",", " (", " '", "Five", " Guys", "'", ",", " 0", " )", ",", " (", " '", "Carl", "s", " Jr", "'", ",", " 0", " )", ",", " (", " '", "Ruby", " Tuesday", "'", ",", " 0", " )", ",", " (", " '", "Bad", " D", "add", "ys", " Burger", " Bar", "'", ",", " 0", " )", ",", " (", " '", "Mc", "Al", "isters", " Del", "i", "'", ",", " 0", " )", ",", " (", " '", "East", " Coast", " Wings", "'", ",", " 0", " )", ",", " (", " '", "Jer", "sey", " M", "ikes", "'", ",", " 0", " )", "\n", "\n", "Once", " you", " have", " run", " the", " above", " script", " you", " should", " see", " the", " following", " data", " in", " your", " table", ".", "\n", "\n", "Now", " that", " the", " table", " has", " been", " populated", " it", "\ufffd", "\ufffd", "s", " time", " to", " take", " a", " look", " at", " how", " we", " can", " use", " the", " RAND", "()", " function", " to", " pick", " a", " random", " (", "pse", "udo", "-", "random", ")", " record", " from", " the", " table", ".", "\n", "\n", "I", " have", " already", " taken", " the", " necessary", " steps", " to", " create", " a", " stored", " procedure", " out", " of", " the", " following", " script", ".", " I", " find", " this", " is", " more", " convenient", " than", " just", " having", " a", " SELECT", " script", " as", " it", " is", " easier", " to", " call", " the", " procedure", " than", " selecting", " the", " body", " of", " the", " script", " and", " running", " it", ",", " especially", " when", " I", " was", " running", " it", " over", " and", " over", " as", " I", " was", " experimenting", " with", " the", " logic", ".", "\n", "\n", "Create", " Procedure", " pick", "_", "rest", "aur", "ant", " /*", "Create", " Procedure", "*/", " CRE", "ATE", " PROC", "ED", "URE", " [", "d", "bo", "]", ".[", "pick", "_", "rest", "aur", "ant", "]", " AS", " DEC", "L", "ARE", " @", "count", " INT", ",", " @", "result", " INT", ",", " @", "fre", "q", " INT", " SET", " @", "count", " =", " (", "SELECT", " C", "OUNT", "(", "r", "_", "name", ")", " FROM", " restaurants", ")+", "1", " SET", " @", "result", " =", " (", "SELECT", " FL", "O", "OR", "(", "R", "AND", "()", "*", "(", "@", "count", "-", "1", ")+", "1", "))", " SET", " @", "fre", "q", " =", " (", "SELECT", " FRE", "QU", "ENCY", " FROM", " Restaur", "ants", " WHERE", " ID", " =", " @", "result", ")+", "1", " UPDATE", " Restaur", "ants", " SET", " Frequency", " =", " @", "fre", "q", " WHERE", " ID", " =", " @", "result", " SELECT", " r", "_", "Name", ",", " Frequency", " FROM", " d", "bo", ".", "rest", "aur", "ants", " WHERE", " ID", " =", " @", "result", " 1", " 2", " 3", " 4", " 5", " 6", " 7", " 8", " 9", " 10", " 11", " 12", " 13", " 14", " 15", " 16", " /*", "Create", " Procedure", "*/", " CRE", "ATE", " PROC", "ED", "URE", " [", " d", "bo", " ]", ".", " [", " pick", "_", "rest", "aur", "ant", " ]", " AS", " DEC", "L", "ARE", " @", " count", " INT", ",", " @", " result", " INT", ",", " @", " fre", "q", " INT", " SET", " @", " count", " =", " (", " SELECT", " C", "OUNT", " (", " r", "_", "name", " )", " FROM", " restaurants", " )", " +", " 1", " SET", " @", " result", " =", " (", " SELECT", " FL", "O", "OR", " (", " RAND", " (", " )", " *", " (", " @", " count", " -", " 1", " )", " +", " 1", " )", " )", " SET", " @", " fre", "q", " =", " (", " SELECT", " FRE", "QU", "ENCY", " FROM", " Restaur", "ants", " WHERE", " ID", " =", " @", " result", " )", " +", " 1", " UPDATE", " Restaur", "ants", " SET", " Frequency", " =", " @", " fre", "q", " WHERE", " ID", " =", " @", " result", " SELECT", " r", "_", "Name", ",", " Frequency", " FROM", " d", "bo", ".", " restaurants", " WHERE", " ID", " =", " @", " result", "\n", "\n", "Once", " the", " procedure", " has", " been", " created", " you", " can", " call", " it", " using", " the", " following", " script", ".", " Go", " ahead", " and", " run", " it", " a", " few", " times", ".", " This", " will", " begin", " pop", "ulating", " the", " FRE", "QU", "ENCY", " column", " with", " the", " number", " of", " times", " any", " given", " record", " has", " been", " retrieved", ".", "\n", "\n", "EX", "EC", " pick", "_", "rest", "aur", "ant", " 1", " EX", "EC", " pick", "_", "rest", "aur", "ant", "\n", "\n", "To", " better", " understand", " what", " this", " procedure", " is", " actually", " doing", " let", "\ufffd", "\ufffd", "s", " break", " it", " down", " into", " four", " parts", ".", " The", " DEC", "L", "ARE", ",", " SET", ",", " UPDATE", " and", " SELECT", ".", "\n", "\n", "In", " the", " DEC", "L", "ARE", " I", " have", " create", " three", " parameters", ",", " @", "count", ",", " @", "result", ",", " and", " @", "fre", "q", ",", " all", " INT", "EG", "ER", " values", ".", " These", " will", " be", " used", " by", " the", " next", " part", " of", " the", " script", " to", " pre", "form", " some", " basic", " calculations", " which", " will", " result", " in", " the", " random", " record", " being", " selected", ".", "\n", "\n", "In", " the", " second", " part", " of", " the", " script", " I", " am", " setting", " the", " value", " of", " each", " parameter", ".", " For", " @", "count", " I", " am", " simply", " counting", " the", " number", " of", " records", " that", " exist", " in", " the", " restaurants", " table", " and", " adding", " 1", " to", " that", " value", ".", " This", " allows", " all", " records", " to", " be", " considered", " when", " the", " script", " executes", ".", "\n", "\n", "The", " @", "result", " SET", " is", " where", " the", " RAND", "()", " function", " is", " being", " called", ".", " Here", " I", " am", " calling", " the", " RAND", "()", " function", " alongside", " the", " FL", "O", "OR", " function", " in", " order", " to", " ensure", " that", " 0", " is", " initially", " returned", " before", " the", " additional", " calculations", " are", " made", ".", " This", " essentially", " ins", "ures", " a", " non", " decimal", " value", " is", " being", " used", ".", " The", " tail", " end", " piece", " of", " that", " code", " then", " takes", " the", " @", "count", " parameter", " and", " subtract", "s", " 1", ",", " then", " adds", " 1", " after", " the", " closing", " parent", "hesis", ".", " This", " adds", " some", " additional", " logic", " to", " the", " random", " number", " generation", " process", " to", " further", " random", "ize", " as", " well", " as", " insure", " that", " all", " records", " are", " available", " as", " possible", " result", " set", ".", "\n", "\n", "The", " final", " SET", " command", " determines", " the", " new", " frequency", " value", " for", " the", " record", " that", " was", " selected", " by", " simply", " selecting", " the", " current", " value", " and", " adding", " 1", ".", "\n", "\n", "The", " third", " piece", " of", " the", " script", " simply", " updates", " the", " FRE", "QU", "ENCY", " column", " based", " on", " the", " @", "fre", "q", " value", " that", " was", " determined", " in", " the", " previous", " step", ".", "\n", "\n", "Finally", " the", " script", " returns", " the", " r", "_", "Name", " and", " Frequency", " of", " the", " record", " selected", " by", " the", " script", ".", " After", " running", " the", " script", " numerous", " times", " you", " can", " see", " that", " the", " frequency", " is", " being", " updated", " each", " time", " a", " particular", " record", " is", " called", ".", "\n", "\n", "The", " more", " data", " you", " include", " in", " your", " data", " set", " (", "or", " table", " in", " this", " case", ")", " the", " more", " variable", " the", " RAND", "()", " function", " becomes", ".", "\n", "\n", "Though", " I", " struggle", " to", " see", " a", " real", " world", " solution", " for", " this", " I", " thought", " it", " was", " an", " interesting", " experiment", " and", " a", " fun", " way", " to", " utilize", " the", " RAND", "()", " function", " in", " a", " way", " that", " wasn", "\ufffd", "\ufffd", "t", " just", " returning", " a", " random", " decimal", " number", ".", " I", " hope", " this", " post", " has", " provided", " you", " with", " some", " insight", " or", " possibly", " a", " solution", " to", " a", " particular", " problem", " you", " were", " working", " with", ".", "\n", "\n", "Share", " This", " Article", ":", "\n\n", "\n\n", "\n", "\n", "Tweet", "\n", "\n", "Print", "\n\n"]