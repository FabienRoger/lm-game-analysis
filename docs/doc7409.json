["When", " coming", " across", " the", " term", " \ufffd", "\ufffd", "text", " search", "\ufffd", "\ufffd", ",", " one", " usually", " thinks", " of", " a", " large", " body", " of", " text", ",", " which", " is", " indexed", " in", " a", " way", " that", " makes", " it", " possible", " to", " quickly", " look", " up", " one", " or", " more", " search", " terms", " when", " they", " are", " entered", " by", " a", " user", ".", " This", " is", " a", " classic", " problem", " for", " computer", " scientists", ",", " to", " which", " many", " solutions", " exist", ".", "\n", "\n", "But", " how", " about", " a", " reverse", " scenario", "?", " What", " if", " what", "\ufffd", "\ufffd", "s", " available", " for", " index", "ing", " beforehand", " is", " a", " group", " of", " search", " phrases", ",", " and", " only", " at", " runtime", " is", " a", " large", " body", " of", " text", " presented", " for", " searching", "?", " These", " questions", " are", " what", " this", " tri", "e", " data", " structure", " tutorial", " seeks", " to", " address", ".", "\n", "\n", "Applications", "\n", "\n", "A", " real", " world", " application", " for", " this", " scenario", " is", " matching", " a", " number", " of", " medical", " the", "ses", " against", " a", " list", " of", " medical", " conditions", " and", " finding", " out", " which", " the", "ses", " discuss", " which", " conditions", ".", " Another", " example", " is", " travers", "ing", " a", " large", " collection", " of", " judicial", " preced", "ents", " and", " extracting", " the", " laws", " they", " reference", ".", "\n", "\n", "Direct", " Approach", "\n", "\n", "The", " most", " basic", " approach", " is", " to", " loop", " through", " the", " search", " phrases", ",", " and", " search", " through", " the", " text", " each", " phrase", ",", " one", " by", " one", ".", " This", " approach", " does", " not", " scale", " well", ".", " Search", "ing", " for", " a", " string", " inside", " another", " has", " the", " complexity", " O", "(", "n", ").", " Repe", "ating", " that", " for", " m", " search", " phrases", " leads", " to", " the", " awful", " O", "(", "m", " *", " n", ").", "\n", "\n", "The", " (", "likely", " only", ")", " upside", " of", " a", " direct", " approach", " that", " it", " is", " simple", " to", " implement", ",", " as", " apparent", " in", " the", " following", " C", "#", " snippet", ":", "\n", "\n", "String", "[]", " search", "_", "ph", "r", "ases", " =", " File", ".", "Read", "All", "L", "ines", " (\"", "terms", ".", "txt", "\");", " String", " text", "_", "body", " =", " File", ".", "Read", "All", "Text", "(\"", "body", ".", "txt", "\");", " int", " count", " =", " 0", ";", " fore", "ach", " (", "String", " phrase", " in", " search", "_", "ph", "r", "ases", ")", " if", " (", "text", "_", "body", ".", "Index", "Of", " (", "phrase", ")", " >=", " 0", ")", " ++", "count", ";", "\n", "\n", "Running", " this", " code", " on", " my", " development", " machine", " [", "1", "]", " against", " a", " test", " sample", " [", "2", "],", " I", " got", " a", " runtime", " of", " 1", " hour", " 14", " minutes", " \u2013", " far", " beyond", " the", " time", " you", " need", " to", " grab", " a", " cup", " of", " coffee", ",", " get", " up", " and", " stretch", ",", " or", " any", " other", " excuse", " developers", " use", " to", " skip", " work", ".", "\n", "\n", "A", " Better", " Approach", " -", " The", " T", "rie", "\n", "\n", "The", " previous", " scenario", " can", " be", " enhanced", " in", " a", " couple", " of", " ways", ".", " For", " example", ",", " the", " search", " process", " can", " be", " partition", "ed", " and", " parallel", "ized", " on", " multiple", " processors", "/", "c", "ores", ".", " But", " the", " reduction", " in", " runtime", " achieved", " by", " this", " approach", " (", "total", " runtime", " of", " 20", " minutes", " assuming", " perfect", " division", " over", " 4", " processors", "/", "c", "ores", ")", " does", " not", " justify", " the", " added", " complexity", " to", " coding", "/", "debug", "ging", ".", "\n", "\n", "The", " best", " possible", " solution", " would", " be", " one", " that", " travers", "es", " the", " text", " body", " only", " once", ".", " This", " requires", " search", " phrases", " to", " be", " indexed", " in", " a", " structure", " that", " can", " be", " trans", "vers", "ed", " lin", "early", ",", " in", " parallel", " with", " the", " text", " body", ",", " in", " one", " pass", ",", " achieving", " a", " final", " complexity", " of", " O", "(", "n", ").", "\n", "\n", "A", " data", " structure", " that", " is", " especially", " well", "-", "su", "ited", " for", " just", " this", " scenario", " is", " the", " tri", "e", ".", " This", " versatile", " data", " structure", " is", " usually", " overlooked", " and", " not", " as", " famous", " as", " other", " tree", "-", "related", " structures", " when", " it", " comes", " to", " search", " problems", ".", "\n", "\n", "T", "opt", "al", "\ufffd", "\ufffd", "s", " previous", " tutorial", " on", " tries", " provides", " an", " excellent", " introduction", " to", " how", " they", " are", " structured", " and", " used", ".", " In", " short", ",", " a", " tri", "e", " is", " a", " special", " tree", ",", " capable", " of", " storing", " a", " sequence", " of", " values", " in", " such", " a", " way", " that", " tracing", " the", " path", " from", " the", " root", " to", " any", " node", " yields", " a", " valid", " subset", " of", " that", " sequence", ".", "\n", "\n", "So", ",", " if", " we", " can", " combine", " all", " the", " search", " phrases", " into", " one", " tri", "e", ",", " where", " each", " node", " contains", " a", " word", ",", " we", " will", " have", " the", " phrases", " laid", " out", " in", " a", " structure", " where", " simply", " tracing", " from", " the", " root", " downwards", ",", " via", " any", " path", ",", " yields", " a", " valid", " search", " phrase", ".", "\n", "\n", "The", " advantage", " of", " a", " tri", "e", " is", " that", " it", " significantly", " cuts", " search", " time", ".", " To", " make", " it", " easier", " to", " grasp", " for", " the", " purposes", " of", " this", " tri", "e", " tutorial", ",", " let", "\ufffd", "\ufffd", "s", " imagine", " a", " binary", " tree", ".", " Tra", "vers", "ing", " a", " binary", " tree", " has", " the", " complexity", " of", " O", "(", "log", "2", "n", "),", " since", " each", " node", " branches", " into", " two", ",", " cutting", " the", " remaining", " travers", "al", " in", " half", ".", " As", " such", ",", " a", " ter", "n", "ary", " tree", " has", " the", " travers", "al", " complexity", " of", " O", "(", "log", "3", "n", ").", " In", " a", " tri", "e", ",", " however", ",", " the", " number", " of", " child", " nodes", " is", " dictated", " by", " the", " sequence", " it", " is", " representing", ",", " and", " in", " the", " case", " of", " readable", "/", "meaning", "ful", " text", ",", " the", " number", " of", " children", " is", " usually", " high", ".", "\n", "\n", "Text", " Search", " Al", "gorithm", "\n", "\n", "As", " a", " simple", " example", ",", " let", "\ufffd", "\ufffd", "s", " assume", " the", " following", " search", " phrases", ":", "\n", "\n", "\ufffd", "\ufffd", "same", " family", "\ufffd", "\ufffd", "\n", "\n", "\ufffd", "\ufffd", "different", " family", "\ufffd", "\ufffd", "\n", "\n", "\ufffd", "\ufffd", "separ", "ate", " existence", "\ufffd", "\ufffd", "\n", "\n", "\ufffd", "\ufffd", "members", " of", " the", " league", "\ufffd", "\ufffd", "\n", "\n", "Remember", " that", " we", " know", " our", " search", " phrases", " beforehand", ".", " So", ",", " we", " start", " by", " building", " an", " index", ",", " in", " the", " form", " of", " a", " tri", "e", ":", "\n", "\n", "Later", ",", " the", " user", " of", " our", " software", " presents", " it", " with", " a", " file", " containing", " the", " following", " text", ":", "\n", "\n", "The", " European", " languages", " are", " members", " of", " the", " same", " family", ".", " Their", " separate", " existence", " is", " a", " myth", ".", "\n", "\n", "The", " rest", " is", " quite", " simple", ".", " Our", " algorithm", " will", " have", " two", " indicators", " (", "pointers", ",", " if", " you", " like", "),", " one", " starting", " at", " the", " root", ",", " or", " \ufffd", "\ufffd", "start", "\ufffd", "\ufffd", " node", " in", " our", " tri", "e", " structure", ",", " and", " the", " other", " at", " the", " first", " word", " in", " the", " text", " body", ".", " The", " two", " indicators", " move", " along", " together", ",", " word", " by", " word", ".", " The", " text", " indicator", " simply", " moves", " forward", ",", " while", " the", " tri", "e", " indicator", " travers", "es", " the", " tri", "e", " depth", "-", "wise", ",", " following", " a", " trail", " of", " matching", " words", ".", "\n", "\n", "The", " tri", "e", " indicator", " returns", " to", " start", " in", " two", " cases", ":", " When", " it", " reaches", " the", " end", " of", " a", " branch", ",", " which", " means", " a", " search", " phrase", " has", " been", " found", ",", " or", " when", " it", " encounters", " a", " non", "-", "match", "ing", " word", ",", " in", " which", " case", " no", " match", " has", " been", " found", ".", "\n", "\n", "One", " exception", " to", " the", " movement", " of", " the", " text", " indicator", " is", " when", " a", " partial", " match", " is", " found", ",", " i", ".", "e", ".", " after", " a", " series", " of", " matches", " a", " non", "-", "match", " is", " encountered", " before", " the", " branch", " ends", ".", " In", " this", " case", " the", " text", " indicator", " is", " not", " moved", " forward", ",", " since", " the", " last", " word", " could", " be", " the", " beginning", " of", " a", " new", " branch", ".", "\n", "\n", "Let", "\ufffd", "\ufffd", "s", " apply", " this", " algorithm", " to", " our", " tri", "e", " data", " structure", " example", " and", " see", " how", " it", " goes", ":", "\n", "\n", "Step", " T", "rie", " Ind", "icator", " Text", " Ind", "icator", " Match", "?", " T", "rie", " Action", " Text", " Action", " 0", " start", " The", " -", " Move", " to", " start", " Move", " to", " next", " 1", " start", " European", " -", " Move", " to", " start", " Move", " to", " next", " 2", " start", " languages", " -", " Move", " to", " start", " Move", " to", " next", " 3", " start", " are", " -", " Move", " to", " start", " Move", " to", " next", " 4", " start", " members", " members", " Move", " to", " members", " Move", " to", " next", " 5", " members", " of", " of", " Move", " to", " of", " Move", " to", " next", " 6", " of", " the", " the", " Move", " to", " the", " Move", " to", " next", " 7", " the", " same", " -", " Move", " to", " start", " -", " 8", " start", " same", " same", " Move", " to", " same", " Move", " to", " next", " 9", " same", " family", " family", " Move", " to", " start", " Move", " to", " next", " 10", " start", " their", " -", " Move", " to", " start", " Move", " to", " next", " 11", " start", " separate", " separate", " Move", " to", " separate", " Move", " to", " next", " 12", " separate", " existence", " existence", " Move", " to", " start", " Move", " to", " next", " 13", " start", " is", " -", " Move", " to", " start", " Move", " to", " next", " 14", " start", " a", " -", " Move", " to", " start", " Move", " to", " next", " 15", " start", " myth", " -", " Move", " to", " start", " Move", " to", " next", "\n\n", "\n\n", "\n", "\n", "As", " we", " can", " see", ",", " the", " system", " successfully", " finds", " the", " two", " matching", " phrases", ",", " \ufffd", "\ufffd", "same", " family", "\ufffd", "\ufffd", " and", " \ufffd", "\ufffd", "separ", "ate", " existence", "\ufffd", "\ufffd", ".", "\n", "\n", "Real", " World", " Example", "\n", "\n", "For", " a", " recent", " project", ",", " I", " was", " presented", " with", " the", " following", " problem", ":", " a", " client", " has", " a", " large", " number", " of", " articles", " and", " PhD", " the", "ses", " relating", " to", " her", " field", " of", " work", ",", " and", " has", " generated", " her", " own", " list", " of", " phrases", " representing", " specific", " titles", " and", " rules", " relating", " to", " the", " same", " field", " of", " work", ".", "\n", "\n", "Her", " dilemma", " was", " this", ":", " given", " her", " list", " of", " phrases", ",", " how", " does", " she", " link", " the", " articles", "/", "t", "heses", " to", " those", " phrases", "?", " The", " end", " goal", " is", " to", " be", " able", " to", " randomly", " pick", " a", " group", " of", " phrases", " and", " immediately", " have", " a", " list", " of", " articles", "/", "t", "heses", " that", " mention", " those", " particular", " phrases", " ready", " for", " grabbing", ".", "\n", "\n", "As", " discussed", " previously", ",", " there", " are", " two", " parts", " to", " solving", " this", " problem", ":", " Index", "ing", " the", " phrases", " into", " a", " tri", "e", ",", " and", " the", " actual", " search", ".", " The", " following", " sections", " provide", " a", " simple", " implementation", " in", " C", "#", ".", " Please", " note", " that", " file", " handling", ",", " encoding", " issues", ",", " text", " cleanup", " and", " similar", " problems", " are", " not", " handled", " in", " these", " snippets", ",", " since", " they", " are", " out", " of", " the", " scope", " of", " this", " article", ".", "\n", "\n", "Index", "ing", "\n", "\n", "The", " index", "ing", " operation", " simply", " travers", "es", " phrases", " one", " by", " one", " and", " inserts", " them", " into", " the", " tri", "e", ",", " one", " word", " per", " node", "/", "level", ".", " N", "odes", " are", " represented", " with", " the", " following", " class", ":", "\n", "\n", "class", " Node", " {", " int", " Ph", "rase", "Id", " =", " -", "1", ";", " Dictionary", "<", "String", ",", " Node", ">", " Children", " =", " new", " Dictionary", "<", "String", ",", " Node", ">", "();", " public", " Node", "()", " {", " }", " public", " Node", "(", "int", " id", ")", " {", " Ph", "rase", "Id", " =", " id", ";", " }", " }", "\n", "\n", "Each", " phrase", " is", " represented", " by", " an", " ID", ",", " which", " can", " be", " as", " simple", " as", " an", " incremental", " number", ",", " and", " passed", " to", " the", " following", " index", "ing", " function", " (", "variable", " root", " is", " the", " actual", " root", " of", " the", " tri", "e", "):", "\n", "\n", "void", " add", "Ph", "rase", "(", "ref", " Node", " root", ",", " String", " phrase", ",", " int", " phrase", "Id", ")", " {", " //", " a", " pointer", " to", " traverse", " the", " tri", "e", " without", " damaging", " //", " the", " original", " reference", " Node", " node", " =", " root", ";", " //", " break", " phrase", " into", " words", " String", "[]", " words", " =", " phrase", ".", "Split", " ();", " //", " start", " travers", "al", " at", " root", " for", " (", "int", " i", " =", " 0", ";", " i", " <", " words", ".", "Length", ";", " ++", "i", ")", " {", " //", " if", " the", " current", " word", " does", " not", " exist", " as", " a", " child", " //", " to", " current", " node", ",", " add", " it", " if", " (", "node", ".", "Children", ".", "Cont", "ains", "Key", "(", "words", "[", "i", "])", " ==", " false", ")", " node", ".", "Children", ".", "Add", "(", "words", "[", "i", "],", " new", " Node", "());", " //", " move", " travers", "al", " pointer", " to", " current", " word", " node", " =", " node", ".", "Children", "[", "words", "[", "i", "]", "];", " //", " if", " current", " word", " is", " the", " last", " one", ",", " mark", " it", " with", " //", " phrase", " Id", " if", " (", "i", " ==", " words", ".", "Length", " -", " 1", ")", " node", ".", "Ph", "rase", "Id", " =", " phrase", "Id", ";", " }", " }", "\n", "\n", "Search", "ing", "\n", "\n", "The", " search", " process", " is", " a", " direct", " implementation", " of", " the", " tri", "e", " algorithm", " discussed", " in", " the", " tutorial", " above", ":", "\n", "\n", "void", " find", "Ph", "r", "ases", "(", "ref", " Node", " root", ",", " String", " text", "Body", ")", " {", " //", " a", " pointer", " to", " traverse", " the", " tri", "e", " without", " damaging", " //", " the", " original", " reference", " Node", " node", " =", " root", ";", " //", " a", " list", " of", " found", " ", "ids", " List", "<", "int", ">", " found", "Ph", "r", "ases", " =", " new", " List", "<", "int", ">", "();", " //", " break", " text", " body", " into", " words", " String", "[]", " words", " =", " text", "Body", ".", "Split", " ();", " //", " starting", " travers", "al", " at", " tri", "e", " root", " and", " first", " //", " word", " in", " text", " body", " for", " (", "int", " i", " =", " 0", ";", " i", " <", " words", ".", "Length", ";", ")", " {", " //", " if", " current", " node", " has", " current", " word", " as", " a", " child", " //", " move", " both", " node", " and", " words", " pointer", " forward", " if", " (", "node", ".", "Children", ".", "Cont", "ains", "Key", "(", "words", "[", "i", "]", "))", " {", " //", " move", " tri", "e", " pointer", " forward", " node", " =", " node", ".", "Children", "[", "words", "[", "i", "]", "];", " //", " move", " words", " pointer", " forward", " ++", "i", ";", " }", " else", " {", " //", " current", " node", " does", " not", " have", " current", " //", " word", " in", " its", " children", " //", " if", " there", " is", " a", " phrase", " Id", ",", " then", " the", " previous", " //", " sequence", " of", " words", " matched", " a", " phrase", ",", " add", " Id", " to", " //", " found", " list", " if", " (", "node", ".", "Ph", "rase", "Id", "!=", " -", "1", ")", " found", "Ph", "r", "ases", ".", "Add", "(", "node", ".", "Ph", "rase", "Id", ");", " if", " (", "node", " ==", " root", ")", " {", " //", " if", " tri", "e", " pointer", " is", " already", " at", " root", ",", " increment", " //", " words", " pointer", " ++", "i", ";", " }", " else", " {", " //", " if", " not", ",", " leave", " words", " pointer", " at", " current", " word", " //", " and", " return", " tri", "e", " pointer", " to", " root", " node", " =", " root", ";", " }", " }", " }", " //", " one", " case", " remains", ",", " word", " pointer", " as", " reached", " the", " end", " //", " and", " the", " loop", " is", " over", " but", " the", " tri", "e", " pointer", " is", " pointing", " to", " //", " a", " phrase", " Id", " if", " (", "node", ".", "Ph", "rase", "Id", "!=", " -", "1", ")", " found", "Ph", "r", "ases", ".", "Add", "(", "node", ".", "Ph", "rase", "Id", ");", " }", "\n", "\n", "Performance", "\n", "\n", "The", " code", " presented", " here", " is", " extracted", " from", " the", " actual", " project", " and", " has", " been", " simplified", " for", " the", " purpose", " of", " this", " document", ".", " Running", " this", " code", " again", " on", " the", " same", " machine", " [", "1", "]", " and", " against", " the", " same", " test", " sample", " [", "2", "]", " resulted", " in", " a", " runtime", " of", " 2", ".", "5", " seconds", " for", " building", " the", " tri", "e", " and", " 0", ".", "3", " seconds", " for", " the", " search", ".", " So", " much", " for", " break", " time", ",", " eh", "?", "\n", "\n", "Vari", "ations", "\n", "\n", "It", "\ufffd", "\ufffd", "s", " important", " to", " acknowledge", " that", " the", " algorithm", " as", " described", " in", " this", " tri", "e", " tutorial", " can", " fail", " in", " certain", " edge", " cases", ",", " and", " therefore", " is", " designed", " with", " pred", "efined", " search", " terms", " already", " in", " mind", ".", "\n", "\n", "For", " example", ",", " if", " the", " beginning", " of", " one", " search", " term", " is", " identical", " to", " some", " part", " of", " another", " search", " term", ",", " as", " in", ":", "\n", "\n", "\ufffd", "\ufffd", " to", " share", " and", " enjoy", " with", " friends", "\ufffd", "\ufffd", "\n", "\n", "and", " enjoy", " with", " friends", "\ufffd", "\ufffd", " \ufffd", "\ufffd", "I", " have", " two", " tickets", " to", " share", " with", " someone", "\ufffd", "\ufffd", "\n", "\n", "and", " the", " text", " body", " contains", " a", " phrase", " that", " causes", " the", " tri", "e", " pointer", " to", " start", " down", " the", " wrong", " path", ",", " such", " as", ":", "\n", "\n", "I", " have", " two", " tickets", " to", " share", " and", " enjoy", " with", " friends", ".", "\n", "\n", "then", " the", " algorithm", " will", " fail", " to", " match", " any", " term", ",", " because", " the", " tri", "e", " indicator", " will", " not", " return", " to", " the", " start", " node", " until", " the", " text", " indicator", " has", " already", " passed", " the", " beginning", " of", " the", " matching", " term", " in", " the", " text", " body", ".", "\n", "\n", "It", " is", " important", " to", " consider", " whether", " this", " sort", " of", " edge", " case", " is", " a", " possibility", " for", " your", " application", " before", " implementing", " the", " algorithm", ".", " If", " so", ",", " the", " algorithm", " can", " be", " modified", " with", " additional", " tri", "e", " indicators", " to", " track", " all", " of", " the", " matches", " at", " any", " given", " time", ",", " instead", " of", " just", " one", " match", " at", " a", " time", ".", "\n", "\n", "Conclusion", "\n", "\n", "Text", " search", " is", " a", " deep", " field", " in", " computer", " science", ";", " a", " field", " rich", " with", " problems", " and", " solutions", " alike", ".", " The", " kind", " of", " data", " I", " had", " to", " deal", " with", " (", "23", "MB", " of", " text", " is", " a", " ton", " of", " books", " in", " real", " life", ")", " might", " seem", " like", " a", " rare", " occurrence", " or", " a", " specialized", " problem", ",", " but", " developers", " who", " work", " with", " lingu", "istics", " research", ",", " arch", "iving", ",", " or", " any", " other", " type", " of", " data", " manipulation", ",", " come", " across", " much", " larger", " amounts", " of", " data", " on", " a", " regular", " basis", ".", "\n", "\n", "As", " is", " evident", " in", " the", " tri", "e", " data", " structure", " tutorial", " above", ",", " it", " is", " of", " great", " importance", " to", " carefully", " choose", " the", " correct", " algorithm", " for", " the", " problem", " at", " hand", ".", " In", " this", " particular", " case", ",", " the", " tri", "e", " approach", " cut", " the", " runtime", " by", " a", " staggering", " 99", ".", "93", "%,", " from", " over", " an", " hour", " to", " less", " than", " 3", " seconds", ".", "\n", "\n", "By", " no", " means", " is", " this", " the", " only", " effective", " approach", " out", " there", ",", " but", " it", " is", " simple", " enough", ",", " and", " it", " works", ".", " I", " hope", " you", " have", " found", " this", " algorithm", " interesting", ",", " and", " wish", " you", " the", " best", " of", " luck", " in", " your", " coding", " endeavors", ".", "\n", "\n", "[", "1", "]", " The", " machine", " used", " for", " this", " test", " has", " the", " following", " specs", ":", "\n", "\n", "Intel", " i", "7", " 47", "00", "HQ", "\n", "\n", "16", "GB", " RAM", "\n", "\n", "Testing", " was", " done", " on", " Windows", " 8", ".", "1", " using", ".", "NET", " 4", ".", "5", ".", "1", " and", " also", " Kub", "untu", " 14", ".", "04", " using", " the", " latest", " version", " of", " mono", " and", " the", " results", " were", " very", " similar", ".", "\n", "\n", "[", "2", "]", " The", " test", " sample", " consists", " of", " 280", "K", " search", " phrases", " with", " a", " total", " size", " of", " 23", ".", "5", "MB", ",", " and", " a", " text", " body", " of", " 1", ".", "5", "MB", "."]