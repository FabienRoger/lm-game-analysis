["In", " JavaScript", " nothing", " is", " what", " it", " looks", " like", ";", " you", " rarely", " work", " with", " actual", " values", ".", "\n", "\n", "Most", " of", " the", " time", " values", " morph", " from", " one", " type", " to", " another", ",", " just", " so", " they", " can", " morph", " to", " yet", " another", " type", " later", " on", ".", " That", "'s", " the", " way", " of", " language", ".", " And", " if", " that", " weren", "'t", " enough", ",", " I", " recently", " found", " that", " the", " way", " I", " was", " writing", " some", " functions", " in", " JavaScript", " was", " wrong", ".", " It", " wasn", "\ufffd", "\ufffd", "t", " particularly", " my", " fault", ",", " though", ",", " as", " it", " looks", " like", " most", " of", " us", " did", " it", " wrong", " the", " way", ".", "\n", "\n", "The", " root", " of", " evil", " is", " our", " use", " of", " the", " type", "of", " operator", ".", "\n", "\n", "L", "ets", " look", " at", " this", " example", ":", "\n", "\n", "var", " att", "r", "White", "List", " =", " /", "^", "(", "text", "|", "size", "|", "color", "|", "weight", "|", "true", ")", "$", "/", ";", " function", " set", "Att", "r", "(", "name", ",", " value", ")", " {", " if", " (", "type", "of", " name", " ==", " \"", "string", "\"", " &&", " att", "r", "White", "List", ".", "test", "(", "name", "))", " {", " this", "[", "name", "]", " =", " value", ";", " }", " else", " if", " (", "type", "of", " name", " ==", " \"", "object", "\"", " &&", " name", ")", " {", " for", " (", "var", " key", " in", " name", ")", " if", " (", "attr", "White", "List", ".", "test", "(", "key", "))", " {", " this", "[", "key", "]", " =", " name", "[", "key", "];", " }", " }", " }", "\n", "\n", "We", " can", " call", " the", " set", "Att", "r", " function", " like", " this", ":", "\n", "\n", "set", "Att", "r", "(\"", "size", "\",", " 20", ");", "\n", "\n", "or", " like", " this", ":", "\n", "\n", "set", "Att", "r", "({", "size", ":", " 20", ",", " name", ":", " \"", "Jason", "\"}", ");", "\n", "\n", "And", " when", " we", " call", " it", " successfully", " an", " attribute", " is", " set", ".", " And", " it", "\ufffd", "\ufffd", "s", " not", " only", " setting", " what", " we", " send", ",", " it", " additionally", " checks", " that", " attributes", " appear", " in", " a", " white", "-", "list", " before", " setting", " them", ".", " All", " seems", " good", ".", " Or", " is", " it", "?", "\n", "\n", "Let", "\ufffd", "\ufffd", "s", " rewrite", " the", " function", " with", " our", " revised", " view", " in", " mind", ":", "\n", "\n", "var", " att", "r", "White", "List", " =", " /", "^", "(", "text", "|", "size", "|", "color", "|", "weight", "|", "true", ")", "$", "/", ";", " function", " set", "Att", "r", "(", "name", ",", " value", ")", " {", " if", " (", "arg", "uments", ".", "length", " >", " 1", ")", " {", " if", " (", "attr", "White", "List", ".", "test", "(", "name", "))", " {", " this", "[", "name", "]", " =", " value", ";", " }", " }", " else", " if", " (", "name", " ===", " Object", "(", "name", "))", " {", " for", " (", "var", " key", " in", " name", ")", " if", " (", "attr", "White", "List", ".", "test", "(", "key", "))", " {", " this", "[", "key", "]", " =", " name", "[", "key", "];", " }", " }", " }", "\n", "\n", "Simply", ",", " our", " second", " approach", " robust", "ly", " deals", " with", " any", " parameters", " that", " the", " function", " receives", ",", " while", " the", " first", " will", " not", ":", "\n", "\n", "set", "Att", "r", "(\"", "size", "\",", " 20", ");", " set", "Att", "r", "({", "size", ":", " 20", ",", " name", ":", " \"", "Jason", "\"}", ");", "\n", "\n", "Those", " two", " work", " as", " before", ",", " but", " there", " are", " many", " parameters", " that", " the", " first", " version", " can", "\ufffd", "\ufffd", "t", " cope", " with", ":", "\n", "\n", "set", "Att", "r", "(", "true", ",", " true", ");", " var", " f", " =", " function", " ()", " {", "};", " f", ".", "size", " =", " 5", ";", " set", "Att", "r", "(", "f", ");", " set", "Att", "r", "(", "new", " String", "(\"", "text", "\"),", " \"", "Jason", "\");", " set", "Att", "r", "(", "[\"", "text", "\"],", " \"", "Jason", "\");", " set", "Att", "r", "(", "new", " Boolean", "(", "true", "),", " true", ");", " set", "Att", "r", "({", "to", "String", ":", " function", " ()", " {", "return", " \"", "text", "\";", "}", "},", " \"", "Jason", "\");", "\n", "\n", "You", "\ufffd", "\ufffd", "re", " probably", " saying", ":", " \ufffd", "\ufffd", "Nobody", " will", " write", " code", " like", " that", "\ufffd", "\ufffd", ".", " And", " you", "\ufffd", "\ufffd", "re", " probably", " right", ",", " but", " people", " could", " easily", " write", " code", " like", " this", ":", "\n", "\n", "set", "Att", "r", "(", "a", ",", " b", ");", "\n", "\n", "What", " am", " I", " trying", " to", " say", "?", " In", " JavaScript", " you", " coer", "ce", " types", " all", " the", " time", ",", " whether", " you", " intend", " to", " or", " not", ".", " You", " can", " fight", " it", ",", " or", " you", " can", " use", " it", ".", "\n", "\n", "It", " doesn", "\ufffd", "\ufffd", "t", " matter", " what", " type", " the", " variable", " is", ",", " it", "\ufffd", "\ufffd", "s", " more", " important", " how", " you", " can", " use", " it", ".", " So", ",", " for", " example", ",", " instead", " of", " asking", " \ufffd", "\ufffd", "Is", " it", " a", " number", "?", "\ufffd", "\ufffd", " it", "\ufffd", "\ufffd", "d", " be", " better", " to", " ask", " \ufffd", "\ufffd", "Is", " it", " numeric", "?", "\ufffd", "\ufffd", "\n", "\n", "var", " isn", "an", " =", " /", "^", "(", "Na", "N", "|", "-", "?", "Inf", "inity", ")", "$", "/", ";", " function", " is", "N", "umeric", "(", "num", ")", " {", " return", "!", "is", "nan", ".", "test", "(", "+", "num", ");", " }", "\n", "\n", "or", " maybe", " \ufffd", "\ufffd", "Is", " it", " object", "?", "\ufffd", "\ufffd", " or", " \ufffd", "\ufffd", "Is", " it", " array", "?", "\ufffd", "\ufffd", "\n", "\n", "function", " is", "(", "o", ",", " type", ")", " {", " type", " =", " String", "(", "type", ").", "to", "Lower", "Case", "();", " return", " (", "type", " ==", " \"", "null", "\"", " &&", " o", " ===", " null", ")", " ||", " (", "type", " ==", " type", "of", " o", ")", " ||", " (", "type", " ==", " \"", "object", "\"", " &&", " o", " ===", " Object", "(", "o", "))", " ||", " (", "type", " ==", " \"", "array", "\"", " &&", " Array", ".", "is", "Array", " &&", " Array", ".", "is", "Array", "(", "o", "))", " ||", " Object", ".", "prototype", ".", "to", "String", ".", "call", "(", "o", ").", "slice", "(", "8", ",", " -", "1", ").", "to", "Lower", "Case", "()", " ==", " type", ";", " }", " is", "(", "function", "(){", "},", " \"", "object", "\");", " //", " true", " is", "(", "function", "(){", "},", " \"", "function", "\");", " //", " true", " is", "([", "],", " \"", "object", "\");", " //", " true", " is", "(", "new", " String", "(\"", "string", "\"),", " \"", "string", "\");", " //", " true", "\n", "\n", "The", " difference", " can", " be", " subtle", " as", " it", "\ufffd", "\ufffd", "s", " between", " \ufffd", "\ufffd", "Is", " this", " variable", "\ufffd", "\ufffd", "s", " type", " \ufffd", "\ufffd", "object", "\ufffd", "\ufffd", "?", "\ufffd", "\ufffd", " and", " \ufffd", "\ufffd", "Is", " this", " an", " object", "?", "\ufffd", "\ufffd", ".", "\n", "\n", "As", " you", " know", " a", " function", " is", " an", " object", " and", " function", "\u2026", " new", " Number", " is", " an", " object", " and", " a", " number", "\u2026", "\n", "\n", "This", " way", " of", " thinking", " about", " JavaScript", " isn", "\ufffd", "\ufffd", "t", " limited", " to", " typing", "\u2014", "it", " impacts", " the", " comparison", " operator", ",", " also", ".", "\n", "\n", "You", "\ufffd", "\ufffd", "ll", " often", " hear", " that", " \ufffd", "\ufffd", "==", "\ufffd", "\ufffd", " is", " a", " bad", " part", " of", " JavaScript", ".", " I", " not", " so", " sure", ".", " It", " is", " often", " better", " to", " use", " \ufffd", "\ufffd", "===", "\ufffd", "\ufffd", " instead", " of", " \ufffd", "\ufffd", "==", "\ufffd", "\ufffd", " only", " if", " you", " don", "\ufffd", "\ufffd", "t", " clearly", " understand", " how", " those", " operators", " work", " or", " are", " simply", " in", " doubt", ".", "\n", "\n", "It", " depends", " on", " what", " level", " of", " equality", " you", " really", " need", ".", "\n", "\n", "Typ", "ing", ":", " type", "of", " a", " ===", " \"", "object", "\"", "\n", "\n", "look", "s", " as", " ridiculous", " to", " me", " as", ":", " ((", "type", "of", "(", "a", "))", " ===", " (\"", "object", "\"))", "\n", "\n", "The", " brackets", " don", "\ufffd", "\ufffd", "t", " hurt", ",", " but", " putting", " them", " everywhere", " just", " because", " you", " used", " to", " is", " redundant", ".", " And", " it", "\ufffd", "\ufffd", "s", " the", " same", " with", " \ufffd", "\ufffd", "===", "\ufffd", "\ufffd", ".", "\n", "\n", "Taking", " a", " look", " at", " our", " \ufffd", "\ufffd", "is", "\ufffd", "\ufffd", " function", ",", " you", "\ufffd", "\ufffd", "ll", " notice", " I", " don", "\ufffd", "\ufffd", "t", " care", " if", " type", " is", " a", " string", " or", " not", " as", " long", " as", " it", " equals", " (", "==", ")", " \ufffd", "\ufffd", "object", "\ufffd", "\ufffd", " or", " \ufffd", "\ufffd", "null", "\ufffd", "\ufffd", ",", " etc", ".", " We", "\ufffd", "\ufffd", "re", " embracing", " the", " flexibility", " of", " the", " language", ",", " and", " not", " fighting", " against", " it", ".", "\n", "\n", "Don", "\ufffd", "\ufffd", "t", " code", " as", " though", " the", " types", " are", " fixed", ",", " they", "\ufffd", "\ufffd", "re", " not", ".", "\n", "\n", "Next", " time", " you", "\ufffd", "\ufffd", "re", " going", " to", " use", " type", "of", " or", " \ufffd", "\ufffd", "===", "\ufffd", "\ufffd", " think", " about", " whether", " it", "\ufffd", "\ufffd", "s", " the", " best", " choice", ".", " Remember", " that", " in", " JavaScript", " nothing", " is", " always", " what", " it", " looks", " like", "."]