["[", " 0", ".", "000000", "]", " Linux", " version", " 2", ".", "6", ".", "38", ".", "8", " (", "drop", "c", "amb", "uild", "@", "ubuntu", "-", "drop", "cam", "-", "build", ")", " (", "g", "cc", " version", " 4", ".", "5", ".", "2", " (", "S", "our", "cery", " G", "++", " Lite", " 2011", ".", "03", "-", "41", ")", " )", " #", "15", " PRE", "EM", "PT", " Mon", " Oct", " 1", " 16", ":", "59", ":", "51", " PDT", " 2012", "\n", "\n", "[", " 0", ".", "000000", "]", " CPU", ":", " ARM", "v", "6", "-", "compatible", " processor", " [", "4", "117", "b", "365", "]", " revision", " 5", " (", "ARM", "v", "6", "TE", "J", "),", " cr", "=", "00", "c", "5", "387", "f", "\n", "\n", "[", " 0", ".", "000000", "]", " CPU", ":", " VIP", "T", " non", "ali", "asing", " data", " cache", ",", " VIP", "T", " non", "ali", "asing", " instruction", " cache", "\n", "\n", "[", " 0", ".", "000000", "]", " Machine", ":", " Coconut", "\n", "\n", "[", " 0", ".", "000000", "]", " Memory", " policy", ":", " E", "CC", " disabled", ",", " Data", " cache", " write", "back", "\n", "\n", "[", " 0", ".", "000000", "]", " Amb", "arella", ":", " AH", "B", " =", " 0", "x", "6", "0000000", "[", "0", "xf", "0000000", "],", "0", "x", "01", "000000", " 0", "\n", "\n", "[", " 0", ".", "000000", "]", " Amb", "arella", ":", " AP", "B", " =", " 0", "x", "7", "0000000", "[", "0", "xf", "1", "000000", "],", "0", "x", "01", "000000", " 0", "\n", "\n", "[", " 0", ".", "000000", "]", " Amb", "arella", ":", " P", "PM", " =", " 0", "xc", "0000000", "[", "0", "xe", "0000000", "],", "0", "x", "00200000", " 9", "\n", "\n", "[", " 0", ".", "000000", "]", " Amb", "arella", ":", " B", "SB", " =", " 0", "xc", "8", "c", "00000", "[", "0", "xe", "8", "c", "00000", "],", "0", "x", "00", "400", "000", " 9", "\n", "\n", "[", " 0", ".", "000000", "]", " Amb", "arella", ":", " D", "SP", " =", " 0", "xc", "9", "000000", "[", "0", "xe", "9", "000000", "],", "0", "x", "07", "000000", " 9", "\n", "\n", "[", " 0", ".", "000000", "]", " Amb", "arella", ":", " HAL", " =", " 0", "xc", "00", "a", "0000", "[", "0", "xf", "ee", "00000", "],", "0", "x", "0000", "9", "f", "34", " 9", "\n", "\n", "[", " 0", ".", "000000", "]", " boot", "mem", "_", "init", ":", " high", "_", "memory", " =", " 0", "xc", "8", "a", "00000", "\n", "\n", "[", " 0", ".", "000000", "]", " Built", " 1", " z", "onel", "ists", " in", " Zone", " order", ",", " mobility", " grouping", " on", ".", " Total", " pages", ":", " 350", "52", "\n", "\n", "[", " 0", ".", "000000", "]", " Kernel", " command", " line", ":", " console", "=", "tty", "S", "0", " u", "bi", ".", "m", "td", "=", "ln", "x", " root", "=", "ubi", "0", ":", "root", "fs", " r", "w", " root", "f", "st", "ype", "=", "ub", "if", "s", " init", "=/", "linux", "rc", "\n", "\n", "[", " 0", ".", "000000", "]", " PID", " hash", " table", " entries", ":", " 1024", " (", "order", ":", " 0", ",", " 4096", " bytes", ")", "\n", "\n", "[", " 0", ".", "000000", "]", " D", "entry", " cache", " hash", " table", " entries", ":", " 327", "68", " (", "order", ":", " 5", ",", " 13", "10", "72", " bytes", ")", "\n", "\n", "[", " 0", ".", "000000", "]", " In", "ode", "-", "cache", " hash", " table", " entries", ":", " 16", "384", " (", "order", ":", " 4", ",", " 655", "36", " bytes", ")", "\n", "\n", "[", " 0", ".", "000000", "]", " Memory", ":", " 138", "MB", " =", " 138", "MB", " total", "\n", "\n", "[", " 0", ".", "000000", "]", " Memory", ":", " 136", "244", "k", "/", "136", "244", "k", " available", ",", " 50", "68", "k", " reserved", ",", " 0", "K", " high", "mem", "\n", "\n", "(", "etc", ".)", "\n", "\n", "########", " #####", "###", " #####", "##", " #####", "###", " #####", "#", " ###", " ##", " ##", "\n", "\n", "##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ###", " ###", "\n", "\n", "##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " #", "###", " #", "###", "\n", "\n", "##", " ##", " #####", "###", " ##", " ##", " #####", "###", " ##", " ##", " ##", " ##", " ###", " ##", "\n", "\n", "##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " #", "########", " ##", " ##", "\n", "\n", "##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", " ##", "\n", "\n", "########", " ##", " ##", " #####", "##", " ##", " #####", "#", " ##", " ##", " ##", " ##", "\n\n", "\n", "\n", "Amb", "arella", " login", ":", "\n", "\n", "Getting", " root", " via", " the", " Amb", "arella", " boot", "loader", "\n", "\n", "___", " ___", " ", "________", "_", " _", "\n", "\n", "/", " _", " \\", " |", " \\", "/", " ||", " ___", " \\", " |", " |", "\n", "\n", "/", " /", "_", "\\", " \\", "|", ".", ".", " ||", " |", "_", "/", " /", " ___", " ___", " |", " |", "_", "\n", "\n", "|", " _", " ||", " |", "\\/", "|", " ||", " ___", " \\", " /", " _", " \\", " /", " _", " \\", " |", " __", "|", "\n", "\n", "|", " |", " |", " ||", " |", " |", " ||", " |", "_", "/", " /", "|", " (_", ")", " ||", " (_", ")", " ||", " |", "_", "\n", "\n", "\\", "_", "|", " |", "_", "/", "\\", "_", "|", " |", "_", "/", "\\", "____", "/", " \\", "___", "/", " \\", "___", "/", " \\", "__", "|", "\n", "\n", "--------------------------------------------------------", "--", "\n", "\n", "Amb", "oot", "(", "R", ")", " Amb", "arella", "(", "R", ")", " Copyright", " (", "C", ")", " 2004", "-", "2007", "\n", "\n", "B", "ST", " (", "137", "166", "),", " HAL", " (", "137", "166", ")", "\n", "\n", "Arm", " fre", "q", ":", " 48", "0000000", "\n", "\n", "i", "D", "SP", " fre", "q", ":", " 12", "0000000", "\n", "\n", "Core", " fre", "q", ":", " 12", "0000000", "\n", "\n", "D", "ram", " fre", "q", ":", " 336", "000000", "\n", "\n", "AH", "B", " fre", "q", ":", " 12", "0000000", "\n", "\n", "AP", "B", " fre", "q", ":", " 6", "0000000", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", "\n", "\n", "amb", "oot", ">", " help", "\n", "\n", "The", " following", " commands", " are", " supported", ":", "\n", "\n", "help", " bios", " boot", " di", "ag", "\n", "\n", "dump", " erase", " n", "and", "_", "er", "ase", " exec", "\n", "\n", "hal", " hot", "boot", " net", "boot", " ping", "\n", "\n", "r", "8", " r", "16", " r", "32", " reboot", "\n", "\n", "reset", " set", "env", " set", "mem", " show", "\n", "\n", "us", "bd", "l", " w", "8", " w", "16", " w", "32", "\n", "\n", "x", "md", "l", " b", "api", "\n", "\n", "Use", " '", "help", "'", " to", " get", " help", " on", " a", " specific", " command", "\n", "\n", "amb", "oot", ">", "\n", "\n", "console", "=", "tty", "S", "0", " u", "bi", ".", "m", "td", "=", "ln", "x", " root", "=", "ubi", "0", ":", "root", "fs", " r", "w", " root", "f", "st", "ype", "=", "ub", "if", "s", " init", "=/", "linux", "rc", "\n", "\n", "amb", "oot", ">", " boot", " console", "=", "tty", "S", "0", " u", "bi", ".", "m", "td", "=", "ln", "x", " root", "=", "ubi", "0", ":", "root", "fs", " r", "w", " root", "f", "st", "ype", "=", "ub", "if", "s", " init", "=/", "bin", "/", "sh", "\n", "\n", "[", " 3", ".", "13", "0000", "]", " U", "BI", "FS", ":", " reserved", " for", " root", ":", " 0", " bytes", " (", "0", " Ki", "B", ")", "\n", "\n", "[", " 3", ".", "13", "0000", "]", " V", "FS", ":", " Mount", "ed", " root", " (", "ub", "if", "s", " filesystem", ")", " on", " device", " 0", ":", "13", ".", "\n", "\n", "[", " 3", ".", "14", "0000", "]", " Free", "ing", " init", " memory", ":", " 136", "K", "\n", "\n", "/", "bin", "/", "sh", ":", " can", "'t", " access", " t", "ty", ";", " job", " control", " turned", " off", "\n", "\n", "/", " #", "\n", "\n", "/", " #", " ls", " -", "l", " /", "etc", "/", "shadow", "\n", "\n", "lr", "wx", "rw", "x", "rw", "x", " 1", " root", " root", " 21", " Oct", " 1", " 2012", " /", "etc", "/", "shadow", " ->", "..", "/", "m", "nt", "/", "drop", "cam", "/", "shadow", "\n", "\n", "/", " #", " cat", " /", "etc", "/", "f", "stab", "\n", "\n", "#", " /", "etc", "/", "f", "stab", ":", " static", " file", " system", " information", ".", "\n", "\n", "#", "\n", "\n", "#", " <", "file", " system", ">", " <", "mount", " pt", ">", " <", "type", ">", " <", "options", ">", " <", "dump", ">", " <", "pass", ">", "\n", "\n", "#", "/", "dev", "/", "root", " /", " ext", "2", " r", "w", ",", "no", "auto", " 0", " 1", "\n", "\n", "#", "proc", " /", "proc", " proc", " defaults", " 0", " 0", "\n", "\n", "dev", "pt", "s", " /", "dev", "/", "pt", "s", " dev", "pt", "s", " defaults", ",", "g", "id", "=", "5", ",", "mode", "=", "620", " 0", " 0", "\n", "\n", "#", "tmp", "fs", " /", "tmp", " tmp", "fs", " defaults", " 0", " 0", "\n", "\n", "sys", "fs", " /", "sys", " sys", "fs", " defaults", " 0", " 0", "\n", "\n", "debug", "fs", " /", "debug", " debug", "fs", " defaults", " 0", " 0", "\n\n", "\n", "\n", "#", " extra", " mounts", "\n", "\n", "/", "dev", "/", "m", "td", "block", "9", " /", "m", "nt", "/", "drop", "cam", " j", "ff", "s", "2", " defaults", " 0", " 0", "\n", "\n", "/", " #", " mount", " -", "t", "j", "ff", "s", "2", " /", "dev", "/", "m", "td", "block", "9", " /", "m", "nt", "/", "drop", "cam", "\n", "\n", "/", " #", " cat", " /", "m", "nt", "/", "drop", "cam", "/", "shadow", "\n", "\n", "root", "::", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "bin", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "da", "emon", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "ad", "m", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "lp", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "sync", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "shut", "down", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "h", "alt", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "u", "uc", "p", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "operator", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "nob", "ody", ":", "*:", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "default", "::", "109", "33", ":", "0", ":", "99", "999", ":", "7", "::", ":", "\n", "\n", "/", " #", " ls", " /", "m", "nt", "/", "drop", "cam", "/", "\n", "\n", "b", "pc", "map", ".", "bin", " key", "cert", ".", "p", "em", " soft", "mac", "\n", "\n", "f", "v", ".", "txt", " provision", "ed", " w", "pa", "_", "supp", "lic", "ant", ".", "conf", "\n", "\n", "hw", "ver", " shadow", "\n", "\n", "$", " opens", "sl", " x", "509", " -", "in", " key", "cert", ".", "p", "em", " -", "no", "out", " -", "text", " |", " grep", " CN", "\n", "\n", "Iss", "uer", ":", " C", "=", "US", ",", " CN", "=", "Drop", "cam", " Certificate", " Authority", ",", " O", "=", "Drop", "cam", "\n", "\n", "Subject", ":", " C", "=", "US", ",", " CN", "=", "d", "024", "378", "182", "da", "4", "f", "37", "b", "0", "e", "98", "194", "69", "89", "f", "40", "a", ",", " O", "=", "Drop", "cam", "\n", "\n", "Expl", "oring", " the", " running", " device", "\n", "\n", "#", " ps", "\n", "\n", "P", "ID", " US", "ER", " TIME", " COMM", "AND", "\n", "\n", "1", " root", " 0", ":", "02", " init", "\n", "\n", "2", " root", " 0", ":", "00", " [", "k", "thread", "d", "]", "\n", "\n", "3", " root", " 0", ":", "00", " [", "k", "soft", "ir", "q", "d", "/", "0", "]", "\n", "\n", "4", " root", " 0", ":", "00", " [", "k", "worker", "/", "0", ":", "0", "]", "\n", "\n", "5", " root", " 0", ":", "00", " [", "k", "worker", "/", "u", ":", "0", "]", "\n", "\n", "6", " root", " 0", ":", "00", " [", "k", "hel", "per", "]", "\n", "\n", "7", " root", " 0", ":", "00", " [", "k", "worker", "/", "u", ":", "1", "]", "\n", "\n", "402", " root", " 0", ":", "00", " [", "sync", "_", "sup", "ers", "]", "\n", "\n", "404", " root", " 0", ":", "00", " [", "b", "di", "-", "default", "]", "\n", "\n", "406", " root", " 0", ":", "00", " [", "k", "block", "d", "]", "\n", "\n", "513", " root", " 0", ":", "00", " [", "ks", "w", "ap", "d", "0", "]", "\n", "\n", "514", " root", " 0", ":", "00", " [", "fs", "not", "ify", "_", "mark", "]", "\n", "\n", "515", " root", " 0", ":", "00", " [", "a", "io", "]", "\n", "\n", "517", " root", " 0", ":", "00", " [", "crypt", "o", "]", "\n", "\n", "558", " root", " 0", ":", "00", " [", "m", "td", "block", "0", "]", "\n", "\n", "563", " root", " 0", ":", "00", " [", "m", "td", "block", "1", "]", "\n", "\n", "568", " root", " 0", ":", "00", " [", "m", "td", "block", "2", "]", "\n", "\n", "573", " root", " 0", ":", "00", " [", "m", "td", "block", "3", "]", "\n", "\n", "578", " root", " 0", ":", "00", " [", "m", "td", "block", "4", "]", "\n", "\n", "583", " root", " 0", ":", "00", " [", "m", "td", "block", "5", "]", "\n", "\n", "588", " root", " 0", ":", "00", " [", "m", "td", "block", "6", "]", "\n", "\n", "593", " root", " 0", ":", "00", " [", "m", "td", "block", "7", "]", "\n", "\n", "598", " root", " 0", ":", "00", " [", "m", "td", "block", "8", "]", "\n", "\n", "603", " root", " 0", ":", "00", " [", "m", "td", "block", "9", "]", "\n", "\n", "6", "11", " root", " 0", ":", "00", " [", "ubi", "_", "b", "gt", "0", "d", "]", "\n", "\n", "628", " root", " 0", ":", "00", " [", "ub", "if", "s", "_", "b", "gt", "0", "_", "0", "]", "\n", "\n", "629", " root", " 0", ":", "00", " [", "k", "worker", "/", "0", ":", "1", "]", "\n", "\n", "643", " root", " 0", ":", "00", " [", "flush", "-", "ub", "if", "s", "_", "0", "_", "0", "]", "\n", "\n", "646", " root", " 0", ":", "00", " [", "j", "ff", "s", "2", "_", "g", "cd", "_", "m", "td", "9", "]", "\n", "\n", "699", " root", " 0", ":", "00", " [", "k", "worker", "/", "u", ":", "2", "]", "\n", "\n", "7", "35", " root", " 0", ":", "00", " /", "bin", "/", "ash", " /", "usr", "/", "bin", "/", "boot", "strap", ".", "sh", "\n", "\n", "736", " root", " 0", ":", "00", " -", "sh", "\n", "\n", "7", "38", " root", " 0", ":", "00", " sys", "log", "d", " -", "C", "128", " -", "S", "\n", "\n", "740", " root", " 0", ":", "00", " k", "log", "d", "\n", "\n", "7", "43", " root", " 0", ":", "00", " /", "usr", "/", "bin", "/", "connect", "\n", "\n", "7", "44", " root", " 0", ":", "00", " logger", " -", "t", " connect", "\n", "\n", "745", " root", " 0", ":", "00", " /", "usr", "/", "bin", "/", "connect", "\n", "\n", "7", "46", " root", " 0", ":", "00", " /", "usr", "/", "bin", "/", "connect", "\n", "\n", "760", " root", " 0", ":", "00", " [", "file", "-", "storage", "]", "\n", "\n", "772", " root", " 0", ":", "00", " [", "k", "worker", "/", "0", ":", "2", "]", "\n", "\n", "784", " root", " 0", ":", "00", " [", "cfg", "80", "211", "]", "\n", "\n", "804", " root", " 0", ":", "00", " [", "AR", "6", "K", " As", "ync", "]", "\n", "\n", "8", "11", " root", " 0", ":", "00", " [", "ks", "d", "io", "ir", "q", "d", "/", "mm", "c", "1", "]", "\n", "\n", "8", "22", " root", " 0", ":", "00", " w", "pa", "_", "supp", "lic", "ant", " -", "iw", "lan", "0", " -", "c", "/", "m", "nt", "/", "drop", "cam", "/", "w", "pa", "_", "supp", "lic", "ant", ".", "conf", "\n", "\n", "8", "29", " root", " 0", ":", "00", " [", "ds", "pl", "og", "d", "]", "\n", "\n", "830", " root", " 0", ":", "00", " [", "v", "syn", "cd", "]", "\n", "\n", "860", " root", " 0", ":", "00", " [", "sh", "]", "\n", "\n", "86", "1", " root", " 0", ":", "00", " [", "sh", "]", "\n", "\n", "8", "68", " root", " 0", ":", "00", " ps", "\n", "\n", "$", " strings", " connect", " |", " tail", " -", "1", "\n", "\n", "UP", "X", "!", "\n", "\n", "$", " up", "x", " -", "d", " connect", "\n", "\n", "Ultimate", " Pack", "er", " for", " e", "X", "ec", "ut", "ables", "\n", "\n", "Copyright", " (", "C", ")", " 1996", " -", " 2013", "\n", "\n", "UP", "X", " 3", ".", "09", " Markus", " Ober", "h", "umer", ",", " Las", "z", "lo", " M", "oln", "ar", " &", " John", " Re", "iser", " Feb", " 18", "th", " 2013", "\n\n", "\n", "\n", "File", " size", " Ratio", " Format", " Name", "\n", "\n", "--------------------", " ------", " --------", "---", " --------", "---", "\n", "\n", "789", "596", " <-", " 4", "200", "52", " 53", ".", "20", "%", " linux", "/", "arm", "el", " connect", "\n\n", "\n", "\n", "Un", "packed", " 1", " file", ".", "\n", "\n", "rm", " -", "rf", " /", "tmp", "/", "connect", " &&", " mk", "dir", " /", "tmp", "/", "connect", " &&", " tar", " z", "x", " -", "f", " /", "tmp", "/", "connect", ".", "bin", " -", "C", " /", "tmp", "/", "connect", " &&", " rm", " /", "tmp", "/", "connect", ".", "bin", "\n", "\n", "$", " dd", " if", "=", "./", "connect", " of", "=", "connect", ".", "tar", ".", "gz", " b", "s", "=", "1", " skip", "=", "47", "340", "4", " count", "=", "168", "451", "\n", "\n", "168", "451", "+", "0", " records", " in", "\n", "\n", "168", "451", "+", "0", " records", " out", "\n", "\n", "168", "451", " bytes", " (", "168", " k", "B", ")", " copied", ",", " 0", ".", "364", "475", " s", ",", " 4", "62", " k", "B", "/", "s", "\n", "\n", "$", " tar", " -", "tz", "v", "f", " connect", ".", "tar", ".", "gz", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 10", "376", " 2013", "-", "04", "-", "22", " 20", ":", "25", " dispatch", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 12", "43", " 2013", "-", "04", "-", "22", " 20", ":", "25", " hello", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 5", "45", " 2013", "-", "04", "-", "22", " 20", ":", "25", " h", "w", "ver", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 4", "279", " 2013", "-", "04", "-", "22", " 20", ":", "25", " ir", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 8", "79", " 2013", "-", "04", "-", "22", " 20", ":", "25", " list", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 650", " 2013", "-", "04", "-", "22", " 20", ":", "25", " main", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 23", "63", " 2013", "-", "04", "-", "22", " 20", ":", "25", " monitor", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 7", "08", " 2013", "-", "04", "-", "22", " 20", ":", "25", " motion", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 2010", " 2013", "-", "04", "-", "22", " 20", ":", "25", " net", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 260", "7", " 2013", "-", "04", "-", "22", " 20", ":", "25", " old", "i", "ags", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 32", "80", " 2013", "-", "04", "-", "22", " 20", ":", "25", " persistence", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 329", " 2013", "-", "04", "-", "22", " 20", ":", "25", " platform", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 3", "365", " 2013", "-", "04", "-", "22", " 20", ":", "25", " platform", "_", "a", "5", "s", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 5", "51", " 2013", "-", "04", "-", "22", " 20", ":", "25", " platform", "_", "local", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 8", "22", " 2013", "-", "04", "-", "22", " 20", ":", "25", " rav", "g", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 191", " 2013", "-", "04", "-", "22", " 20", ":", "25", " r", "tp", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 6", "43", " 2013", "-", "04", "-", "22", " 20", ":", "25", " settings", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 99", "31", " 2013", "-", "04", "-", "22", " 20", ":", "25", " states", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 9", "12", " 2013", "-", "04", "-", "22", " 20", ":", "25", " status", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 38", "22", " 2013", "-", "04", "-", "22", " 20", ":", "25", " streams", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 30", "47", " 2013", "-", "04", "-", "22", " 20", ":", "25", " update", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 601", " 2013", "-", "04", "-", "22", " 20", ":", "25", " usb", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 260", "2", " 2013", "-", "04", "-", "22", " 20", ":", "25", " util", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 14", "68", " 2013", "-", "04", "-", "22", " 20", ":", "25", " watchdog", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 5", "47", "27", " 2013", "-", "04", "-", "22", " 20", ":", "25", " dro", "pt", "alk", "_", "pb", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 150", "4", " 2013", "-", "04", "-", "22", " 20", ":", "25", " containers", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 58", "79", " 2013", "-", "04", "-", "22", " 20", ":", "25", " dec", "oder", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 10", "38", " 2013", "-", "04", "-", "22", " 20", ":", "25", " descriptor", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 93", "60", " 2013", "-", "04", "-", "22", " 20", ":", "25", " enc", "oder", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 6", "15", " 2013", "-", "04", "-", "22", " 20", ":", "25", " listener", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 20", "750", " 2013", "-", "04", "-", "22", " 20", ":", "25", " prot", "ob", "uf", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 150", "5", " 2013", "-", "04", "-", "22", " 20", ":", "25", " text", "_", "format", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 15", "25", " 2013", "-", "04", "-", "22", " 20", ":", "25", " type", "_", "check", "ers", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 36", "20", " 2013", "-", "04", "-", "22", " 20", ":", "25", " wire", "_", "format", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 16", "86", " 2013", "-", "04", "-", "22", " 17", ":", "24", " a", "5", "s", "_", "boot", ".", "sh", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 78", " 2013", "-", "04", "-", "18", " 16", ":", "45", " w", "pa", "_", "supp", "lic", "ant", "_", "a", "5", "s", ".", "conf", "\n", "\n", "-", "rw", "x", "r", "-", "x", "r", "-", "x", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 12", "86", " 2013", "-", "04", "-", "18", " 16", ":", "45", " u", "dh", "cp", "c", ".", "script", "\n", "\n", "-", "rw", "x", "r", "-", "x", "r", "-", "x", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 13", "10", " 2013", "-", "04", "-", "18", " 16", ":", "45", " u", "dh", "cp", "c", "_", "pro", "vision", ".", "script", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "01", "_", "3", "D", "_", "hw", "rev", "_", "1", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "01", "_", "3", "D", "_", "hw", "rev", "_", "2", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "02", "_", "3", "D", "_", "hw", "rev", "_", "1", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "02", "_", "3", "D", "_", "hw", "rev", "_", "2", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "03", "_", "3", "D", "_", "hw", "rev", "_", "1", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "03", "_", "3", "D", "_", "hw", "rev", "_", "2", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "04", "_", "3", "D", "_", "hw", "rev", "_", "1", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 175", "36", " 2013", "-", "04", "-", "18", " 16", ":", "45", " ov", "97", "15", "_", "04", "_", "3", "D", "_", "hw", "rev", "_", "2", ".", "bin", "\n", "\n", "-", "rw", "-", "r", "--", "r", "--", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 27", "453", " 2013", "-", "04", "-", "18", " 16", ":", "45", " amb", "arella", "_", "ud", "c", "-", "pre", "-", "v", "16", ".", "ko", "\n", "\n", "-", "rw", "x", "r", "-", "x", "r", "-", "x", " drop", "c", "amb", "uild", "/", "drop", "c", "amb", "uild", " 8", "68", "28", " 2013", "-", "04", "-", "18", " 16", ":", "45", " w", "m", "icon", "fig", "\n", "\n", "Trans", "port", " encryption", " and", " exploring", " traffic", " interception", "\n", "\n", "ECD", "HE", "-", "R", "SA", "-", "A", "ES", "128", "-", "SHA", ":", "ECD", "HE", "-", "R", "SA", "-", "A", "ES", "256", "-", "SHA", "\n", "\n", "00", " RES", "ER", "V", "ED", " 01", " RED", "I", "RECT", " 02", " START", "_", "ST", "REAM", " 03", " STOP", "_", "ST", "REAM", " 04", " W", "IF", "I", "_", "SC", "AN", " 05", " W", "IF", "I", "_", "CON", "NECT", " 06", " REST", "ART", " 07", " UPDATE", " 08", " DEBUG", " 09", " SET", "_", "STAT", "US", "_", "L", "IGHT", " 0", "a", " SET", "_", "ILL", "UM", "IN", "ATOR", "_", "L", "IGHT", " 0", "b", " SET", "_", "AUD", "IO", "_", "GA", "IN", " 0", "c", " STOP", "_", "BACK", "F", "ILL", " 0", "d", " AUD", "IO", "_", "PA", "Y", "LOAD", " 0", "e", " SET", "_", "IR", "_", "LED", " 0", "f", " SET", "_", "DP", "T", "Z", " 10", " FOR", "CE", "_", "ID", "R", " 11", " EX", "EC", " 12", " SET", "_", "W", "ATER", "M", "ARK", " 13", " AUD", "IO", "_", "S", "OUND", " 14", " SET", "_", "IM", "AGE", "_", "PR", "OP", "ERT", "IES", " 40", " P", "ING", " 80", " HELL", "O", " 81", " ST", "REAM", "_", "B", "EGIN", " 82", " ST", "REAM", "_", "END", " 83", " R", "TP", " 84", " W", "IF", "I", "_", "SC", "AN", "_", "LIST", " 85", " W", "IF", "I", "_", "CON", "NECT", "_", "STAT", "US", " 86", " EVENT", " 87", " BACK", "F", "ILL", "_", "COMPLE", "TE", " 8", "a", " UPDATE", "_", "RES", "ULT", " 8", "c", " OF", "FL", "INE", "_", "D", "IA", "GN", "OST", "IC", "_", "RE", "PORT", " 8", "e", " STAT", "US", "_", "RE", "PORT", "\n", "\n", "7", ":", " \"", "Drop", "cam", " Connect", " -", " Version", ":", " 162", ",", " Build", ":", " 57", " (", "jen", "kins", "-", "connect", "-", "release", "-", "node", "=", "linux", "-", "57", ",", " a", "295", "60", "db", "b", "07", "24", "e", "7", "db", "af", "b", "19", "b", "9", "ac", "12", "68", "b", "6", "fb", "62", "f", "1", "d", "6", ",", " origin", "/", "hot", "fix", "/", "bas", "il", ")\"", "\n", "\n", "9", ":", " 2", "\n", "\n", "8", ":", " \"", "Build", ":", " 181", " (", "jen", "kins", "-", "amb", "arella", "-", "181", ",", " 87", "32", "f", "64", "a", "79", "a", "ec", "dd", "16", "bf", "656", "27", "75", "015", "c", "303", "d", "71", "c", "8", "39", "),", " Linux", ":", " Linux", " Amb", "arella", " 2", ".", "6", ".", "38", ".", "8", " #", "15", " PRE", "EM", "PT", " Mon", " Oct", " 1", " 16", ":", "59", ":", "51", " PDT", " 2012", " arm", "v", "6", "l", " GNU", "/", "Linux", "\"", "\n", "\n", "1", ":", " 1", "\n", "\n", "5", ":", " 3", "\n", "\n", "6", ":", " 15", "\n", "\n", "4", ":", " \"", "0", ".", "0", ".", "0", ".", "0", "\"", "\n", "\n", "2", ":", " 4", "\n", "\n", "3", ":", " 162", "\n", "\n", "1", ":", " \"", "oc", "ulus", "121", ".", "drop", "cam", ".", "com", "\"", "\n", "\n", "Con", "clusions", "\n", "\n", "by", " Kris", " Bros", "ch", "In", " the", " last", " Drop", "cam", " post", ",", " I", " wrote", " about", " reversing", " the", " USB", " setup", " procedure", " that", " the", " Drop", "cam", " uses", " to", " initially", " connect", " to", " your", " WiFi", " network", ".", " After", " exploring", " the", " USB", " tunnel", "ing", " protocol", ",", " the", " next", " step", " was", " to", " take", " it", " apart", ",", " or", " at", " least", " take", " off", " the", " back", " of", " the", " enclosure", ":", "The", " main", " controller", " is", " an", " Amb", "arella", " A", "5", "s", " system", "-", "on", "-", "chip", ",", " which", " contains", " an", " ARM", " processor", ",", " video", " processing", " hardware", ",", " USB", " device", " controller", ",", " and", " other", " peripher", "als", ".", " We", " had", " actually", " already", " guessed", " that", " the", " Drop", "cam", " used", " an", " Amb", "ore", "lla", " chip", " based", " on", " the", " i", "Manufact", "urer", " USB", " descriptor", " field", " value", " \ufffd", "\ufffd", "Linux", " 2", ".", "6", ".", "38", ".", "8", " with", " amb", "arella", "_", "ud", "c", "\ufffd", "\ufffd", ".", " Amb", "arella", " chips", " are", " also", " used", " in", " GoPro", " cameras", ".", " Quite", " a", " bit", " of", " work", " has", " been", " done", " reversing", " GoPro", " cameras", " by", " other", " researchers", ".", " One", " researcher", ",", " who", " goes", " by", " evil", "w", "ombat", ",", " has", " done", " some", " particularly", " interesting", " work", ",", " including", " writing", " a", " firmware", " parser", " and", " tools", " that", " can", " be", " used", " to", " load", " custom", " code", " onto", " GoPro", " cameras", " over", " the", " USB", " port", ",", " which", " can", " be", " found", " at", " his", " Github", " page", " (", " https", "://", "github", ".", "com", "/", "evil", "w", "ombat", "?", "tab", "=", "re", "pos", "it", "ories", " ).", "Here", "'s", " a", " picture", " of", " the", " Drop", "cam", " with", " some", " of", " the", " components", " identified", ":", "The", " most", " useful", " thing", " to", " identify", " was", " the", " U", "ART", " (", "serial", ")", " port", " (", "z", "oom", "ed", " in", " the", " picture", " above", ",", " and", " labeled", " with", " TX", ",", " RX", ",", " 3", ".", "3", "v", ",", " and", " G", "ND", ").", " Upon", " examining", " the", " board", ",", " that", " 4", "-", "pin", " footprint", " looked", " suspicious", "ly", " like", " a", " serial", " port", ".", " One", " pad", " was", " connected", " to", " ground", ",", " and", " another", " was", " connected", " to", " a", " thick", " trace", " meaning", " it", " was", " likely", " a", " power", " connection", ",", " and", " it", " is", " in", " fact", " at", " 3", ".", "3", "v", " when", " the", " camera", " is", " powered", " on", ".", " The", " other", " two", " pads", " were", " connected", " to", " resist", "ors", " via", " small", " traces", " and", " they", " were", " both", " at", " 3", ".", "3", "v", " with", " the", " camera", " powered", " on", ".", " This", " is", " consistent", " with", " an", " embedded", " system", " serial", " port", " \u2013", " U", "ART", "s", " usually", " are", " at", " a", " \ufffd", "\ufffd", "high", "\ufffd", "\ufffd", " voltage", " level", " when", " they", " are", " idle", ";", " the", " TX", " line", " would", " be", " high", " because", " no", " data", " was", " being", " transmitted", " and", " the", " RX", " line", " would", " be", " pulled", " high", " when", " no", " input", " is", " connected", ".", " I", " tried", " connecting", " the", " RX", " line", " of", " a", " serial", " adapter", " to", " each", " of", " the", " two", " pads", " and", " found", " that", " when", " I", " configured", " the", " adapter", " for", " a", " b", "aud", "rate", " of", " 115", "200", " and", " powered", " the", " Drop", "cam", ",", " I", " could", " see", " Linux", " boot", " messages", " being", " transmitted", ":", "Once", " I", " had", " identified", " the", " TX", " and", " RX", " pads", " and", " successfully", " received", " some", " data", ",", " I", " sold", "ered", " some", " wires", " to", " those", " pads", " and", " brought", " them", " out", " of", " the", " case", " so", " that", " I", " could", " access", " the", " serial", " port", " with", " the", " Drop", "cam", " assembled", ":", "After", " the", " boot", " messages", ",", " there", " is", " eventually", " a", " login", " prompt", ":", "Unfortunately", ",", " I", " didn", "'t", " know", " the", " root", " password", ".", " I", " tried", " logging", " in", " as", " root", " with", " a", " few", " guessed", " passwords", ",", " but", " none", " of", " them", " worked", ".", " I", " was", " considering", " different", " ways", " to", " dump", " or", " modify", " the", " Flash", " chip", " contents", " when", " I", " happened", " upon", " a", " solution", " on", " a", " forum", ".", " After", " reading", " some", " posts", " on", " one", " of", " the", " GoPro", " forums", " I", " tried", " a", " trick", " mentioned", " there", " to", " get", " a", " boot", "loader", " prompt", " \u2013", " transmitting", " a", " new", "line", " immediately", " upon", " powering", " the", " device", " on", " is", " the", " key", ".", " If", " you", " hold", " down", " the", " \ufffd", "\ufffd", "Enter", "\ufffd", "\ufffd", " key", ",", " repeatedly", " sending", " new", "lines", " to", " the", " serial", " connection", " while", " powering", " the", " Drop", "cam", ",", " you", " can", " access", " to", " the", " Amb", "arella", " boot", "loader", ":", "Once", " you", " have", " access", " to", " the", " boot", "loader", ",", " rooting", " the", " Drop", "cam", " is", " just", " like", " getting", " root", " on", " any", " Linux", " computer", " where", " you", " have", " access", " to", " the", " boot", "loader", ".", " You", " can", " copy", " the", " kernel", " command", " line", " shown", " in", " the", " boot", " messages", ":", "And", " change", " the", " init", " parameter", " to", " start", " a", " shell", ":", "After", " doing", " this", " and", " watching", " the", " kernel", " boot", " again", ",", " I", " was", " left", " with", " a", " root", " shell", ":", "My", " goal", " was", " to", " edit", " the", " /", "etc", "/", "shadow", " file", " so", " that", " I", " could", " log", " in", " to", " the", " camera", " after", " a", " normal", " boot", ".", " Interestingly", ",", " the", " /", "etc", "/", "shadow", " file", " on", " the", " Drop", "cam", " is", " a", " link", " to", " /", "m", "nt", "/", "drop", "cam", "/", "shadow", ":", "You", " therefore", " need", " to", " mount", " the", " /", "m", "nt", "/", "drop", "cam", " filesystem", " to", " access", " the", " shadow", " file", ":", "And", " then", " remove", " the", " password", " hashes", " from", " it", ":", "The", " /", "m", "nt", "/", "drop", "cam", " filesystem", " is", " interesting", " because", " it", " appears", " to", " be", " where", " camera", "-", "specific", " configuration", " files", " are", " stored", ":", "This", " implies", " that", " different", " cameras", " might", " have", " different", " root", " passwords", ".", " The", " w", "pa", "_", "supp", "lic", "ant", ".", "conf", " file", " contains", " the", " configuration", " for", " the", " wireless", " network", ".", " Most", " interesting", " of", " these", " files", ",", " however", ",", " is", " the", " key", "cert", ".", "p", "em", " file", ",", " which", " contains", " a", " public", "/", "private", " RSA", " key", " pair", " and", " a", " client", " certificate", ".", " The", " certificate", " is", " issued", " by", " a", " \ufffd", "\ufffd", "Drop", "cam", " Certificate", " Authority", "\ufffd", "\ufffd", ",", " and", " the", " common", " name", " is", " set", " to", " the", " unique", " ID", " of", " my", " Drop", "cam", " (", "the", " same", " identifier", " used", " to", " set", " up", " the", " camera", " and", " view", " its", " stream", ",", " as", " discussed", " in", " my", " previous", " post", "):", "This", " means", " that", " each", " Drop", "cam", " has", " a", " unique", " client", " certificate", " that", " it", " uses", " to", " authent", "icate", " to", " the", " Drop", "cam", " cloud", " servers", ".", "Now", " that", " I", " had", " modified", " the", " shadow", " file", ",", " I", " was", " able", " to", " log", " in", " as", " root", " without", " a", " password", " and", " inspect", " the", " system", " after", " it", " had", " booted", " normally", ":", "The", " /", "usr", "/", "bin", "/", "connect", " binary", " performs", " most", " of", " the", " operations", " of", " the", " Drop", "cam", ".", " It", " handles", " the", " TLS", " connections", " made", " out", " to", " Drop", "cam", " cloud", " servers", " (", "which", ",", " based", " on", " strings", " in", " the", " connect", " binary", ",", " carry", " a", " protocol", " named", " dro", "pt", "alk", ").", " It", " also", " handles", " loading", " and", " un", "loading", " the", " kernel", " driver", ",", " as", " well", " as", " the", " users", "pace", " portions", " of", " the", " USB", " mass", " storage", " network", " tunnel", " (", "which", " again", ",", " based", " on", " strings", " in", " the", " binary", ",", " is", " named", " F", "SN", "L", ").", " The", " connect", " binary", " is", " UP", "X", " packed", ",", " but", " it", " can", " be", " unp", "acked", " easily", ":", "One", " thing", " that", " we", " noticed", " when", " looking", " at", " this", " binary", " was", " that", " it", " contains", " references", " to", " the", " Lua", " scripting", " language", ".", " We", " weren", "'t", " sure", " why", " until", " we", " saw", " that", " it", " was", " writing", " to", " a", " file", " named", " /", "tmp", "/", "connect", ".", "bin", " and", " then", " running", " this", " command", " via", " a", " call", " to", " system", "():", "The", " connect", " binary", " itself", " contains", " an", " embedded", " tar", "ball", " that", " gets", " extracted", " to", " /", "tmp", "/", "connect", " when", " it", " runs", ".", " The", " tar", "ball", " contains", " an", " assortment", " of", " files", " including", " a", " number", " of", " compiled", " Lua", " scripts", ":", "We", "'ll", " have", " another", " blog", " post", " coming", " up", " detailing", " how", " to", " reverse", " engineer", " those", " compiled", " Lua", " scripts", ",", " with", " a", " tool", " to", " make", " the", " RE", " work", " easier", ".", "I", " wanted", " to", " perform", " a", " man", "-", "in", "-", "the", "-", "middle", " attack", " so", " that", " I", " could", " decode", " the", " TLS", " traffic", " from", " the", " camera", ".", " Every", " Drop", "cam", " has", " its", " own", " client", " certificate", " issued", " by", " the", " Drop", "cam", " CA", ";", " with", " a", " copy", " of", " my", " camera", "'s", " client", " certificate", " I", " could", " start", " a", " TLS", " connection", " to", " the", " Drop", "cam", " servers", ",", " but", " I", " couldn", "'t", " yet", " convince", " the", " connect", " binary", " to", " connect", " to", " me", ".", " In", " order", " to", " perform", " the", " man", "-", "in", "-", "the", "-", "middle", " attack", ",", " the", " simplest", " option", " was", " to", " patch", " the", " server", " certificate", " checking", " code", " out", " of", " the", " connect", " binary", ".", " This", " involved", " flipping", " one", " bit", " in", " the", " unp", "acked", " binary", ",", " re", "-", "packing", " it", ",", " and", " uploading", " it", " to", " the", " camera", ".", "The", " dro", "pt", "alk", " transport", " layer", " has", " decent", " protection", " against", " eaves", "dropping", " attacks", ".", " It", " uses", " an", " Open", "SSL", " TLS", "v", "1", " connection", " with", " ep", "hemer", "al", " ellipt", "ic", " curve", " Diff", "ie", "-", "Hell", "man", " (", "ECD", "HE", ")", " key", " exchange", ",", " and", " either", " 128", " or", " 256", " bit", " AES", " encryption", ".", " This", " is", " the", " list", " of", " the", " two", " cipher", " suites", " that", " the", " connect", " binary", " will", " accept", " for", " the", " dro", "pt", "alk", " connection", ":", "The", " E", "CD", "HE", " key", " exchange", " method", " made", " performing", " a", " man", "-", "in", "-", "the", "-", "middle", " on", " the", " dro", "pt", "alk", " connection", " harder", " because", " most", " tools", " that", " I", " tried", " to", " use", " didn", "'t", " support", " that", " key", " exchange", " algorithm", ".", " However", ",", " I", " was", " able", " to", " hack", " some", " code", " together", " that", " given", " the", " camera", "'s", " private", " key", " and", " certificate", " would", " let", " me", " intercept", " and", " examine", " the", " dra", "pt", "alk", " traffic", " between", " my", " patched", " connect", " binary", " and", " the", " Drop", "cam", " servers", ".", " Here", "'s", " a", " picture", " of", " my", " test", " setup", ":", "My", " Linux", " machine", " was", " configured", " to", " act", " as", " a", " wireless", " access", " point", ",", " using", " i", "pt", "ables", " to", " redirect", " the", " drop", "cam", " traffic", " to", " my", " listening", " dro", "pt", "alk", " interception", " process", ".", " In", " addition", ",", " I", " had", " a", " serial", " terminal", " connected", " to", " the", " Drop", "cam", "'s", " serial", " port", " so", " I", " could", " upload", " the", " patched", " connect", " binary", " and", " examine", " its", " behavior", ".", " The", " dro", "pt", "alk", " protocol", " is", " simple", " \u2013", " there", " is", " a", " 3", "-", "byte", " header", " consisting", " of", " a", " one", "-", "byte", " message", " type", " followed", " by", " a", " big", "-", "end", "ian", " two", "-", "byte", " length", " field", ".", " Luckily", ",", " there", " is", " a", " function", " in", " the", " connect", " binary", " for", " converting", " dro", "pt", "alk", " message", " type", " identifiers", " (", "the", " first", " byte", " in", " the", " header", ")", " to", " human", "-", "read", "al", "ble", " strings", " for", " inclusion", " in", " debug", " output", ":", "The", " function", " provides", " us", " with", " this", " list", " of", " dro", "pt", "alk", " message", " types", ":", "Message", " types", " 0", "x", "01", " through", " 0", "x", "14", " appear", " to", " be", " messages", " that", " are", " sent", " to", " the", " camera", ",", " while", " types", " 0", "x", "80", " through", " 0", "x", "8", "e", " appear", " to", " be", " intended", " to", " originate", " from", " the", " camera", ".", " Most", " of", " the", " dro", "pt", "alk", " messages", " contain", " prot", "ob", "uf", "s", " which", " are", " dec", "oded", " in", " the", " Lua", " code", ".", " For", " example", ",", " here", "'s", " the", " first", " HELL", "O", " packet", " that", " my", " Drop", "cam", " sends", " when", " it", " connects", " to", " nexus", ".", "drop", "cam", ".", "com", ",", " dec", "oded", " with", " the", " prot", "oc", " tool", ":", "The", " nexus", ".", "drop", "cam", ".", "com", " server", " always", " replies", " with", " a", " RED", "I", "RECT", " to", " an", " \ufffd", "\ufffd", "oc", "ulus", "\ufffd", "\ufffd", " server", ":", "The", " client", " then", " connects", " to", " the", " \ufffd", "\ufffd", "oc", "ulus", "\ufffd", "\ufffd", " server", " and", " sends", " another", " HELL", "O", " packet", ".", " Most", " of", " the", " configuration", " options", " in", " the", " Drop", "cam", " web", " interface", " correspond", " to", " dro", "pt", "alk", " messages", " that", " are", " sent", " to", " the", " camera", ".", " When", " the", " server", " is", " ready", " to", " receive", " data", ",", " it", " sends", " a", " START", "_", "ST", "REAM", " message", " with", " some", " video", " parameters", " in", " it", ".", " Video", " data", " is", " sent", " from", " the", " camera", " in", " R", "TP", " dro", "pt", "alk", " messages", " containing", " R", "TP", " formatted", " video", " data", ".", "In", " this", " post", " I", "'ve", " written", " about", " the", " process", " of", " reverse", " engineering", " the", " Drop", "cam", " from", " the", " point", " of", " opening", " the", " case", " to", " having", " a", " basic", " understanding", " of", " its", " network", " protocols", ".", " With", " the", " information", " we", "'ve", " gathered", ",", " you", " could", " start", " to", " piece", " together", " a", " prot", "ob", "uf", " definition", " file", " (.", "pro", "to", " file", ")", " for", " the", " various", " message", " types", " and", " write", " your", " own", " dro", "pt", "alk", " client", " or", " server", ".", " Alternatively", ",", " you", " could", " use", " the", " root", " shell", " on", " the", " Drop", "cam", " to", " modify", " or", " add", " to", " its", " functionality", ".", " Comment", " below", ",", " email", " us", ",", " or", " tweet", " @", "In", "clude", "Security", " if", " you", " try", " these", " things", ",", " we", "'d", " love", " to", " hear", " what", " modifications", " you", " make", " to", " your", " Drop", "cam", ".", "Stay", " tuned", " for", " the", " final", " blog", " post", " in", " this", " series", " regarding", " Lua", " scripts", "!"]