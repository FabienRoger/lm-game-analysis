["Def", "ining", " Mon", "oids", "\n", "\n", "[", "1", ",", "2", "]", "\n", "\n", "[", "3", ",", "4", "]", "\n", "\n", "++", "\n", "\n", "[", "1", ",", "2", ",", "3", ",", "4", "]", "\n", "\n", "[]", "\n", "\n", "++", "\n", "\n", "[]", "\n", "\n", "[]", "++", "[", "1", ",", "2", ",", "3", ",", "4", "]", "==", "[", "1", ",", "2", ",", "3", ",", "4", "]", "\n", "\n", "Integer", "\n\n", "\n", "\n", "class", " Mon", "oid", " m", " where", "\n", "\n", "m", "append", " ::", " m", " ->", " m", " ->", " m", "\n", "\n", "m", "empty", " ::", " m", "\n\n", "\n\n", "\n", "\n", "instance", " Mon", "oid", " [", "a", "]", " where", "\n", "\n", "m", "append", " =", " (", "++)", "\n", "\n", "m", "empty", " =", " []", "\n\n", "\n\n", "\n", "\n", "a", " `", "m", "append", "`", " mem", "pty", " =", " a", "\n\n", "\n\n", "\n", "\n", "m", "empty", " `", "m", "append", "`", " a", " =", " a", ".", "\n\n", "\n", "\n", "a", " `", "m", "append", "`", " b", "\n", "\n", "b", " `", "m", "append", "`", " a", "\n", "\n", "[", "3", ",", "4", "]", "\n", "\n", "[", "1", ",", "2", "]", "\n", "\n", "[", "5", ",", "6", "]", "\n", "\n", "[", "1", ",", "2", "]", "++", "[", "3", ",", "4", "]", "\n", "\n", "([", "1", ",", "2", "]", "++", "[", "3", ",", "4", "])", "++", "[", "5", ",", "6", "]", "\n", "\n", "[", "1", ",", "2", "]", "++", "([", "3", ",", "4", "]", "++", "[", "5", ",", "6", "])", "\n\n", "\n", "\n", "(", "a", " `", "m", "append", "`", " b", ")", " `", "m", "append", "`", " c", " ==", " a", " `", "m", "append", "`", " (", "b", " `", "m", "append", "`", " c", ")", "\n\n", "\n", "\n", "Some", " Uses", " of", " Mon", "oids", "\n", "\n", "++", "\n", "\n", "+", "\n", "\n", "m", "con", "cat", " [", "a", ",", "b", ",", "c", "]", "\n", "\n", "a", " `", "m", "append", "`", " (", "b", " `", "m", "append", "`", " c", ")", "\n", "\n", "m", "con", "cat", "\n", "\n", "m", "con", "cat", " [", "a", ",", "b", ",...", ",", "c", ",", "d", "]", "\n", "\n", "a", " `", "m", "append", "`", " b", "\n", "\n", "c", " `", "m", "append", "`", " d", "\n", "\n", "[", "a", "]", " ->", " b", "\n", "\n", "(", "Mon", "oid", " a", ")", " =>", " a", " ->", " b", "\n\n", "\n", "\n", "instance", " Mon", "oid", " Integer", " where", "\n", "\n", "m", "append", " =", " (+", ")", "\n", "\n", "m", "empty", " =", " 0", "\n\n", "\n\n", "\n\n", "\n", "\n", "instance", " Mon", "oid", " Integer", " where", "\n", "\n", "m", "append", " =", " (*", ")", "\n", "\n", "m", "empty", " =", " 1", "\n\n", "\n\n", "\n", "\n", "Num", " a", " =>", " Mon", "oid", " (", "Sum", " a", ")", "\n\n", "\n\n", "\n", "\n", "Num", " a", " =>", " Mon", "oid", " (", "Product", " a", ")", "\n\n", "\n", "\n", "m", "con", "cat", " [", "Sum", " 2", ",", "Sum", " 3", ",", "Sum", " 4", "]", "\n", "\n", "Sum", " 9", "\n", "\n", "m", "con", "cat", " [", "Product", " 2", ",", "Product", " 3", ",", "Product", " 4", "]", "\n", "\n", "[", "Product", " 24", "]", "\n", "\n", "Sum", "\n", "\n", "Product", "\n", "\n", "The", " Writer", " Mon", "ad", "\n", "\n", "tell", "\n\n", "\n", "\n", ">", " import", " Data", ".", "Mon", "oid", "\n", "\n", ">", " import", " Data", ".", "F", "old", "able", "\n", "\n", ">", " import", " Control", ".", "Mon", "ad", ".", "Writer", "\n", "\n", ">", " import", " Control", ".", "Mon", "ad", ".", "State", "\n\n", "\n", "\n", ">", " fact", "1", " ::", " Integer", " ->", " Writer", " String", " Integer", "\n", "\n", ">", " fact", "1", " 0", " =", " return", " 1", "\n", "\n", ">", " fact", "1", " n", " =", " do", "\n", "\n", ">", " let", " n", "'", " =", " n", "-", "1", "\n", "\n", ">", " tell", " $", " \"", "We", "'ve", " taken", " one", " away", " from", " \"", " ++", " show", " n", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " m", " <-", " fact", "1", " n", "'", "\n", "\n", ">", " tell", " $", " \"", "We", "'ve", " called", " f", " \"", " ++", " show", " m", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " let", " r", " =", " n", "*", "m", "\n", "\n", ">", " tell", " $", " \"", "We", "'ve", " multiplied", " \"", " ++", " show", " n", " ++", " \"", " and", " \"", " ++", " show", " m", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " return", " r", "\n\n", "\n\n", "\n", "\n", "tell", "\n", "\n", "run", "Writer", "\n\n", "\n", "\n", ">", " ex", "1", " =", " run", "Writer", " (", "fact", "1", " 10", ")", "\n\n", "\n\n", "\n\n", "\n", "\n", ">", " fact", "2", " ::", " Integer", " ->", " Writer", " (", "Sum", " Integer", ")", " Integer", "\n", "\n", ">", " fact", "2", " 0", " =", " return", " 1", "\n", "\n", ">", " fact", "2", " n", " =", " do", "\n", "\n", ">", " let", " n", "'", " =", " n", "-", "1", "\n", "\n", ">", " tell", " $", " Sum", " 1", "\n", "\n", ">", " m", " <-", " fact", "2", " n", "'", "\n", "\n", ">", " let", " r", " =", " n", "*", "m", "\n", "\n", ">", " tell", " $", " Sum", " 1", "\n", "\n", ">", " return", " r", "\n\n", "\n\n", "\n", "\n", ">", " ex", "2", " =", " run", "Writer", " (", "fact", "2", " 10", ")", "\n\n", "\n\n", "\n\n", "\n", "\n", ">", " fact", "3", " ::", " Integer", " ->", " State", " Integer", " Integer", "\n", "\n", ">", " fact", "3", " 0", " =", " return", " 1", "\n", "\n", ">", " fact", "3", " n", " =", " do", "\n", "\n", ">", " let", " n", "'", " =", " n", "-", "1", "\n", "\n", ">", " modify", " (+", "1", ")", "\n", "\n", ">", " m", " <-", " fact", "3", " n", "'", "\n", "\n", ">", " let", " r", " =", " n", "*", "m", "\n", "\n", ">", " modify", " (+", "1", ")", "\n", "\n", ">", " return", " r", "\n\n", "\n", "\n", ">", " ex", "3", " =", " run", "State", " (", "fact", "3", " 10", ")", " 0", "\n\n", "\n\n", "\n", "\n", "Writer", "\n", "\n", "f", " ::", " Integer", " ->", " Writer", " (", "Sum", " Integer", ")", " Integer", "\n", "\n", "State", "\n", "\n", "Any", "\n", "\n", "Any", " True", "\n", "\n", "Any", " True", "\n", "\n", "Any", " False", "\n\n", "\n", "\n", ">", " fact", "4", " ::", " Integer", " ->", " Writer", " Any", " Integer", "\n", "\n", ">", " fact", "4", " 0", " =", " return", " 1", "\n", "\n", ">", " fact", "4", " n", " =", " do", "\n", "\n", ">", " let", " n", "'", " =", " n", "-", "1", "\n", "\n", ">", " m", " <-", " fact", "4", " n", "'", "\n", "\n", ">", " let", " r", " =", " n", "*", "m", "\n", "\n", ">", " tell", " (", "Any", " (", "r", "==", "120", "))", "\n", "\n", ">", " return", " r", "\n\n", "\n", "\n", ">", " ex", "4", " =", " run", "Writer", " (", "fact", "4", " 10", ")", "\n\n", "\n\n", "\n", "\n", "Comm", "ut", "ative", " Mon", "oids", ",", " Non", "-", "Comm", "ut", "ative", " Mon", "oids", " and", " Dual", " Mon", "oids", "\n", "\n", "x", " `", "m", "append", "`", " y", " ==", " y", " `", "m", "append", "`", " x", "\n", "\n", "a", "+", "b", "==", "b", "+", "a", "\n", "\n", "x", " `", "m", "append", "`", " y", "\n", "\n", "y", " `", "m", "append", "`", " x", "\n", "\n", "m", "append", "\n", "\n", "fl", "ip", " m", "append", "\n", "\n", "[", "1", ",", "2", "]", " ++", " [", "3", ",", "4", "]", "\n", "\n", "[", "3", ",", "4", "]", " ++", " [", "1", ",", "2", "]", "\n", "\n", "fl", "ip", " m", "append", "\n", "\n", "m", "empty", "\n", "\n", "Dual", "\n\n", "\n", "\n", ">", " fact", "5", " ::", " Integer", " ->", " Writer", " (", "Dual", " String", ")", " Integer", "\n", "\n", ">", " fact", "5", " 0", " =", " return", " 1", "\n", "\n", ">", " fact", "5", " n", " =", " do", "\n", "\n", ">", " let", " n", "'", " =", " n", "-", "1", "\n", "\n", ">", " tell", " $", " Dual", " $", " \"", "We", "'ve", " taken", " one", " away", " from", " \"", " ++", " show", " n", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " m", " <-", " fact", "5", " n", "'", "\n", "\n", ">", " tell", " $", " Dual", " $", " \"", "We", "'ve", " called", " f", " \"", " ++", " show", " m", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " let", " r", " =", " n", "*", "m", "\n", "\n", ">", " tell", " $", " Dual", " $", " \"", "We", "'ve", " multiplied", " \"", " ++", " show", " n", " ++", " \"", " and", " \"", " ++", " show", " m", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " return", " r", "\n\n", "\n", "\n", ">", " ex", "5", " =", " run", "Writer", " (", "fact", "5", " 10", ")", "\n\n", "\n\n", "\n", "\n", "The", " Product", " Mon", "oid", "\n\n", "\n", "\n", "instance", " (", "Mon", "oid", " a", ",", "Mon", "oid", " b", ")", " =>", " Mon", "oid", " (", "a", ",", "b", ")", " where", "\n", "\n", "m", "empty", " =", " (", "m", "empty", ",", "m", "empty", ")", "\n", "\n", "m", "append", " (", "u", ",", "v", ")", " (", "w", ",", "x", ")", " =", " (", "u", " `", "m", "append", "`", " w", ",", "v", " `", "m", "append", "`", " x", ")", "\n\n", "\n\n", "\n", "\n", ">", " tell", "F", "st", " a", " =", " tell", " $", " (", "a", ",", "m", "empty", ")", "\n", "\n", ">", " tell", "S", "nd", " b", " =", " tell", " $", " (", "m", "empty", ",", "b", ")", "\n\n", "\n\n", "\n\n", "\n", "\n", ">", " fact", "6", " ::", " Integer", " ->", " Writer", " (", "String", ",", "Sum", " Integer", ")", " Integer", "\n", "\n", ">", " fact", "6", " 0", " =", " return", " 1", "\n", "\n", ">", " fact", "6", " n", " =", " do", "\n", "\n", ">", " let", " n", "'", " =", " n", "-", "1", "\n", "\n", ">", " tell", "S", "nd", " (", "Sum", " 1", ")", "\n", "\n", ">", " tell", "F", "st", " $", " \"", "We", "'ve", " taken", " one", " away", " from", " \"", " ++", " show", " n", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " m", " <-", " fact", "6", " n", "'", "\n", "\n", ">", " let", " r", " =", " n", "*", "m", "\n", "\n", ">", " tell", "S", "nd", " (", "Sum", " 1", ")", "\n", "\n", ">", " tell", "F", "st", " $", " \"", "We", "'ve", " multiplied", " \"", " ++", " show", " n", " ++", " \"", " and", " \"", " ++", " show", " m", " ++", " \"", "\n", "\n", "\"", "\n", "\n", ">", " return", " r", "\n\n", "\n", "\n", ">", " ex", "6", " =", " run", "Writer", " (", "fact", "6", " 5", ")", "\n\n", "\n\n", "\n", "\n", "Mon", "oid", "\n", "\n", "F", "old", "able", " Data", "\n", "\n", "fold", "Map", "\n", "\n", "fold", "Map", "\n\n", "\n", "\n", ">", " data", " Tree", " a", " =", " Empty", " |", " Leaf", " a", " |", " Node", " (", "Tree", " a", ")", " a", " (", "Tree", " a", ")", "\n\n", "\n", "\n", ">", " instance", " Fold", "able", " Tree", " where", "\n", "\n", ">", " fold", "Map", " f", " Empty", " =", " mem", "pty", "\n", "\n", ">", " fold", "Map", " f", " (", "Le", "af", " x", ")", " =", " f", " x", "\n", "\n", ">", " fold", "Map", " f", " (", "Node", " l", " k", " r", ")", " =", " fold", "Map", " f", " l", " `", "m", "append", "`", " f", " k", " `", "m", "append", "`", " fold", "Map", " f", " r", "\n\n", "\n", "\n", "(", "==", " 1", ")", "\n\n", "\n", "\n", ">", " tree", " =", " Node", " (", "Le", "af", " 1", ")", " 7", " (", "Le", "af", " 2", ")", "\n\n", "\n", "\n", ">", " ex", "7", " =", " fold", "Map", " (", "Any", ".", " (", "==", " 1", "))", " tree", "\n", "\n", ">", " ex", "8", " =", " fold", "Map", " (", "All", ".", " (>", " 5", "))", " tree", "\n\n", "\n\n", "\n", "\n", "Any", "\n", "\n", "All", "\n", "\n", "fold", "Map", "\n", "\n", "Rec", "ap", "\n", "\n", "a", " `", "m", "append", "`", " b", "\n", "\n", "Has", "kell", " is", " a", " great", " language", " for", " constructing", " code", " modular", "ly", " from", " small", " but", " orth", "og", "onal", " building", " blocks", ".", " One", " of", " these", " small", " blocks", " is", " the", " mon", "oid", ".", " Although", " mon", "oids", " come", " from", " mathematics", " (", "al", "gebra", " in", " particular", ")", " they", " are", " found", " everywhere", " in", " computing", ".", " You", " probably", " use", " one", " or", " two", " mon", "oids", " implicitly", " with", " every", " line", " of", " code", " you", " write", ",", " whatever", " the", " language", ",", " but", " you", " might", " not", " know", " it", " yet", ".", " By", " making", " them", " explicit", " we", " find", " interesting", " new", " ways", " of", " constructing", " those", " lines", " of", " code", ".", " In", " particular", ",", " ways", " that", " are", " often", " easier", " to", " both", " read", " and", " write", ".", " So", " the", " following", " is", " an", " intro", " to", " mon", "oids", " in", " Haskell", ".", " I", "'m", " assuming", " familiarity", " with", " type", " classes", ",", " because", " Haskell", " mon", "oids", " form", " a", " type", " class", ".", " I", " also", " assume", " some", " familiarity", " with", " mon", "ads", ",", " though", " nothing", " too", " complex", ".", "This", " post", " is", " liter", "ate", " Haskell", " so", " you", " can", " play", " with", " the", " examples", " directly", ".", "In", " Haskell", ",", " a", " mon", "oid", " is", " a", " type", " with", " a", " rule", " for", " how", " two", " elements", " of", " that", " type", " can", " be", " combined", " to", " make", " another", " element", " of", " the", " same", " type", ".", " To", " be", " a", " mon", "oid", " there", " also", " needs", " to", " be", " an", " element", " that", " you", " can", " think", " of", " as", " representing", " '", "nothing", "'", " in", " the", " sense", " that", " when", " it", "'s", " combined", " with", " other", " elements", " it", " leaves", " the", " other", " element", " unchanged", ".", "A", " great", " example", " is", " lists", ".", " Given", " two", " lists", ",", " say", "and", ",", " you", " can", " join", " them", " together", " using", "to", " get", ".", " There", "'s", " also", " the", " empty", " list", ".", " Using", "to", " comb", "in", "ew", "ith", " any", " list", " gives", " you", " back", " the", " same", " list", ",", " for", " example", "Another", " example", " is", " the", " type", " of", " integers", ",.", " Given", " two", " elements", ",", " say", " 3", " and", " 4", ",", " we", " can", " combine", " them", " with", " +", " to", " get", " 7", ".", " We", " also", " have", " the", " element", " 0", " which", " when", " added", " to", " any", " other", " integer", " leaves", " it", " unchanged", ".", "So", " here", " is", " a", " possible", " definition", " for", " the", " mon", "oid", " type", " class", ":", "The", " function", " m", "append", " is", " the", " function", " we", " use", " to", " combine", " pairs", " of", " elements", ",", " and", " mem", "pty", " is", " the", " '", "nothing", "'", " element", ".", " We", " can", " make", " lists", " an", " instance", " like", " this", ":", "Because", " we", " want", " mem", "pty", " to", " do", " nothing", " when", " combined", " with", " other", " elements", " we", " also", " require", " mon", "oids", " to", " obey", " these", " two", " rules", "and", "Notice", " how", " there", " are", " two", " ways", " to", " combine", " a", " and", " b", " using", " m", "append", ".", " We", " can", " write", "or", ".", " There", " is", " no", " requirement", " on", " a", " mon", "oid", " that", " these", " be", " equal", " to", " each", " other", ".", " (", "But", " see", " below", ".)", " But", " there", " is", " another", " property", " that", " mon", "oids", " are", " required", " to", " have", ".", " Suppose", " we", " start", " with", " the", " list", ".", " And", " now", " suppose", " we", " want", " to", " conc", "aten", "ate", " it", " with", "on", " the", " left", " and", "on", " the", " right", ".", " We", " could", " do", " the", " left", " conc", "aten", "ation", " first", " to", " get", "and", " then", " form", ".", " But", " we", " could", " do", " the", " right", " one", " first", " and", " get", ".", " Because", " we", "'re", " conc", "aten", "ating", " at", " opposite", " ends", " the", " two", " operations", " don", "'t", " interfere", " and", " it", " doesn", "'t", " matter", " which", " we", " do", " first", ".", " This", " gives", " rise", " to", " the", " third", " and", " last", " requirement", " we", " have", " of", " mon", "oids", ":", "and", " you", " can", " summar", "ise", " it", " with", " the", " slogan", " '", "comb", "ining", " on", " the", " left", " doesn", "'t", " interfere", " with", " combining", " on", " the", " right", "'.", " Notice", " how", " the", " integers", ",", " combined", " with", " +", ",", " also", " have", " this", " property", ".", " It", "'s", " such", " a", " useful", " property", " it", " has", " a", " name", ":", " associ", "ativity", ".", "That", "'s", " a", " complete", " specification", " of", " what", " a", " mon", "oid", " is", ".", " Haskell", " doesn", "'t", " en", "fore", " the", " three", " laws", " I", "'ve", " given", ",", " but", " anyone", " reading", " code", " using", " a", " mon", "oid", " will", " expect", " these", " laws", " to", " hold", ".", "But", " given", " that", " we", " already", " have", " individual", " functions", " like", "and", ",", " why", " would", " we", " ever", " want", " to", " use", " m", "append", " instead", "?", "One", " reason", " is", " that", " with", " a", " mon", "oid", " we", " get", " another", " function", " called", " m", "con", "cat", " for", " free", ".", " m", "con", "cat", " takes", " a", " list", " of", " values", " in", " a", " mon", "oid", " and", " combines", " them", " all", " together", ".", " For", " example", "is", " equal", " to", ".", " Any", " time", " you", " have", " a", " mon", "oid", " you", " have", " this", " quick", " and", " easy", " way", " to", " combine", " a", " whole", " list", " together", ".", " But", " note", " that", " there", " is", " some", " ambiguity", " in", " the", " idea", " behind", ".", " To", " comput", "ew", "h", "ich", " order", " should", " we", " work", " in", "?", " Should", " we", " work", " from", " left", " to", " right", " and", " comput", "ef", "irst", "?", " Or", " should", " we", " start", " with", ".", " That", "'s", " one", " place", " where", " the", " associ", "ativity", " law", " comes", " in", ":", " it", " makes", " no", " difference", ".", "Another", " place", " where", " you", " might", " want", " to", " use", " a", " mon", "oid", " is", " in", " code", " that", " is", " ag", "nostic", " about", " how", " you", " want", " to", " combine", " elements", ".", " Just", " as", " m", "con", "cat", " works", " with", " any", " mon", "oid", ",", " you", " might", " want", " to", " write", " your", " own", " code", " that", " works", " with", " any", " mon", "oid", ".", "Expl", "icit", "ly", " using", " the", " Mon", "oid", " type", " class", " for", " a", " function", " also", " tells", " the", " reader", " of", " your", " code", " what", " your", " intentions", " are", ".", " If", " a", " function", " has", " signature", "you", " know", " it", " takes", " a", " list", " and", " constructs", " an", " object", " of", " type", " b", " from", " it", ".", " But", " it", " has", " considerable", " freedom", " in", " what", " it", " can", " do", " with", " your", " list", ".", " But", " if", " you", " see", " a", " function", " of", " type", ",", " even", " if", " it", " is", " only", " used", " with", " lists", ",", " we", " know", " what", " kind", " of", " things", " the", " function", " will", " do", " with", " the", " list", ".", " For", " example", ",", " we", " know", " that", " the", " function", " might", " add", " things", " to", " your", " list", ",", " but", " it", "'s", " never", " going", " to", " pull", " any", " elements", " out", " of", " your", " list", ".", "The", " same", " type", " can", " give", " rise", " to", " a", " mon", "oid", " in", " different", " ways", ".", " For", " example", ",", " I", "'ve", " already", " mentions", " that", " the", " integers", " form", " a", " mon", "oid", ".", " So", " we", " could", " define", ":", "But", " there", "'s", " a", " good", " reason", " not", " to", " do", " that", ":", " there", "'s", " another", " natural", " way", " to", " make", " integers", " into", " a", " mon", "oid", ":", "We", " can", "'t", " have", " both", " of", " these", " definitions", " at", " the", " same", " time", ".", " So", " the", " Data", ".", "Mon", "oid", " library", " doesn", "'t", " make", " Integer", " into", " a", " Mon", "oid", " directly", ".", " Instead", ",", " it", " wraps", " them", " with", " Sum", " and", " Product", ".", " It", " also", " does", " so", " more", " generally", " so", " that", " you", " can", " make", " any", " Num", " type", " into", " a", " mon", "oid", " in", " two", " different", " ways", ".", " We", " have", " both", "and", "To", " use", " these", " we", " wrap", " our", " values", " in", " the", " appropriate", " wrapper", " and", " we", " can", " then", " use", " the", " mon", "oid", " functions", ".", " For", " example", "is", ",", " but", "is", "Using", "and", "look", "s", " like", " a", " complicated", " way", " to", " do", " ordinary", " addition", " and", " multiplication", ".", " Why", " do", " things", " that", " way", "?", "You", " can", " think", " of", " mon", "oids", " as", " being", " accum", "ulators", ".", " Given", " a", " running", " total", ",", " n", ",", " we", " can", " add", " in", " a", " new", " value", " a", " to", " get", " a", " new", " running", " total", " n", "'", " =", " n", " `", "m", "append", "`", " a", ".", " Acc", "um", "ulating", " totals", " is", " a", " very", " common", " design", " pattern", " in", " real", " code", " so", " it", "'s", " useful", " to", " abstract", " this", " idea", ".", " This", " is", " exactly", " what", " the", " Writer", " mon", "ad", " allows", ".", " We", " can", " write", " mon", "adic", " code", " that", " accum", "ulates", " values", " as", " a", " \"", "side", " effect", "\".", " The", " function", " to", " perform", " the", " accumulation", " is", " (", "s", "omew", "hat", " confusing", "ly", ")", " called", ".", " Here", "'s", " an", " example", " where", " we", "'re", " logging", " a", " trace", " of", " what", " we", "'re", " doing", ".", "This", " is", " an", " implementation", " of", " the", " fact", "orial", " function", " that", " tells", " us", " what", " it", " did", ".", " Each", " time", " we", " call", "we", " combine", " its", " argument", " with", " the", " running", " log", " of", " all", " of", " the", " strings", " that", " we", "'ve", " '", "told", "'", " so", " far", ".", " We", " us", "eto", " extract", " the", " results", " back", " out", ".", " If", " we", " run", "we", " get", " back", " both", " 10", "!", " and", " a", " list", " of", " what", " it", " took", " to", " compute", " this", ".", "But", " Writer", " allows", " us", " to", " accumulate", " more", " than", " just", " strings", ".", " We", " can", " use", " it", " with", " any", " mon", "oid", ".", " For", " example", ",", " we", " can", " use", " it", " to", " count", " how", " many", " multipl", "ications", " and", " subtract", "ions", " were", " required", " to", " compute", " a", " given", " fact", "orial", ".", " To", " do", " this", " we", " simply", " tell", " a", " value", " of", " the", " appropriate", " type", ".", " In", " this", " case", " we", " want", " to", " add", " values", ",", " and", " the", " mon", "oid", " for", " addition", " is", " Sum", ".", " So", " instead", " we", " could", " implement", ":", "There", "'s", " another", " way", " we", " could", " have", " written", " this", ",", " using", " the", " state", " mon", "ad", ":", "It", " works", " just", " as", " well", ",", " but", " there", " is", " a", " big", " advantage", " to", " using", " the", "version", ".", " It", " has", " type", " signature", ".", " We", " can", " immediately", " read", " from", " this", " that", " our", " function", " has", " a", " side", " effect", " that", " involves", " accumulating", " a", " number", " in", " a", " purely", " additive", " way", ".", " It", "'s", " never", " going", " to", ",", " for", " example", ",", " multiply", " the", " accumulated", " value", ".", " The", " type", " information", " tells", " us", " a", " lot", " about", " what", " is", " going", " on", " inside", " the", " function", " without", " us", " having", " to", " read", " a", " single", " line", " of", " the", " implementation", ".", " The", " version", " written", " with", "is", " free", " to", " do", " whatever", " it", " likes", " with", " the", " accumulated", " value", " and", " so", " it", "'s", " harder", " to", " discern", " its", " purpose", ".", "Data", ".", "Mon", "oid", " also", " provides", " an", " Any", " mon", "oid", ".", " This", " is", " the", " B", "ool", " type", " with", " the", " dis", "j", "unction", " operator", ",", " better", " known", " as", " ||", ".", " The", " idea", " behind", " the", " name", " is", " that", " if", " you", " combine", " together", " any", " collection", " of", " elements", " of", " typ", "et", "hen", " the", " result", " is", "pre", "cise", "ly", " when", " at", " least", " any", " one", " of", " the", " original", " elements", " is", ".", " If", " we", " think", " of", " these", " values", " as", " accum", "ulators", " then", " they", " provide", " a", " kind", " of", " one", " way", " switch", ".", " We", " start", " accumulating", " with", " mem", "pty", ",", " ie", ".,", " and", " we", " can", " think", " of", " this", " as", " being", " the", " switch", " being", " off", ".", " Any", " time", " we", " accumulate", " Any", " True", " into", " our", " running", " '", "total", "'", " the", " switch", " is", " turned", " on", ".", " This", " switch", " can", " never", " be", " switched", " off", " again", " by", " accumulating", " any", " more", " values", ".", " This", " models", " a", " pattern", " we", " often", " see", " in", " code", ":", " a", " flag", " that", " we", " want", " to", " switch", " on", ",", " as", " a", " side", " effect", ",", " if", " a", " certain", " condition", " is", " met", " at", " any", " point", ".", "At", " the", " end", " of", " our", " calculation", " we", " get", " n", "!,", " but", " we", " are", " also", " told", " if", " at", " any", " stage", " in", " the", " calculation", " two", " numbers", " were", " multiplied", " to", " give", " 120", ".", " We", " can", " almost", " read", " the", " tell", " line", " as", " if", " it", " were", " English", ":", " \"", "tell", " my", " caller", " if", " any", " value", " of", " r", " is", " ever", " 120", "\".", " Not", " only", " do", " we", " get", " the", " plumbing", " for", " this", " flag", " with", " a", " minimal", " amount", " of", " code", ".", " If", " we", " look", " at", " the", " type", " for", " this", " version", " of", " f", " it", " tells", " us", " exactly", " what", "'s", " going", " on", ".", " We", " can", " read", " off", " immediately", " that", " this", " function", ",", " as", " a", " \"", "side", " effect", "\",", " comp", "utes", " a", " flag", " that", " can", " be", " turned", " on", ",", " but", " never", " turned", " off", ".", " That", "'s", " a", " lot", " of", " useful", " information", " from", " just", " a", " type", " signature", ".", " In", " many", " other", " programming", " languages", " we", " might", " expect", " to", " see", " a", " boolean", " in", " the", " type", " signature", ",", " but", " we", "'d", " be", " forced", " to", " read", " the", " code", " to", " get", " any", " idea", " of", " how", " it", " will", " be", " used", ".", "Two", " elements", " of", " a", " mon", "oid", ",", " x", " and", " y", ",", " are", " said", " to", " commute", " if", ".", " The", " mon", "oid", " itself", " is", " said", " to", " be", " comm", "ut", "ative", " if", " all", " of", " its", " elements", " commute", " with", " each", " other", ".", " A", " good", " example", " of", " a", " comm", "ut", "ative", " mon", "oid", " is", " the", " type", " of", " integers", ".", " For", " any", " pair", " of", " integers", ",", "If", " a", " mon", "oid", " isn", "'t", " comm", "ut", "ative", ",", " it", "'s", " said", " to", " be", " non", "-", "comm", "ut", "ative", ".", " If", " it", "'s", " non", "-", "com", "u", "ut", "ative", " it", " means", " that", " for", " some", " x", " and", " y", ",", "is", "n", "'t", " the", " same", " as", ",", " so", "and", "are", " not", " the", " same", " function", ".", " For", " example", "is", " different", " from", ".", " This", " has", " the", " interesting", " consequence", " that", " we", " can", " make", " another", " mon", "oid", " in", " which", " the", " combination", " function", " is", ".", " We", " can", " still", " use", " the", " same", "element", ",", " so", " the", " first", " two", " mon", "oid", " laws", " hold", ".", " Additionally", ",", " it", "'s", " a", " nice", " exercise", " to", " prove", " that", " the", " third", " mon", "oid", " law", " still", " holds", ".", " This", " flipped", " mon", "oid", " is", " called", " the", " dual", " mon", "oid", " and", " Data", ".", "Mon", "oid", " provides", " the", "type", " constructor", " to", " build", " the", " dual", " of", " a", " mon", "oid", ".", " We", " can", " use", " this", " to", " reverse", " the", " order", " in", " which", " the", " writer", " mon", "ad", " accum", "ulates", " values", ".", " For", " example", " the", " following", " code", " collects", " the", " execution", " trace", " in", " reverse", " order", ":", "Supp", "ose", " we", " want", " to", " accumulate", " two", " side", " effects", " at", " the", " same", " time", ".", " For", " example", ",", " maybe", " we", " want", " to", " both", " count", " instructions", " and", " leave", " a", " readable", " trace", " of", " our", " computation", ".", " We", " could", " use", " mon", "ad", " transform", "ers", " to", " combine", " two", " writer", " mon", "ads", ".", " But", " there", " is", " a", " slightly", " easier", " way", " -", " we", " can", " combine", " two", " mon", "oids", " into", " one", " '", "product", "'", " mon", "oid", ".", " It", "'s", " defined", " like", " this", ":", "Each", " time", " we", " use", " m", "append", " on", " the", " product", " we", " actually", " perform", " a", " pair", " of", " m", "app", "ends", " on", " each", " of", " the", " elements", " of", " the", " pair", ".", " With", " these", " small", " helper", " functions", ":", "we", " can", " now", " use", " two", " mon", "oids", " simultaneously", ":", "If", " we", " had", " simply", " implemented", " our", " code", " using", " one", " specific", " mon", "oid", ",", " like", " lists", ",", " our", " code", " would", " be", " very", " limited", " in", " its", " application", ".", " But", " by", " using", " the", " general", "type", " class", " we", " ensure", " that", " users", " of", " our", " code", " can", " use", " not", " just", " any", " individual", " mon", "oid", ",", " but", " even", " multiple", " mon", "oids", ".", " This", " can", " make", " for", " more", " efficient", " code", " because", " it", " means", " we", " can", " perform", " multiple", " accum", "ulations", " while", " travers", "ing", " a", " data", " structure", " once", ".", " And", " yet", " we", " still", " ensure", " read", "ability", " because", " our", " code", " is", " written", " using", " the", " interface", " to", " a", " single", " mon", "oid", " making", " our", " algorithms", " simpler", " to", " read", ".", "One", " last", " application", " to", " mention", " is", " the", " Data", ".", "F", "old", "able", " library", ".", " This", " provides", " a", " generic", " approach", " to", " walking", " through", " a", " dat", "ast", "ructure", ",", " accumulating", " values", " as", " we", " go", ".", " The", "function", " applies", " a", " function", " to", " each", " element", " of", " our", " structure", " and", " then", " accum", "ulates", " the", " return", " values", " of", " each", " of", " these", " applications", ".", " An", " implementation", " off", "or", " a", " tree", " structure", " might", " be", ":", "We", " can", " now", " use", " any", " of", " the", " mon", "oids", " discussed", " above", " to", " compute", " properties", " of", " our", " trees", ".", " For", " example", ",", " we", " can", " use", " the", " function", "to", " test", " whether", " each", " element", " is", " equal", " to", " 1", " and", " then", " use", " the", " Any", " mon", "oid", " to", " find", " out", " if", " any", " element", " of", " the", " tree", " is", " equal", " to", " 1", ".", " Here", " are", " a", " pair", " of", " examples", ":", " one", " to", " compute", " whether", " or", " not", " an", " element", " is", " equal", " to", " 1", ",", " and", " another", " to", " test", " if", " every", " element", " is", " greater", " than", " 5", ":", "Note", ",", " of", " course", ",", " that", " these", " expressions", " can", " be", " used", ",", " un", "modified", ",", " with", " any", " fold", "able", " type", ",", " not", " just", " trees", ".", "I", " hope", " you", " agree", " that", " this", " expresses", " our", " intentions", " in", " a", " way", " that", " is", " easy", " to", " read", ".", "That", " suggests", " another", " exercise", ":", " write", " something", " similar", " to", " find", " the", " minimum", " or", " maximum", " element", " in", " a", " tree", ".", " You", " may", " need", " to", " construct", " a", " new", " mon", "oid", " along", " the", " lines", " of", "and", ".", " Try", " finding", " both", " in", " one", " travers", "al", " of", " the", " tree", " using", " the", " product", " mon", "oid", ".", "The", " fold", "able", " example", " also", " illustrates", " another", " point", ".", " The", " implement", "or", " off", "or", " the", " tree", " doesn", "'t", " need", " to", " worry", " about", " whether", " the", " left", " tree", " should", " be", " combined", " with", " the", " central", " element", " before", " the", " right", " tree", ".", " Associ", "ativity", " means", " it", " can", " be", " implemented", " either", " way", " and", " give", " the", " same", " results", ".", "Mon", "oids", " provide", " a", " general", " approach", " to", " combining", " and", " accumulating", " values", ".", " They", " allow", " us", " to", " write", " code", " that", " is", " ag", "nostic", " about", " the", " method", " we", " will", " use", " to", " combine", " values", ",", " and", " that", " makes", " our", " code", " more", " reusable", ".", " By", " using", " named", " mon", "oids", " we", " can", " write", " type", " signatures", " that", " express", " our", " intentions", " to", " people", " reading", " our", " code", ":", " for", " example", " by", " using", " Any", " instead", " of", " B", "ool", " we", " make", " it", " clear", " just", " how", " our", " boolean", " value", " is", " to", " be", " used", ".", " And", " we", " can", " combine", " the", " mon", "oid", "-", "based", " building", " blocks", " provided", " by", " Haskell", " libraries", " to", " build", " useful", " and", " readable", " algorithms", " with", " a", " minimum", " of", " effort", ".", "Some", " final", " notes", ":", " mathematic", "ians", " often", " refer", " to", " m", "append", " as", " a", " '", "binary", " operator", "'", " and", " often", " it", "'s", " called", " '", "multipl", "ication", "'.", " Just", " like", " in", " ordinary", " algebra", ",", " it", "'s", " often", " also", " written", " with", " ab", "utt", "al", " or", " using", " the", " star", " operator", ",", " ie", ".", " ab", " and", " a", "*", "b", " might", " both", " represent", ".", " You", " can", " read", " more", " about", " mon", "oids", " at", " Wikipedia", ".", " And", " I", " wish", " I", " had", " time", " to", " talk", " about", " mon", "oid", " morph", "isms", ",", " and", " why", " the", " list", " mon", "oid", " is", " free", " (", "and", " what", " consequences", " that", " might", " have", " for", " how", " you", " can", " your", " write", " code", "),", " and", " how", " compos", "iting", " gives", " you", " mon", "oids", " and", " a", " whole", " lot", " more", "."]