["If", " you", " have", " ever", " looked", " with", " any", " depth", " at", " statistical", " computing", " for", " mult", "ivariate", " analysis", ",", " there", " is", " a", " good", " chance", " you", " have", " come", " across", " the", " singular", " value", " decom", "position", " (", "S", "VD", ").", " It", " is", " a", " work", "horse", " for", " techniques", " that", " decom", "pose", " data", ",", " such", " as", " correspondence", " analysis", " and", " principal", " components", " analysis", ".", " In", " this", " post", " I", " explain", ",", " at", " an", " intuitive", " level", ",", " how", " it", " works", ".", " I", " demonstrate", " this", " using", " examples", " in", " R", ".", " If", " you", " have", " not", " come", " across", " the", " S", "VD", " before", ",", " skip", " this", " post", "!", " It", " is", " only", " for", " that", " rare", " con", "no", "isse", "ur", ",", " who", " has", " heard", " of", " it", ",", " wants", " to", " understand", " it", " a", " bit", " better", ",", " but", " is", " a", "verse", " to", " lots", " of", " math", ".", "\n", "\n", "This", " post", " is", " going", " to", " go", " walk", " you", " through", " singular", " value", " decom", "position", " explained", " in", " R", ".", " I", "\ufffd", "\ufffd", "ll", " show", " you", " step", " by", " step", " how", " to", " compute", " the", " singular", " value", " decom", "position", " in", " R", " in", " the", " S", "VD", " tutorial", " and", " discuss", " S", "VD", " properties", ".", "\n", "\n", "Explore", " S", "VD", " for", " Free", "\n", "\n", "Sing", "ular", " value", " decom", "position", " example", " in", " R", "\n", "\n", "The", " table", " below", " shows", " the", " standardized", " residual", "s", " from", " a", " contingency", " table", " showing", " the", " relationship", " between", " education", " and", " readers", "hip", " of", " a", " newspaper", ".", " The", " R", " code", " used", " to", " generate", " the", " table", " is", " below", ".", " You", " can", " find", " out", " more", " about", " this", " data", " and", " R", " code", " in", " the", " post", " about", " the", " math", " of", " correspondence", " analysis", ".", "\n\n", "\n\n", "\n", "\n", "education", ".", "by", ".", "read", "ership", " =", " matrix", "(", "c", "(", "5", ",", " 18", ",", " 19", ",", " 12", ",", " 3", ",", " 7", ",", " 46", ",", " 29", ",", " 40", ",", " 7", ",", " 2", ",", " 20", ",", " 39", ",", " 49", ",", " 16", "),", " n", "row", " =", " 5", ",", " dim", "names", " =", " list", "(", " \"", "Level", " of", " education", "\"", " =", " c", "(\"", "Some", " primary", "\",", " \"", "Primary", " completed", "\",", " \"", "Some", " secondary", "\",", " \"", "Second", "ary", " completed", "\",", " \"", "Some", " tert", "iary", "\"),", " \"", "Category", " of", " readers", "hip", "\"", " =", " c", "(\"", "Gl", "ance", "\",", " \"", "Fair", "ly", " thorough", "\",", " \"", "Very", " thorough", "\"", ")))", " O", " =", " education", ".", "by", ".", "read", "ership", " /", " sum", "(", "education", ".", "by", ".", "read", "ership", ")", " E", " =", " row", "S", "ums", "(", "O", ")", " %", "o", "%", " col", "S", "ums", "(", "O", ")", " Z", " =", " (", "O", " -", " E", ")", " /", " sq", "rt", "(", "E", ")", "\n", "\n", "How", " to", " compute", " the", " S", "VD", "\n", "\n", "The", " table", " above", " is", " a", " matrix", " of", " numbers", ".", " I", " am", " going", " to", " call", " it", " Z", ".", " The", " singular", " value", " decom", "position", " is", " computed", " using", " the", " s", "vd", " function", ".", " The", " following", " code", " comp", "utes", " the", " singular", " value", " decom", "position", " of", " the", " matrix", " Z", ",", " and", " assigns", " it", " to", " a", " new", " object", " called", " S", "VD", ",", " which", " contains", " one", " vector", ",", " d", ",", " and", " two", " mat", "rices", ",", " u", " and", " v", ".", " The", " vector", ",", " d", ",", " contains", " the", " singular", " values", ".", " The", " first", " matrix", ",", " u", ",", " contains", " the", " left", " singular", " vectors", ",", " and", " v", " contains", " the", " right", " singular", " vectors", ".", " The", " left", " singular", " vectors", " represent", " the", " rows", " of", " the", " input", " table", ",", " and", " the", " right", " singular", " vectors", " represent", " their", " columns", ".", "\n", "\n", "S", "VD", " =", " s", "vd", "(", "Z", ")", "\n\n", "\n\n", "\n", "\n", "Rec", "over", "ing", " the", " data", "\n", "\n", "The", " singular", " value", " decom", "position", " (", "S", "VD", ")", " has", " four", " useful", " properties", ".", " The", " first", " is", " that", " these", " two", " mat", "rices", " and", " vector", " can", " be", " \ufffd", "\ufffd", "multipl", "ied", "\ufffd", "\ufffd", " together", " to", " re", "-", "create", " the", " original", " input", " data", ",", " Z", ".", " In", " the", " data", " we", " started", " with", " (", "Z", "),", " we", " have", " a", " value", " of", " -", "0", ".", "0", "64", "751", " in", " the", " 5", "th", " row", ",", " 2", "nd", " column", ".", " We", " can", " work", " this", " out", " from", " the", " results", " of", " the", " S", "VD", " by", " multiplying", " each", " element", " of", " d", " with", " the", " elements", " of", " the", " 5", "th", " row", " of", " u", " and", " the", " 2", "nd", " row", " v", ".", "\n", "\n", "That", " is", ":", " -", "0", ".", "0", "64", "751", " =", " 0", ".", "265", "27", "08", "*", "0", ".", "4", "685", "24", "*", "(-", "0", ".", "488", "77", "95", ")", " +", " 0", ".", "11", "354", "21", "*", "(-", "0", ".", "059", "79", "79", ")*", "0", ".", "58", "960", "41", " +", " 0", "*", "(-", "0", ".", "647", "49", "22", ")*", "(-", "0", ".", "64", "300", "97", ")", "\n", "\n", "This", " can", " be", " achieved", " in", " R", " using", " the", " code", ":", "\n", "\n", "sum", "(", "S", "VD", "$", "d", " *", " S", "VD", "$", "u", "[", "5", ",", " ]", " *", " S", "VD", "$", "v", "[", "2", ",", " ])", "\n", "\n", "Better", " yet", ",", " if", " we", " want", " to", " recomp", "ute", " the", " whole", " table", " of", " numbers", " at", " once", ",", " we", " can", " use", " a", " bit", " of", " matrix", " algebra", ":", "\n", "\n", "S", "VD", "$", "u", " %", "*", "%", " di", "ag", "(", "S", "VD", "$", "d", ")", " %", "*", "%", " t", "(", "S", "VD", "$", "v", ")", "\n", "\n", "Now", ",", " at", " first", " glance", " this", " property", " may", " not", " seem", " so", " useful", ".", " Indeed", ",", " it", " does", " not", " even", " seem", " very", " clever", ".", " We", " started", " with", " a", " table", " of", " 15", " numbers", ".", " Now", ",", " we", " have", " one", " vector", " and", " two", " tables", ",", " containing", " a", " total", " of", " 27", " numbers", ".", " We", " seem", " to", " be", " going", " backwards", "!", "\n", "\n", "Red", "ucing", " the", " data", "\n", "\n", "The", " second", " useful", " property", " of", " the", " S", "VD", " relates", " to", " the", " values", " in", " d", ".", " They", " are", " sorted", " in", " descending", " order", " (", "ties", " are", " possible", ").", " Why", " is", " this", " important", "?", " Take", " a", " look", " at", " the", " last", " value", " in", " d", ".", " It", " is", " 2", ".", "718", "25", "390", "754", "254", "E", "-", "17", ".", " In", " reality", ",", " this", " is", " 0", " (", "com", "puters", " struggle", " to", " compute", " 0", " exactly", ").", " When", " recovering", " the", " data", ",", " we", " can", " ignore", " the", " last", " value", " of", " d", ",", " and", " also", " the", " last", " column", " of", " each", " of", " u", " and", " v", ".", " Their", " values", " are", " multiplied", " by", " 0", " and", " thus", " are", " irrelevant", ".", " Now", ",", " we", " only", " have", " 18", " numbers", " to", " look", " at", ".", " This", " is", " still", " more", " than", " the", " 15", " we", " started", " with", ".", "\n", "\n", "The", " values", " of", " d", " tell", " us", " the", " relative", " importance", " of", " each", " of", " the", " columns", " in", " u", " and", " v", " in", " describing", " the", " original", " data", ".", " We", " can", " compute", " the", " variance", " in", " the", " original", " data", " (", "Z", ")", " that", " is", " explained", " by", " the", " columns", " by", " first", " squ", "aring", " the", " values", " in", " d", ",", " and", " then", " expressing", " these", " as", " proportions", ".", " If", " you", " run", " the", " following", " R", "code", ",", " it", " shows", " that", " the", " first", " dimension", " explains", " 85", "%", " of", " variance", " in", " the", " data", ".", "\n", "\n", "vari", "ance", ".", "expl", "ained", " =", " prop", ".", "table", "(", "s", "vd", "(", "Z", ")", "$", "d", "^", "2", ")", "\n", "\n", "So", ",", " if", " we", " are", " happy", " to", " ignore", " 15", "%", " of", " the", " information", " in", " the", " original", " data", ",", " we", " only", " need", " to", " look", " at", " the", " first", " column", " in", " u", " and", " the", " first", " column", " in", " v", ".", " Now", " we", " have", " to", " look", " at", " less", " than", " half", " the", " numbers", " that", " we", " started", " with", ".", "\n", "\n", "Hal", "ving", " the", " number", " of", " numbers", " to", " consider", " may", " not", " seem", " like", " a", " sufficient", " benefit", ".", " However", ",", " the", " bigger", " the", " data", " set", ",", " the", " bigger", " the", " saving", ".", " For", " example", ",", " if", " we", " had", " a", " table", " with", " 20", " rows", " and", " 20", " columns", ",", " we", " may", " only", " need", " to", " look", " at", " the", " first", " couple", " of", " columns", ",", " only", " needing", " to", " consider", " 10", "%", " of", " the", " number", " of", " values", " that", " we", " started", " with", ".", " This", " is", " the", " basic", " logic", " of", " techniques", " like", " principle", " components", " analysis", " and", " correspondence", " analysis", ".", " In", " addition", " to", " reducing", " the", " number", " of", " values", " we", " need", " to", " look", " at", ",", " this", " also", " allows", " us", " to", " chart", " the", " values", ",", " which", " saves", " more", " time", ".", " There", " is", " rarely", " a", " good", " way", " to", " chart", " 20", " columns", " of", " data", ",", " but", " chart", "ing", " 2", " columns", " is", " usually", " straightforward", ".", "\n", "\n", "Two", " more", " properties", "\n", "\n", "The", " third", " property", " of", " the", " S", "VD", " is", " that", " the", " rows", " of", " u", " represents", " the", " row", " categories", " of", " the", " original", " table", ",", " and", " the", " rows", " of", " v", " represent", " the", " column", " categories", ".", " The", " fourth", " property", " is", " that", " the", " columns", " of", " u", " are", " orth", "og", "onal", " to", " each", " other", ",", " and", " the", " columns", " of", " v", " are", " orth", "og", "onal", " to", " each", " other", ".", " With", " these", " two", " properties", " combined", ",", " we", " end", " up", " with", " considerable", " simplicity", " in", " future", " analyses", ".", " For", " example", ",", " this", " allows", " us", " to", " compute", " unc", "or", "related", " principal", " components", " in", " principal", " components", " analysis", " and", " to", " produce", " plots", " of", " correspondence", " analysis", ".", " I", " will", " walk", " through", " this", " in", " detail", " in", " my", " forthcoming", " post", " on", " the", " math", " of", " correspondence", " analysis", ".", "\n", "\n", "All", " the", " R", " code", " in", " this", " post", " has", " been", " run", " using", " Display", "r", ".", " Anyone", " can", " explore", " S", "VD", " and", " the", " R", " code", " used", " in", " this", " post", " in", " Display", "r", " for", " free", ".", "\n", "\n", "Explore", " S", "VD", " for", " Free"]