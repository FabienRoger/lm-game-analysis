["W", "au", "ch", "os", " is", " an", " ext", "ensible", " bot", " that", " allows", " its", " owner", " to", " create", " and", " use", " custom", " plugins", ".", " However", ",", " there", " are", " some", " plugins", " that", " are", " widely", " available", " and", " that", " are", " used", " by", " many", " different", " bot", "nets", ".", "\n", "\n", "Today", ",", " we", " announce", " that", " a", " major", " law", " enforcement", " operation", " disrupted", " many", " bot", "nets", " using", " a", " malware", " family", " that", " has", " been", " plag", "uing", " the", " internet", " for", " quite", " a", " long", " time", ":", " Gam", "ar", "ue", ",", " also", " known", " as", " Andromeda", ".", " This", " joint", " operation", ",", " involving", " law", " enforcement", " agencies", " world", "-", "wide", ",", " Microsoft", ",", " and", " ES", "ET", ",", " has", " been", " ongoing", " for", " more", " than", " a", " year", " now", ".", "\n", "\n", "Gam", "ar", "ue", ",", " mostly", " detected", " by", " ES", "ET", " as", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "W", "au", "ch", "os", ",", " has", " been", " around", " since", " at", " least", " September", " 2011", " and", " was", ",", " for", " the", " most", " part", ",", " sold", " as", " a", " crime", "kit", " on", " underground", " forums", ".", " This", " crime", "kit", " proved", " very", " popular", " amongst", " cyber", "crim", "inals", " and", ",", " that", " being", " the", " case", ",", " there", " are", " multiple", ",", " independent", " W", "au", "ch", "os", " bot", "nets", ".", " In", " the", " past", ",", " W", "au", "ch", "os", " has", " been", " the", " most", " detected", " malware", " family", " amongst", " ES", "ET", " users", ",", " so", " when", " approached", " by", " Microsoft", " to", " take", " part", " in", " a", " joint", " disruption", " effort", " against", " it", ",", " to", " better", " protect", " our", " users", " and", " the", " general", " public", " at", " large", ",", " it", " was", " a", " no", "-", "brainer", " to", " agree", ".", "\n", "\n", "ES", "ET", " provided", " technical", " analysis", " to", " this", " operation", " by", " closely", " tracking", " W", "au", "ch", "os", " bot", "nets", ",", " identifying", " their", " C", "&", "C", " servers", " for", " takedown", ",", " and", " monitoring", " what", " its", " operators", " installed", " on", " victims", "\ufffd", "\ufffd", " systems", ".", " Through", " Microsoft", ",", " the", " information", " provided", " to", " law", " enforcement", " agencies", " as", " part", " of", " this", " operation", " included", ":", "\n", "\n", "1", ",", "214", " domains", " and", " IP", " addresses", " of", " the", " bot", "net", "\ufffd", "\ufffd", "s", " command", " and", " control", " servers", "\n", "\n", "464", " distinct", " bot", "nets", "\n", "\n", "80", " associated", " malware", " families", "\n", "\n", "In", " Figure", " 1", " you", " can", " see", " W", "au", "ch", "os", "\ufffd", "\ufffd", "s", " prevalence", " map", " based", " on", " our", " tele", "metry", " data", ".", " Ev", "idently", ",", " W", "au", "ch", "os", " is", " a", " global", " problem", " and", " any", " attempt", " to", " disrupt", " it", " is", " worth", " making", ".", " As", " you", " will", " notice", " throughout", " the", " article", ",", " the", " data", " shown", " are", " about", " a", " year", " old", ".", " This", " is", " when", " W", "au", "ch", "os", "\ufffd", "\ufffd", "s", " activity", " was", " at", " its", " peak", ",", " according", " to", " our", " tele", "metry", ".", " As", " legal", " procedures", " do", " take", " some", " time", ",", " especially", " when", " arrests", " are", " involved", ",", " we", " chose", " these", " older", " data", ",", " as", " they", " are", " more", " representative", " of", " the", " period", " at", " which", " most", " of", " the", " research", " took", " place", ".", "\n", "\n", "If", " you", " are", " worried", " that", " your", " Windows", " system", " might", " be", " compromised", " by", " this", " threat", " and", " are", " not", " an", " ES", "ET", " customer", ",", " you", " can", " download", " and", " use", " the", " ES", "ET", " Online", " Scan", "ner", ",", " which", " will", " remove", " any", " threats", ",", " including", " W", "au", "ch", "os", ",", " it", " might", " find", " on", " your", " system", ".", "\n", "\n", "What", " is", " W", "au", "ch", "os", "?", "\n", "\n", "This", " very", " prevalent", " malware", " has", " been", " around", " for", " several", " years", " and", " has", " been", " covered", " in", " the", " past", " by", " multiple", " blog", " posts", " [", "1", "][", "2", "][", "3", "][", "4", "].", " In", " this", " section", ",", " we", " will", " review", " the", " technical", " basics", " of", " this", " malware", ":", " what", " it", " is", " and", " how", " it", " is", " spread", ".", " The", " following", " section", " will", " cover", " technical", " details", " that", " we", " uncovered", " while", " tracking", " this", " malware", " family", ".", "\n", "\n", "W", "au", "ch", "os", " is", " mostly", " used", " to", " steal", " credentials", " and", " download", " and", " install", " additional", " malware", " onto", " a", " system", ".", " Thus", ",", " if", " a", " system", " is", " compromised", " with", " W", "au", "ch", "os", ",", " it", "\ufffd", "\ufffd", "s", " likely", " that", " there", " will", " be", " several", " other", " malware", " families", " lurking", " on", " the", " same", " system", ".", "\n", "\n", "W", "au", "ch", "os", " is", " modular", " malware", " whose", " functional", "ities", " can", " easily", " be", " expanded", " by", " adding", " plugins", ".", " Plug", "ins", " used", " include", " a", " key", "log", "ger", ",", " a", " form", "grab", "ber", ",", " a", " root", "kit", ",", " a", " S", "OCK", "S", " proxy", " and", " a", " Team", "View", "er", " bot", ".", " There", " are", " five", " known", " major", " build", " versions", " of", " W", "au", "ch", "os", ",", " based", " on", " its", " own", " version", "ing", " scheme", ":", " 2", ".", "06", ",", " 2", ".", "07", ",", " 2", ".", "08", ",", " 2", ".", "09", " and", " 2", ".", "10", ".", " For", " the", " first", " three", " versions", ",", " the", " build", " version", " was", " included", " in", " the", " first", " POST", " request", " sent", " to", " the", " C", "&", "C", " by", " the", " bot", ",", " so", " version", " identification", " was", " easy", ".", " Later", " versions", " of", " W", "au", "ch", "os", " removed", " the", " b", "v", " parameter", " in", " the", " POST", " request", ",", " but", " it", " is", " still", " relatively", " simple", " to", " identify", " the", " bot", " version", " by", " looking", " at", " the", " identification", " string", " sent", " to", " the", " server", " [", "3", "]:", "\n", "\n", "Version", " Identification", " string", " <=", " 2", ".", "06", " id", ":", "%", "lu", "|", "bid", ":", "%", "lu", "|", "b", "v", ":", "%", "lu", "|", "sv", ":", "%", "lu", "|", "pa", ":", "%", "lu", "|", "la", ":", "%", "lu", "|", "ar", ":", "%", "lu", " 2", ".", "07", " \u2013", " 2", ".", "08", " id", ":", "%", "lu", "|", "bid", ":", "%", "lu", "|", "b", "v", ":", "%", "lu", "|", "os", ":", "%", "lu", "|", "la", ":", "%", "lu", "|", "rg", ":", "%", "lu", " 2", ".", "09", " id", ":", "%", "lu", "|", "bid", ":", "%", "lu", "|", "os", ":", "%", "lu", "|", "la", ":", "%", "lu", "|", "rg", ":", "%", "lu", " 2", ".", "10", " *", " {\"", "id", "\":", "%", "lu", ",\"", "bid", "\":", "%", "lu", ",\"", "os", "\":", "%", "lu", ",\"", "la", "\":", "%", "lu", ",\"", "rg", "\":", "%", "lu", "}", "\n", "\n", "A", " typical", " POST", " request", " is", " shown", " in", " Figure", " 2", ".", " The", " identification", " string", " is", " RC", "4", " encrypted", " and", " then", " encoded", " using", " base", "64", ".", "\n", "\n", "Since", " a", " builder", " for", " version", " 2", ".", "06", " was", " leaked", " a", " few", " years", " ago", ",", " we", " have", " seen", " quite", " a", " bit", " of", " that", " version", " of", " this", " bot", "net", " in", " our", " tele", "metry", ".", " However", ",", " according", " to", " our", " craw", "ler", " data", " the", " latest", " version", ",", " 2", ".", "10", ",", " is", " the", " most", " prevalent", ".", "\n", "\n", "The", " truly", " global", " nature", " of", " this", " threat", " is", " also", " seen", " in", " the", " diversity", " of", " the", " command", " and", " control", " servers", " its", " operators", " use", ".", " Throughout", " our", " monitoring", " of", " this", " threat", ",", " we", " were", " able", " to", " discover", " dozens", " of", " W", "au", "ch", "os", "\ufffd", "\ufffd", "s", " C", "&", "C", " servers", " every", " month", ".", " Figure", " 3", " shows", " a", " snapshot", " of", " the", " different", " T", "LD", "s", " used", " by", " the", " C", "&", "Cs", " while", " Figure", " 4", " shows", " the", " geographic", " distribution", " of", " these", " C", "&", "C", " server", " IP", "s", " when", " our", " craw", "ler", " was", " connecting", " to", " them", " in", " November", " and", " December", " 2016", ".", "\n", "\n", "Interestingly", ",", " a", " lot", " of", " samples", " we", " analyzed", " check", " the", " system", "\ufffd", "\ufffd", "s", " keyboard", " layout", " and", " does", " not", " proceed", " with", " the", " infection", " if", " it", " matches", " one", " of", " the", " following", ":", "\n", "\n", "Russia", "\n", "\n", "Ukraine", "\n", "\n", "Bel", "arus", "\n", "\n", "K", "az", "akh", "stan", "\n", "\n", "In", "fect", "ion", " vector", "\n", "\n", "As", " W", "au", "ch", "os", " is", " bought", " and", " then", " distributed", " by", " a", " variety", " of", " cyber", "crim", "inals", ",", " the", " infection", " vectors", " used", " to", " dissemin", "ate", " this", " threat", " vary", " greatly", ".", " Historically", ",", " W", "au", "ch", "os", " samples", " have", " been", " distributed", " through", " social", " media", ",", " instant", " messaging", ",", " removable", " media", ",", " spam", ",", " and", " exploit", " kits", ".", " Figure", " 5", " shows", " a", " typical", " email", " spam", " with", " a", " W", "au", "ch", "os", " sample", " attached", ".", "\n", "\n", "Pay", "-", "per", "-", "install", " malware", "\n", "\n", "As", " described", " previously", ",", " W", "au", "ch", "os", " is", " mostly", " used", " to", " distribute", " other", " malware", " families", ".", " Through", " our", " automatic", " systems", ",", " we", " were", " able", " to", " derive", " statistics", " on", " what", " was", " downloaded", " by", " the", " W", "au", "ch", "os", " bots", " we", " were", " tracking", ".", " Figure", " 6", " shows", " the", " different", " plugins", " that", " were", " downloaded", " by", " our", " craw", "ler", " when", " first", " connecting", " to", " the", " C", "&", "C", ".", "\n", "\n", "The", " first", " download", " is", " usually", " a", " plugin", " \u2014", " more", " specifically", ",", " the", " download", "er", " plugin", " we", " will", " discuss", " in", " a", " subsequent", " section", ".", " In", " terms", " of", " installed", " malware", ",", " most", " of", " the", " malware", " we", " saw", " distributed", " in", " December", " 2016", " were", " sp", "amb", "ots", " such", " as", " Win", "32", "/", "K", "as", "id", "et", ",", " Win", "32", "/", "K", "el", "ih", "os", " or", " Win", "32", "/", "L", "eth", "ic", ".", " Of", " course", ",", " as", " it", " is", " a", " pay", "-", "per", "-", "install", " scheme", ",", " these", " statistics", " tend", " to", " change", " from", " time", " to", " time", ".", " There", " was", ",", " as", " one", " might", " expect", ",", " other", " malware", " downloaded", " by", " W", "au", "ch", "os", ",", " but", " according", " to", " our", " tele", "metry", " data", ",", " the", " ones", " shown", " above", " are", " the", " most", " prevalent", ".", "\n", "\n", "Technical", " analysis", "\n", "\n", "In", " this", " section", ",", " we", " will", " present", " some", " technical", " details", " that", " have", " not", " been", " widely", " discussed", " in", " public", " and", " that", " provide", " context", " in", " light", " of", " the", " recent", " takedown", ".", " In", " particular", ",", " we", " will", " discuss", " two", " plugins", " that", " can", " provide", " side", "-", "channel", " communication", " to", " the", " bot", "master", ",", " increasing", " the", " bot", "net", "\ufffd", "\ufffd", "s", " res", "ili", "ency", " to", " a", " takedown", " operation", ".", "\n", "\n", "W", "au", "ch", "os", " variants", "\n", "\n", "First", ",", " to", " help", " our", " fellow", " researchers", " interested", " in", " this", " malware", " family", ",", " we", " will", " briefly", " describe", " the", " major", " variants", ",", " using", " ES", "ET", "\ufffd", "\ufffd", "s", " naming", " and", " to", " what", " they", " correspond", ".", "\n", "\n", "Win", "32", "/", "W", "au", "ch", "os", ".", "B", " is", " the", " most", " prevalent", " detection", " for", " 2", ".", "06", " W", "au", "ch", "os", " component", " while", " version", " 2", ".", "10", " is", " mainly", " detected", " as", " Win", "32", "/", "W", "au", "ch", "os", ".", "AW", ".", " The", " other", " variants", " grouped", " under", " the", " Win", "32", "/", "W", "au", "ch", "os", " family", " are", " either", " plugins", ",", " packed", " versions", " of", " the", " aforementioned", " versions", " or", " other", " versions", " of", " the", " W", "au", "ch", "os", " malware", ",", " such", " as", " 2", ".", "07", ",", " 2", ".", "08", " or", " 2", ".", "09", ";", " these", " are", " less", " prevalent", " according", " to", " our", " tele", "metry", " and", " thus", " less", " relevant", " to", " this", " discussion", ".", "\n", "\n", "In", " the", " latest", " version", " of", " W", "au", "ch", "os", " (", "2", ".", "10", "),", " the", " bot", " supports", " the", " current", " commands", ":", "\n", "\n", "Command", " ID", " Description", " 1", " Download", " and", " run", " a", " binary", " file", " 2", " Download", " a", " plugin", " 3", " Download", " malware", " update", " 6", " Delete", " all", " plugins", " 9", " Un", "install", "\n", "\n", "Plug", "ins", "\n", "\n", "W", "au", "ch", "os", " is", " an", " ext", "ensible", " bot", " that", " allows", " its", " owner", " to", " create", " and", " use", " custom", " plugins", ".", " However", ",", " there", " are", " some", " plugins", " that", " are", " widely", " available", " and", " that", " are", " used", " by", " many", " different", " bot", "nets", ".", " In", " this", " section", " we", " will", " review", " the", " different", " plugins", " our", " tracking", " mechanism", " was", " able", " to", " download", ".", "\n", "\n", "Title", " Detection", " name", " Description", " S", "OCK", "S", " Proxy", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "W", "au", "ch", "os", ".", "O", " Accept", "s", " connections", " and", " acts", " as", " a", " network", " proxy", " Team", "View", "er", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "W", "au", "ch", "os", ".", "BA", " Emb", "eds", " Team", "View", "er", " application", " that", " will", " launch", " in", " hidden", " mode", " and", " allow", " criminals", " to", " connect", " back", " and", " control", " compromised", " system", " Form", " Grab", "ber", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "W", "au", "ch", "os", ".", "AZ", " Ste", "als", " content", " entered", " into", " web", " forms", " by", " the", " user", "\n", "\n", "When", " a", " bot", " downloads", " a", " plugin", ",", " it", " must", " first", " decrypt", " its", " header", " with", " the", " RC", "4", " key", ".", " The", " header", " contains", " the", " unique", " key", " required", " to", " decrypt", " the", " payload", ".", " Once", " dec", "rypted", ",", " the", " last", " operation", " is", " to", " decomp", "ress", " the", " plugin", " using", " a", "PL", "ib", ".", " Once", " this", " is", " done", ",", " the", " malware", " uses", " a", " custom", " loader", " to", " load", " this", " binary", " blob", " into", " memory", ".", " As", " the", " binary", " bl", "obs", " are", " already", " memory", "-", "page", " aligned", " they", " can", " be", " loaded", " directly", " into", " memory", " and", " executed", ".", "\n", "\n", "The", " number", " of", " different", " RC", "4", " keys", " collected", " by", " our", " tracking", " system", " amongst", " all", " different", " bot", "nets", " is", " surprisingly", " small", ",", " at", " around", " 40", ".", " This", " makes", " it", " pretty", " easy", " to", " decrypt", " any", " downloaded", " components", " without", " even", " needing", " to", " analyze", " the", " sample", ".", " It", " is", " interesting", " to", " note", " here", " that", " the", " same", " RC", "4", " key", " is", " used", " to", " encrypt", " both", " sample", " strings", " and", " network", " communication", ",", " but", " reversed", " for", " the", " latter", ".", "\n", "\n", "In", " terms", " of", " C", "&", "C", " communication", ",", " all", " the", " samples", " we", " analyzed", " were", " using", " Google", "\ufffd", "\ufffd", "s", " DNS", " infrastructure", " directly", " to", " resolve", " the", " C", "&", "C", " domains", ".", " Version", " 2", ".", "06", " is", " trying", " to", " resolve", " the", " C", "&", "C", " server", " IP", " address", " using", " raw", " UDP", " sockets", " to", " 8", ".", "8", ".", "4", ".", "4", ":", "53", ".", " If", " it", " is", " unsuccessful", ",", " it", " first", " falls", " back", " to", " the", " D", "ns", "Query", "A", "()", " Windows", " API", " and", " second", " to", " the", " get", "host", "by", "name", "()", " API", ".", " Version", " 2", ".", "10", " hooks", " Get", "Add", "r", "Info", "W", "()", " and", " all", " calls", " to", " it", " are", " resolved", " using", " raw", " UDP", " packets", " to", " 8", ".", "8", ".", "4", ".", "4", ":", "53", " with", " fall", "back", " to", " the", " original", " Get", "Add", "r", "Info", "W", "()", " API", " if", " unsuccessful", ".", "\n", "\n", "New", " persistence", " mechanisms", "\n", "\n", "In", " this", " section", " we", " cover", " two", " plugins", " that", " appeared", " this", " year", " and", " that", " we", " believe", " are", " an", " attempt", " to", " prevent", " takedown", " operations", " like", " this", " one", " from", " succeeding", ",", " by", " providing", " a", " side", "-", "channel", " communication", " to", " the", " bot", "master", ".", " This", " behavior", " has", " also", " been", " discussed", " here", " [", "4", "].", "\n", "\n", "The", " first", " one", " is", " a", " USB", " spread", "er", " while", " the", " second", " implements", " a", " file", "less", " attack", " through", " a", " download", "er", " stored", " in", " the", " registry", " that", " is", " launched", " via", " a", " PowerShell", " script", " at", " startup", ".", "\n", "\n", "USB", " spread", "er", " \u2013", " Win", "32", "/", "B", "und", "p", "il", ".", "CS", "\n", "\n", "This", " plugin", " is", " able", " to", " hook", " DNS", " API", " functions", ",", " tries", " to", " spread", " through", " removable", " media", " and", " uses", " a", " D", "GA", " (", "Domain", " Generation", " Al", "gorithm", ")", " to", " download", " additional", " data", ".", "\n", "\n", "There", " is", " one", " thread", " that", " scans", " for", " inserted", " removable", " media", " and", ",", " if", " it", " finds", " any", ",", " puts", " a", " copy", " of", " the", " malware", " on", " it", ".", " The", " other", " functionality", " of", " this", " plugin", " is", " to", " hook", " DNS", " APIs", " and", " replace", " specific", " domains", " by", " a", " hard", "coded", " one", ".", " For", " example", ",", " one", " sample", " we", " analyzed", " was", " redirect", "ing", " any", " requests", " to", " these", " old", " W", "au", "ch", "os", " domains", ":", "\n", "\n", "design", "future", ".", "ru", "\n", "\n", "dis", "order", "status", ".", "ru", "\n", "\n", "atom", "ict", "ri", "via", ".", "ru", "\n", "\n", "different", "ia", ".", "ru", "\n", "\n", "to", " g", "va", "q", "70", "s", "7", "he", ".", "ru", ".", "\n", "\n", "There", " is", " also", " a", " D", "GA", " component", " to", " this", " plugin", " that", " will", " try", " to", " connect", " to", " the", " automatically", " generated", " domain", " to", " download", " additional", " data", " to", " the", " compromised", " system", ".", " The", " D", "GA", " algorithm", " pseudo", "-", "code", " can", " be", " found", " on", " our", " Github", " page", ".", " The", " URLs", " it", " tries", " to", " reach", " match", " these", " patterns", ":", "\n", "\n", "<", "d", "ga", "_", "domain", ">.", "ru", "/", "mod", "\n", "\n", "ww", "1", ".<", "d", "ga", "_", "domain", ">.", "ru", "/", "1", "\n", "\n", "ww", "2", ".<", "d", "ga", "_", "domain", ">.", "ru", "/", "2", "\n", "\n", "We", " were", " able", " to", " download", " a", " binary", " blob", " from", " this", " D", "GA", " scheme", ".", " What", " we", " obtained", " was", " an", " encrypted", " blob", " starting", " with", " \ufffd", "\ufffd", "M", "Z", "\ufffd", "\ufffd", ".", " The", " plugin", " will", " remove", " these", " two", " bytes", " and", " store", " the", " blob", " directly", " to", " the", " Windows", " registry", ".", "\n", "\n", "The", " main", " W", "au", "ch", "os", " bot", " will", " then", " decrypt", " the", " RC", "4", " encrypted", " payload", ",", " decomp", "ress", " it", " with", " a", "PL", "ib", " and", " load", " it", " as", " a", " regular", " plugin", ".", " Note", " here", " that", " the", " same", " RC", "4", " keys", " used", " to", " encrypt", " the", " plugins", " are", " used", " for", " this", " process", ".", " The", " binary", " we", " obtained", " this", " way", " was", " an", " updated", " version", " of", " the", " USB", " spread", "er", ".", " We", " therefore", " hypothesized", " that", " through", " DNS", " hook", "ing", ",", " it", " would", " be", " possible", " for", " bot", "masters", " to", " regain", " control", " of", " their", " bots", " by", " downloading", " a", " fresh", " version", " of", " this", " module", " from", " a", " domain", " they", " control", ",", " which", " will", " then", " redirect", " the", " hard", " coded", "-", "dom", "ains", " in", " the", " main", " W", "au", "ch", "os", " binary", ".", "\n", "\n", "Download", "er", "\n", "\n", "The", " last", " plugin", " we", " want", " to", " talk", " about", " is", " a", " small", " download", "er", " using", " a", " D", "GA", " to", " reach", " out", " to", " URLs", " like", " these", ",", " depending", " on", " the", " version", ":", "\n", "\n", "<", "d", "ga", "_", "domain", ">.", "ru", "/", "ld", ".", "so", "\n", "\n", "<", "d", "ga", "_", "domain", ">.", "ru", "/", "last", ".", "so", "\n", "\n", "<", "d", "ga", "_", "domain", ">.", "ru", "/", "non", "c", ".", "so", "\n", "\n", "It", " is", " used", " to", " download", " a", " binary", " blob", " that", " it", " stores", " in", " the", " registry", ".", " This", " binary", " blob", " can", " be", " dec", "rypted", " with", " the", " RC", "4", " key", " contained", " in", " the", " main", " W", "au", "ch", "os", " payload", ".", "\n", "\n", "One", " of", " the", " malware", " variants", " that", " was", " downloaded", " by", " this", " plugin", " is", " another", " download", "er", " detected", " as", " Trojan", "Download", "er", ".", "Small", ".", "AH", "I", ".", " This", " malware", " is", " particularly", " interesting", " as", " its", " sole", " purpose", " is", " to", " download", " an", " updated", " version", " of", " the", " download", "er", " plugin", " and", " store", " it", " encrypted", " in", " the", " registry", ",", " but", " with", " a", " little", " twist", ".", " It", " also", " adds", " a", " run", " key", " with", " a", " PowerShell", " script", " that", " decrypt", "s", " and", " executes", " the", " encrypted", " binary", " from", " the", " registry", " key", " each", " time", " the", " machine", " is", " started", ".", " Right", " now", ",", " this", " binary", " is", " merely", " updating", " itself", ".", " However", ",", " its", " D", "GA", " could", " be", " used", " as", " a", " secondary", " communication", " channel", " to", " download", " a", " new", " payload", " and", " regain", " control", " over", " bots", ",", " should", " someone", " try", " to", " take", " them", " over", ".", " Figure", " 7", " shows", " the", " overall", " process", ".", "\n", "\n", "It", " is", " interesting", " to", " note", " here", " that", " we", " have", " also", " seen", " Nec", "urs", ".", "B", " being", " downloaded", " through", " D", "GA", " and", " through", " this", " plugin", ".", " However", ",", " the", " vast", " majority", " of", " downloads", " we", " saw", " were", " for", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "Small", ".", "AH", "I", ".", " In", " fact", ",", " the", " latter", " malware", " has", " been", " seen", " numerous", " times", ",", " according", " to", " our", " cloud", " statistics", ".", " Interestingly", ",", " we", " saw", " a", " lot", " of", " activity", " in", " August", " 2016", " for", " this", " particular", " module", ",", " via", " our", " craw", "ler", ",", " but", " nothing", " since", " then", ".", " We", " did", " not", " investigate", " further", " to", " try", " to", " determine", " whether", " we", " were", " just", " black", "listed", " or", " if", " they", " only", " tested", " this", " feature", " for", " a", " brief", " period", " of", " time", ".", "\n", "\n", "Conclusion", "\n", "\n", "W", "au", "ch", "os", " is", " an", " old", " bot", "net", " that", " has", " been", " reinvent", "ing", " itself", " through", " the", " years", ".", " Its", " command", " and", " control", " infrastructure", " is", " one", " of", " the", " many", " that", " ES", "ET", " tracks", ".", " This", " information", " is", " vital", " in", " order", " to", " keep", " track", " of", " changes", " in", " malware", " behavior", " and", " to", " be", " able", " to", " provide", " action", "able", " data", " to", " help", " with", " disruption", " and", " takedown", " efforts", ".", "\n", "\n", "W", "au", "ch", "os", " uses", " old", " tricks", " to", " compromise", " new", " systems", ".", " Users", " should", " be", " cautious", " when", " opening", " files", " on", " removable", " media", ",", " as", " well", " as", " files", " they", " receive", " through", " email", " or", " social", " media", ".", " If", " you", " believe", " that", " you", " are", " infected", " with", " W", "au", "ch", "os", ",", " we", " have", " a", " free", " tool", " for", " you", ".", " ES", "ET", " products", " currently", " detect", " thousands", " of", " variations", " of", " W", "au", "ch", "os", " modules", " along", " with", " the", " different", " malware", " distributed", " by", " the", " W", "au", "ch", "os", " bot", "nets", ".", "\n", "\n", "Special", " thanks", " to", " Jur", "aj", " J", "\u00e1", "no", "\u0161", "\u00ed", "k", ",", " Viktor", " Luc", "za", ",", " Filip", " Maz", "\u00e1n", ",", " Z", "olt", "\u00e1n", " Rus", "n", "\u00e1", "k", " and", " Richard", " V", "ida", " for", " their", " help", " in", " this", " research", ".", "\n", "\n", "H", "ashes", "\n\n", "\n", "\n", "SHA", "-", "1", " Detection", " CC", "9", "AC", "168", "474", "27", "CC", "159", "09", "A", "60", "B", "130", "CB", "7", "E", "67", "D", "2", "D", "380", "4", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "W", "au", "ch", "os", ".", "B", " B", "CD", "45", "398", "98", "3", "EB", "58", "B", "33", "294", "DF", "E", "8", "52", "B", "57", "B", "1", "ADD", "5", "117", "E", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "W", "au", "ch", "os", ".", "AK", " 6", "FA", "5", "E", "48", "AD", "60", "B", "537", "61", "A", "427", "25", "A", "4", "B", "9", "EC", "12", "B", "8", "59", "63", "F", "90", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "Small", ".", "AH", "I", " 6", "D", "505", "15", "80", "DA", "7", "35", "709", "44", "B", "BE", "79", "A", "9", "EA", "7", "F", "2", "E", "4", "D", "00", "66", "99", " Win", "32", "/", "Tro", "jan", "Download", "er", ".", "W", "au", "ch", "os", ".", "O", "\n", "\n", "References"]