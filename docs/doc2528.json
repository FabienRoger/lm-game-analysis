["How", " to", " scrape", " websites", " with", " Python", " and", " Beautiful", "S", "oup", "\n", "\n", "Justin", " Y", "ek", " Bl", "ocked", " Un", "block", " Follow", " Following", " Jun", " 10", ",", " 2017", "\n", "\n", "There", " is", " more", " information", " on", " the", " Internet", " than", " any", " human", " can", " absorb", " in", " a", " lifetime", ".", " What", " you", " need", " is", " not", " access", " to", " that", " information", ",", " but", " a", " scalable", " way", " to", " collect", ",", " organize", ",", " and", " analyze", " it", ".", "\n", "\n", "You", " need", " web", " scraping", ".", "\n", "\n", "Web", " scraping", " automatically", " extracts", " data", " and", " presents", " it", " in", " a", " format", " you", " can", " easily", " make", " sense", " of", ".", " In", " this", " tutorial", ",", " we", "\ufffd", "\ufffd", "ll", " focus", " on", " its", " applications", " in", " the", " financial", " market", ",", " but", " web", " scraping", " can", " be", " used", " in", " a", " wide", " variety", " of", " situations", ".", "\n", "\n", "If", " you", "\ufffd", "\ufffd", "re", " an", " avid", " investor", ",", " getting", " closing", " prices", " every", " day", " can", " be", " a", " pain", ",", " especially", " when", " the", " information", " you", " need", " is", " found", " across", " several", " web", "pages", ".", " We", "\ufffd", "\ufffd", "ll", " make", " data", " extraction", " easier", " by", " building", " a", " web", " scra", "per", " to", " retrieve", " stock", " indices", " automatically", " from", " the", " Internet", ".", "\n", "\n", "Getting", " Started", "\n", "\n", "We", " are", " going", " to", " use", " Python", " as", " our", " scraping", " language", ",", " together", " with", " a", " simple", " and", " powerful", " library", ",", " Beautiful", "S", "oup", ".", "\n", "\n", "For", " Mac", " users", ",", " Python", " is", " pre", "-", "installed", " in", " OS", " X", ".", " Open", " up", " Terminal", " and", " type", " python", " --", "version", ".", " You", " should", " see", " your", " python", " version", " is", " 2", ".", "7", ".", "x", ".", "\n", "\n", ".", " You", " should", " see", " your", " python", " version", " is", " 2", ".", "7", ".", "x", ".", " For", " Windows", " users", ",", " please", " install", " Python", " through", " the", " official", " website", ".", "\n", "\n", "Next", " we", " need", " to", " get", " the", " Beautiful", "S", "oup", " library", " using", " pip", ",", " a", " package", " management", " tool", " for", " Python", ".", "\n", "\n", "In", " the", " terminal", ",", " type", ":", "\n", "\n", "easy", "_", "install", " pip", "\n", "\n", "p", "ip", " install", " Beautiful", "S", "oup", "4", "\n", "\n", "Note", ":", " If", " you", " fail", " to", " execute", " the", " above", " command", " line", ",", " try", " adding", " sudo", " in", " front", " of", " each", " line", ".", "\n", "\n", "The", " Basics", "\n", "\n", "Before", " we", " start", " jumping", " into", " the", " code", ",", " let", "\ufffd", "\ufffd", "s", " understand", " the", " basics", " of", " HTML", " and", " some", " rules", " of", " scraping", ".", "\n", "\n", "HTML", " tags", "\n", "\n", "If", " you", " already", " understand", " HTML", " tags", ",", " feel", " free", " to", " skip", " this", " part", ".", "\n", "\n", "<", "!", "DO", "CT", "Y", "PE", " html", ">", "\n", "\n", "<", "html", ">", "\n", "\n", "<", "head", ">", "\n", "\n", "</", "head", ">", "\n", "\n", "<", "body", ">", "\n", "\n", "<", "h", "1", ">", " First", " Sc", "rap", "ing", " </", "h", "1", ">", "\n", "\n", "<", "p", ">", " Hello", " World", " </", "p", ">", "\n", "\n", "<", "body", ">", "\n", "\n", "</", "html", ">", "\n", "\n", "This", " is", " the", " basic", " syntax", " of", " an", " HTML", " webpage", ".", " Every", " <", "tag", ">", " serves", " a", " block", " inside", " the", " webpage", ":", "\n", "\n", "1", ".", " <", "!", "DO", "CT", "Y", "PE", " html", ">", " :", " HTML", " documents", " must", " start", " with", " a", " type", " declaration", ".", "\n", "\n", "2", ".", " The", " HTML", " document", " is", " contained", " between", " <", "html", ">", " and", " </", "html", ">", ".", "\n", "\n", "3", ".", " The", " meta", " and", " script", " declaration", " of", " the", " HTML", " document", " is", " between", " <", "head", ">", " and", " </", "head", ">", ".", "\n", "\n", "4", ".", " The", " visible", " part", " of", " the", " HTML", " document", " is", " between", " <", "body", ">", " and", " </", "body", ">", " tags", ".", "\n", "\n", "5", ".", " Title", " head", "ings", " are", " defined", " with", " the", " <", "h", "1", ">", " through", " <", "h", "6", ">", " tags", ".", "\n", "\n", "6", ".", " Par", "agraph", "s", " are", " defined", " with", " the", " <", "p", ">", " tag", ".", "\n", "\n", "Other", " useful", " tags", " include", " <", "a", ">", " for", " hyper", "links", ",", " <", "table", ">", " for", " tables", ",", " <", "tr", ">", " for", " table", " rows", ",", " and", " <", "td", ">", " for", " table", " columns", ".", "\n", "\n", "Also", ",", " HTML", " tags", " sometimes", " come", " with", " id", " or", " class", " attributes", ".", " The", " id", " attribute", " specifies", " a", " unique", " id", " for", " an", " HTML", " tag", " and", " the", " value", " must", " be", " unique", " within", " the", " HTML", " document", ".", " The", " class", " attribute", " is", " used", " to", " define", " equal", " styles", " for", " HTML", " tags", " with", " the", " same", " class", ".", " We", " can", " make", " use", " of", " these", " ", "ids", " and", " classes", " to", " help", " us", " locate", " the", " data", " we", " want", ".", "\n", "\n", "For", " more", " information", " on", " HTML", " tags", ",", " id", " and", " class", ",", " please", " refer", " to", " W", "3", "School", "s", " Tutorial", "s", ".", "\n", "\n", "Sc", "rap", "ing", " Rules", "\n", "\n", "You", " should", " check", " a", " website", "\ufffd", "\ufffd", "s", " Terms", " and", " Conditions", " before", " you", " scrape", " it", ".", " Be", " careful", " to", " read", " the", " statements", " about", " legal", " use", " of", " data", ".", " Usually", ",", " the", " data", " you", " scrape", " should", " not", " be", " used", " for", " commercial", " purposes", ".", " Do", " not", " request", " data", " from", " the", " website", " too", " aggressively", " with", " your", " program", " (", "also", " known", " as", " spam", "ming", "),", " as", " this", " may", " break", " the", " website", ".", " Make", " sure", " your", " program", " behaves", " in", " a", " reasonable", " manner", " (", "i", ".", "e", ".", " acts", " like", " a", " human", ").", " One", " request", " for", " one", " webpage", " per", " second", " is", " good", " practice", ".", " The", " layout", " of", " a", " website", " may", " change", " from", " time", " to", " time", ",", " so", " make", " sure", " to", " revisit", " the", " site", " and", " rewrite", " your", " code", " as", " needed", "\n", "\n", "In", "spect", "ing", " the", " Page", "\n", "\n", "Let", "\ufffd", "\ufffd", "s", " take", " one", " page", " from", " the", " Bloomberg", " Quote", " website", " as", " an", " example", ".", "\n", "\n", "As", " someone", " following", " the", " stock", " market", ",", " we", " would", " like", " to", " get", " the", " index", " name", " (", "S", "&", "P", " 500", ")", " and", " its", " price", " from", " this", " page", ".", " First", ",", " right", "-", "click", " and", " open", " your", " browser", "\ufffd", "\ufffd", "s", " inspector", " to", " inspect", " the", " webpage", ".", "\n", "\n", "Try", " hovering", " your", " cursor", " on", " the", " price", " and", " you", " should", " be", " able", " to", " see", " a", " blue", " box", " surrounding", " it", ".", " If", " you", " click", " it", ",", " the", " related", " HTML", " will", " be", " selected", " in", " the", " browser", " console", ".", "\n", "\n", "From", " the", " result", ",", " we", " can", " see", " that", " the", " price", " is", " inside", " a", " few", " levels", " of", " HTML", " tags", ",", " which", " is", " <", "div", " class", "=\"", "basic", "-", "quote", "\">", " \u2192", " <", "div", " class", "=\"", "price", "-", "container", " up", "\">", " \u2192", " <", "div", " class", "=\"", "price", "\">", ".", "\n", "\n", "Similarly", ",", " if", " you", " hover", " and", " click", " the", " name", " \ufffd", "\ufffd", "S", "&", "P", " 500", " Index", "\ufffd", "\ufffd", ",", " it", " is", " inside", " <", "div", " class", "=\"", "basic", "-", "quote", "\">", " and", " <", "h", "1", " class", "=\"", "name", "\">", ".", "\n", "\n", "Now", " we", " know", " the", " unique", " location", " of", " our", " data", " with", " the", " help", " of", " class", " tags", ".", "\n", "\n", "Jump", " into", " the", " Code", "\n", "\n", "Now", " that", " we", " know", " where", " our", " data", " is", ",", " we", " can", " start", " coding", " our", " web", " scra", "per", ".", " Open", " your", " text", " editor", " now", "!", "\n", "\n", "First", ",", " we", " need", " to", " import", " all", " the", " libraries", " that", " we", " are", " going", " to", " use", ".", "\n", "\n", "#", " import", " libraries", "\n", "\n", "import", " ur", "ll", "ib", "2", "\n", "\n", "from", " b", "s", "4", " import", " Beautiful", "S", "oup", "\n", "\n", "Next", ",", " declare", " a", " variable", " for", " the", " url", " of", " the", " page", ".", "\n", "\n", "#", " specify", " the", " url", "\n", "\n", "quote", "_", "page", " =", " \ufffd", "\ufffd", "http", "://", "www", ".", "bl", "oom", "berg", ".", "com", "/", "quote", "/", "SP", "X", ":", "IND", "'", "\n", "\n", "Then", ",", " make", " use", " of", " the", " Python", " ur", "ll", "ib", "2", " to", " get", " the", " HTML", " page", " of", " the", " url", " declared", ".", "\n", "\n", "#", " query", " the", " website", " and", " return", " the", " html", " to", " the", " variable", " \ufffd", "\ufffd", "page", "\ufffd", "\ufffd", "\n", "\n", "page", " =", " ur", "ll", "ib", "2", ".", "url", "open", "(", "quote", "_", "page", ")", "\n", "\n", "Finally", ",", " parse", " the", " page", " into", " Beautiful", "S", "oup", " format", " so", " we", " can", " use", " Beautiful", "S", "oup", " to", " work", " on", " it", ".", "\n", "\n", "#", " parse", " the", " html", " using", " beautiful", " soup", " and", " store", " in", " variable", " `", "s", "oup", "`", "\n", "\n", "s", "oup", " =", " Beautiful", "S", "oup", "(", "page", ",", " \ufffd", "\ufffd", "html", ".", "parser", "\ufffd", "\ufffd", ")", "\n", "\n", "Now", " we", " have", " a", " variable", ",", " soup", ",", " containing", " the", " HTML", " of", " the", " page", ".", " Here", "\ufffd", "\ufffd", "s", " where", " we", " can", " start", " coding", " the", " part", " that", " extracts", " the", " data", ".", "\n", "\n", "Remember", " the", " unique", " layers", " of", " our", " data", "?", " Beautiful", "S", "oup", " can", " help", " us", " get", " into", " these", " layers", " and", " extract", " the", " content", " with", " find", "()", ".", " In", " this", " case", ",", " since", " the", " HTML", " class", " name", " is", " unique", " on", " this", " page", ",", " we", " can", " simply", " query", " <", "div", " class", "=\"", "name", "\">", ".", "\n", "\n", "#", " Take", " out", " the", " <", "div", ">", " of", " name", " and", " get", " its", " value", "\n", "\n", "name", "_", "box", " =", " soup", ".", "find", "(", "\ufffd", "\ufffd", "h", "1", "\ufffd", "\ufffd", ",", " att", "rs", "={", "\ufffd", "\ufffd", "class", "\ufffd", "\ufffd", ":", " \ufffd", "\ufffd", "name", "\ufffd", "\ufffd", "})", "\n", "\n", "After", " we", " have", " the", " tag", ",", " we", " can", " get", " the", " data", " by", " getting", " its", " text", ".", "\n", "\n", "name", " =", " name", "_", "box", ".", "text", ".", "strip", "()", " #", " strip", "()", " is", " used", " to", " remove", " starting", " and", " trailing", "\n", "\n", "print", " name", "\n", "\n", "Similarly", ",", " we", " can", " get", " the", " price", " too", ".", "\n", "\n", "#", " get", " the", " index", " price", "\n", "\n", "price", "_", "box", " =", " soup", ".", "find", "(", "\ufffd", "\ufffd", "div", "\ufffd", "\ufffd", ",", " att", "rs", "={", "\ufffd", "\ufffd", "class", "\ufffd", "\ufffd", ":", "\ufffd", "\ufffd", "price", "\ufffd", "\ufffd", "})", "\n", "\n", "price", " =", " price", "_", "box", ".", "text", "\n", "\n", "print", " price", "\n", "\n", "When", " you", " run", " the", " program", ",", " you", " should", " be", " able", " to", " see", " that", " it", " prints", " out", " the", " current", " price", " of", " the", " S", "&", "P", " 500", " Index", ".", "\n", "\n", "Export", " to", " Excel", " CSV", "\n", "\n", "Now", " that", " we", " have", " the", " data", ",", " it", " is", " time", " to", " save", " it", ".", " The", " Excel", " Comm", "a", " Sep", "ar", "ated", " Format", " is", " a", " nice", " choice", ".", " It", " can", " be", " opened", " in", " Excel", " so", " you", " can", " see", " the", " data", " and", " process", " it", " easily", ".", "\n", "\n", "But", " first", ",", " we", " have", " to", " import", " the", " Python", " c", "sv", " module", " and", " the", " dat", "etime", " module", " to", " get", " the", " record", " date", ".", " Insert", " these", " lines", " to", " your", " code", " in", " the", " import", " section", ".", "\n", "\n", "import", " c", "sv", "\n", "\n", "from", " dat", "etime", " import", " dat", "etime", "\n", "\n", "At", " the", " bottom", " of", " your", " code", ",", " add", " the", " code", " for", " writing", " data", " to", " a", " c", "sv", " file", ".", "\n", "\n", "#", " open", " a", " c", "sv", " file", " with", " append", ",", " so", " old", " data", " will", " not", " be", " erased", "\n", "\n", "with", " open", "(", "\ufffd", "\ufffd", "index", ".", "csv", "\ufffd", "\ufffd", ",", " \ufffd", "\ufffd", "a", "\ufffd", "\ufffd", ")", " as", " c", "sv", "_", "file", ":", "\n", "\n", "writer", " =", " c", "sv", ".", "writer", "(", "csv", "_", "file", ")", "\n", "\n", "writer", ".", "writer", "ow", "([", "name", ",", " price", ",", " dat", "etime", ".", "now", "()", "])", "\n", "\n", "Now", " if", " you", " run", " your", " program", ",", " you", " should", " able", " to", " export", " an", " index", ".", "csv", " file", ",", " which", " you", " can", " then", " open", " with", " Excel", ",", " where", " you", " should", " see", " a", " line", " of", " data", ".", "\n", "\n", "So", " if", " you", " run", " this", " program", " everyday", ",", " you", " will", " be", " able", " to", " easily", " get", " the", " S", "&", "P", " 500", " Index", " price", " without", " rum", "m", "aging", " through", " the", " website", "!", "\n", "\n", "Going", " Further", " (", "Advanced", " uses", ")", "\n", "\n", "Multiple", " Ind", "ices", "\n", "\n", "So", " scraping", " one", " index", " is", " not", " enough", " for", " you", ",", " right", "?", " We", " can", " try", " to", " extract", " multiple", " indices", " at", " the", " same", " time", ".", "\n", "\n", "First", ",", " modify", " the", " quote", "_", "page", " into", " an", " array", " of", " URLs", ".", "\n", "\n", "Then", " we", " change", " the", " data", " extraction", " code", " into", " a", " for", " loop", ",", " which", " will", " process", " the", " URLs", " one", " by", " one", " and", " store", " all", " the", " data", " into", " a", " variable", " data", " in", " tu", "ples", ".", "\n", "\n", "#", " for", " loop", "\n", "\n", "data", " =", " []", "\n", "\n", "for", " pg", " in", " quote", "_", "page", ":", "\n", "\n", "#", " query", " the", " website", " and", " return", " the", " html", " to", " the", " variable", " \ufffd", "\ufffd", "page", "\ufffd", "\ufffd", "\n", "\n", "page", " =", " ur", "ll", "ib", "2", ".", "url", "open", "(", "pg", ")", "\n", "\n", "#", " parse", " the", " html", " using", " beautiful", " soap", " and", " store", " in", " variable", " `", "s", "oup", "`", "\n", "\n", "s", "oup", " =", " Beautiful", "S", "oup", "(", "page", ",", " \ufffd", "\ufffd", "html", ".", "parser", "\ufffd", "\ufffd", ")", "\n", "\n", "#", " Take", " out", " the", " <", "div", ">", " of", " name", " and", " get", " its", " value", "\n", "\n", "name", "_", "box", " =", " soup", ".", "find", "(", "\ufffd", "\ufffd", "h", "1", "\ufffd", "\ufffd", ",", " att", "rs", "={", "\ufffd", "\ufffd", "class", "\ufffd", "\ufffd", ":", " \ufffd", "\ufffd", "name", "\ufffd", "\ufffd", "})", "\n", "\n", "name", " =", " name", "_", "box", ".", "text", ".", "strip", "()", " #", " strip", "()", " is", " used", " to", " remove", " starting", " and", " trailing", "\n", "\n", "#", " get", " the", " index", " price", "\n", "\n", "price", "_", "box", " =", " soup", ".", "find", "(", "\ufffd", "\ufffd", "div", "\ufffd", "\ufffd", ",", " att", "rs", "={", "\ufffd", "\ufffd", "class", "\ufffd", "\ufffd", ":", "\ufffd", "\ufffd", "price", "\ufffd", "\ufffd", "})", "\n", "\n", "price", " =", " price", "_", "box", ".", "text", "\n", "\n", "#", " save", " the", " data", " in", " tuple", "\n", "\n", "data", ".", "append", "((", "name", ",", " price", "))", "\n", "\n", "Also", ",", " modify", " the", " saving", " section", " to", " save", " data", " row", " by", " row", ".", "\n", "\n", "#", " open", " a", " c", "sv", " file", " with", " append", ",", " so", " old", " data", " will", " not", " be", " erased", "\n", "\n", "with", " open", "(", "\ufffd", "\ufffd", "index", ".", "csv", "\ufffd", "\ufffd", ",", " \ufffd", "\ufffd", "a", "\ufffd", "\ufffd", ")", " as", " c", "sv", "_", "file", ":", "\n", "\n", "writer", " =", " c", "sv", ".", "writer", "(", "csv", "_", "file", ")", "\n", "\n", "#", " The", " for", " loop", "\n", "\n", "for", " name", ",", " price", " in", " data", ":", "\n", "\n", "writer", ".", "writer", "ow", "([", "name", ",", " price", ",", " dat", "etime", ".", "now", "()", "])", "\n", "\n", "R", "er", "un", " the", " program", " and", " you", " should", " be", " able", " to", " extract", " two", " indices", " at", " the", " same", " time", "!", "\n", "\n", "Advanced", " Sc", "rap", "ing", " Techniques", "\n", "\n", "Beaut", "iful", "S", "oup", " is", " simple", " and", " great", " for", " small", "-", "scale", " web", " scraping", ".", " But", " if", " you", " are", " interested", " in", " scraping", " data", " at", " a", " larger", " scale", ",", " you", " should", " consider", " using", " these", " other", " alternatives", ":", "\n", "\n", "Sc", "rap", "y", ",", " a", " powerful", " python", " scraping", " framework", " Try", " to", " integrate", " your", " code", " with", " some", " public", " APIs", ".", " The", " efficiency", " of", " data", " retrieval", " is", " much", " higher", " than", " scraping", " web", "pages", ".", " For", " example", ",", " take", " a", " look", " at", " Facebook", " Graph", " API", ",", " which", " can", " help", " you", " get", " hidden", " data", " which", " is", " not", " shown", " on", " Facebook", " web", "pages", ".", " Consider", " using", " a", " database", " backend", " like", " MySQL", " to", " store", " your", " data", " when", " it", " gets", " too", " large", ".", "\n", "\n", "Ad", "opt", " the", " DR", "Y", " Method", "\n", "\n", "DR", "Y", " stands", " for", " \ufffd", "\ufffd", "Don", "\ufffd", "\ufffd", "t", " Repeat", " Yourself", "\ufffd", "\ufffd", ",", " try", " to", " automate", " your", " everyday", " tasks", " like", " this", " person", ".", " Some", " other", " fun", " projects", " to", " consider", " might", " be", " keeping", " track", " of", " your", " Facebook", " friends", "\ufffd", "\ufffd", " active", " time", " (", "with", " their", " consent", " of", " course", "),", " or", " grabbing", " a", " list", " of", " topics", " in", " a", " forum", " and", " trying", " out", " natural", " language", " processing", " (", "which", " is", " a", " hot", " topic", " for", " Artificial", " Intelligence", " right", " now", ")!", "\n", "\n", "If", " you", " have", " any", " questions", ",", " please", " feel", " free", " to", " leave", " a", " comment", " below", ".", "\n", "\n", "References", "\n", "\n", "http", "://", "www", ".", "greg", "red", "a", ".", "com", "/", "2013", "/", "03", "/", "03", "/", "web", "-", "sc", "rap", "ing", "-", "101", "-", "with", "-", "python", "/", "\n", "\n", "http", "://", "www", ".", "analy", "tics", "vid", "hya", ".", "com", "/", "blog", "/", "2015", "/", "10", "/", "begin", "ner", "-", "guide", "-", "web", "-", "sc", "rap", "ing", "-", "beaut", "iful", "-", "s", "oup", "-", "python", "/", "\n", "\n", "This", " article", " was", " originally", " published", " on", " Alt", "itude", " Labs", "\ufffd", "\ufffd", " blog", " and", " was", " written", " by", " our", " software", " engineer", ",", " Leonard", " M", "ok", ".", " Alt", "itude", " Labs", " is", " a", " software", " agency", " that", " specializes", " in", " personalized", ",", " mobile", "-", "first", " React", " apps", "."]