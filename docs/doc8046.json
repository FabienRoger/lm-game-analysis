["M", "igr", "ating", " V", "MD", "K", "s", " or", " virtual", " mode", " RD", "Ms", " to", " V", "V", "ols", " is", " easy", ":", " Storage", " v", "Motion", ".", " No", " downtime", ",", " no", " pre", "-", "creat", "ing", " of", " volumes", ".", " Simple", " and", " fast", ".", " But", " physical", " mode", " RD", "Ms", " are", " a", " bit", " different", ".", "\n", "\n", "As", " we", " all", " be", "gr", "udging", "ly", " admit", " there", " are", " still", " more", " than", " a", " few", " Raw", " Device", " M", "appings", " out", " there", " in", " VMware", " environments", ".", " Two", " primary", " use", " cases", ":", "\n", "\n", "Microsoft", " Cl", "ust", "ering", ".", " Virtual", " disks", " can", " only", " be", " used", " for", " Fail", "over", " Cl", "ust", "ering", " if", " all", " of", " the", " V", "Ms", " are", " on", " the", " same", " ES", "Xi", " hosts", " which", " feels", " a", " bit", " like", " defeating", " the", " purpose", ".", " So", " most", " opt", " for", " RD", "Ms", " so", " they", " can", " split", " the", " V", "Ms", " up", ".", "\n", "\n", ".", " Virtual", " disks", " can", " only", " be", " used", " for", " Fail", "over", " Cl", "ust", "ering", " if", " all", " of", " the", " V", "Ms", " are", " on", " the", " same", " ES", "Xi", " hosts", " which", " feels", " a", " bit", " like", " defeating", " the", " purpose", ".", " So", " most", " opt", " for", " RD", "Ms", " so", " they", " can", " split", " the", " V", "Ms", " up", ".", " Physical", " to", " virtual", ".", " Sharing", " copies", " of", " data", " between", " physical", " and", " virtual", " or", " some", " other", " hyper", "visor", " is", " the", " most", " common", " reason", " I", " see", " these", " days", ".", " Mostly", " around", " database", " dev", "/", "test", " scenarios", ".", " The", " concept", " of", " a", " V", "MD", "K", " can", " keep", " your", " data", " from", " being", " easily", " shared", ",", " so", " RD", "Ms", " provide", " a", " workaround", ".", "\n", "\n", "So", " when", " it", " comes", " to", " V", "V", "ols", " the", " same", " questions", " linger", ".", " Can", " I", " do", " these", " things", "?", " Well", " the", " first", " issue", " is", " being", " resolved", " with", " V", "V", "ols", " in", " the", " next", " v", "Sphere", " release", " according", " to", " public", " statements", " made", " by", " VMware", " at", " VM", "world", ".", " So", " until", " that", " release", ",", " RD", "Ms", " will", " still", " be", " needed", " for", " that", " use", " case", ".", "\n", "\n", "But", " the", " other", " use", " case", " works", " great", " on", " V", "V", "ols", ".", " V", "V", "ols", " can", " be", " used", " and", " shared", " just", " like", " RD", "Ms", ".", " And", " in", " many", " ways", " they", " are", " much", " better", ".", "\n", "\n", "So", " how", " do", " I", " then", " migrate", " an", " R", "DM", " to", " a", " V", "Vol", "?", " Well", " there", " are", " a", " couple", " of", " options", ".", "\n", "\n", "Please", " note", " that", " I", " am", " doing", " this", " with", " the", " Pure", " Storage", " Flash", "Array", ",", " array", " functions", " may", " vary", " from", " vendor", " to", " vendor", ",", " but", " theoretically", " if", " the", " array", " doesn", "\ufffd", "\ufffd", "t", " block", " it", ",", " it", " is", " all", " allowed", " from", " a", " VMware", " perspective", ".", "\n", "\n", "So", " in", " the", " below", " scenarios", ",", " I", " have", " a", " VM", " with", " a", " physical", " mode", " R", "DM", " with", " my", " SQL", " database", " on", " it", ".", " In", " this", " case", " it", " happens", " to", " be", " a", " copy", " of", " my", " SQL", " DB", " for", " my", " v", "RA", " environment", ".", " Though", " it", " doesn", "\ufffd", "\ufffd", "t", " really", " matter", " what", " the", " data", " is", ".", "\n", "\n", "Disk", " m", "gr", ":", "\n", "\n", "SQL", " files", ":", "\n", "\n", "Used", " space", ":", "\n", "\n", "R", "DM", " config", ":", "\n", "\n", "Option", " 1", ":", " Create", " a", " new", " V", "Vol", " and", " Copy", "\n", "\n", "The", " first", " option", " is", " to", " create", " a", " similar", " size", " V", "Vol", " and", " copy", " the", " content", " from", " the", " R", "DM", " to", " the", " V", "Vol", " via", " array", "-", "based", " copying", ".", "\n", "\n", "So", " I", " have", " my", " p", "R", "DM", ":", "\n", "\n", "The", " first", " step", " is", " to", " remove", " the", " R", "DM", " (", "you", " don", "\ufffd", "\ufffd", "t", " necessarily", " have", " to", " do", " it", " in", " this", " order", ",", " but", " this", " ensures", " you", " have", " a", " qu", "ies", "ced", " R", "DM", ").", "\n", "\n", "Then", " create", " a", " V", "Vol", " of", " the", " same", " size", " on", " the", " same", " array", " as", " the", " R", "DM", ".", "\n", "\n", "Then", " go", " to", " the", " array", " and", " copy", " the", " R", "DM", " to", " the", " V", "Vol", ".", " Depending", " on", " your", " array", " this", " may", " or", " may", " not", " be", " possible", " and", " if", " it", " is", ",", " how", " this", " is", " done", " might", " vary", ".", "\n", "\n", "First", " find", " your", " R", "DM", " volumes", ",", " then", " identify", " your", " V", "Vol", " volume", ".", " My", " R", "DM", " volume", " name", " on", " my", " Flash", "Array", " is", " \ufffd", "\ufffd", "rd", "m", "volume", "\ufffd", "\ufffd", ".", "\n", "\n", "Since", " the", " rest", " of", " my", " VM", " is", " V", "Vol", "-", "based", ",", " I", " can", " see", " the", " VM", " on", " my", " array", ",", " I", " see", " my", " new", " data", " V", "Vol", " (", "50", " GB", ").", "\n", "\n", "Cl", "icking", " on", " it", " I", " can", " see", " the", " details", " of", " the", " V", "Vol", ".", "\n", "\n", "Now", " all", " I", " have", " to", " do", " is", " copy", " the", " R", "DM", " to", " the", " V", "Vol", ".", "\n", "\n", "Copy", " the", " R", "DM", " to", " the", " V", "Vol", ":", "\n", "\n", "Over", "write", " the", " contents", ":", "\n", "\n", "And", " then", " online", " the", " disk", " in", " the", " VM", " and", " we", " see", " the", " contents", ":", "\n", "\n", "This", " is", " a", " nice", " option", " for", " array", " like", " AF", "As", " such", " as", " the", " Flash", "Array", " that", " can", " do", " metadata", " copies", " between", " volumes", " (", "meaning", " no", " data", " is", " actually", " moved", " or", " copied", ",", " instead", " just", " some", " metadata", " pointers", ",", " making", " it", " 100", "%", " ded", "up", "ed", " and", " instantaneous", ").", "\n", "\n", "Pros", " of", " this", " method", ":", "\n", "\n", "Fast", "est", " option", "\u2013", "the", " least", " downtime", ".", " Eas", "ily", " script", "able", ".", "\n", "\n", "Cons", " of", " this", " method", ":", "\n", "\n", "Need", " to", " delete", " the", " old", " R", "DM", ".", " Need", " to", " use", " the", " array", " tools", " and", " VMware", " tools", ".", " May", " not", " work", " with", " all", " array", " vendors", " implementations", " of", " V", "V", "ols", ".", " Semi", "-", "off", "line", "\u2013", "you", " don", "\ufffd", "\ufffd", "t", " need", " to", " shut", " the", " VM", " down", ",", " but", " the", " data", " being", " copied", " can", "\ufffd", "\ufffd", "t", " be", " accessed", " through", " the", " process", ".", "\n", "\n", "Option", " 2", ":", " Offline", " Migration", "\n", "\n", "This", " is", " the", " most", " array", " ag", "nostic", " (", "with", " the", " exception", " of", " the", " last", " option", ")", " and", " can", " be", " done", " mainly", " inside", " of", " VMware", " tools", " (", "with", " the", " exception", " of", " deleting", " the", " old", " R", "DM", ").", " This", " does", " involve", " shutting", " the", " VM", " down", " though", ".", "\n", "\n", "When", " a", " VM", " is", " shut", " down", " and", " there", " is", " a", " physical", " mode", " R", "DM", " presented", " to", " the", " VM", ",", " ES", "Xi", " can", " actually", " copy", " the", " data", " from", " the", " R", "DM", " and", " create", " a", " virtual", " disk", " from", " it", " and", " remove", " the", " R", "DM", " and", " replace", " it", " with", " the", " virtual", " disk", ".", "\n", "\n", "Then", " choose", " to", " migrate", " the", " VM", " and", " choose", " the", " storage", " option", ":", "\n", "\n", "Then", " choose", " your", " target", " dat", "ast", "ore", ",", " which", " for", " V", "V", "ols", " should", " be", " a", " V", "Vol", " dat", "ast", "ore", ".", " But", " note", " you", " will", " get", " an", " error", " at", " first", ":", "\n", "\n", "This", " is", " because", " the", " target", " dat", "ast", "ore", " doesn", "\ufffd", "\ufffd", "t", " support", " RD", "Ms", ".", " You", " need", " to", " change", " the", " VM", " storage", " policy", " to", " something", " else", ".", " So", " the", " default", " V", "Vol", " policy", ",", " or", " any", " V", "Vol", "-", "based", " policy", " you", " create", " yourself", ".", " You", " can", " specify", " this", " policy", " for", " all", " virtual", " disks", " (", "like", " I", " did", " below", ")", " or", " individually", " by", " clicking", " advanced", ".", "\n", "\n", "Once", " done", ",", " the", " migration", " will", " occur", ".", " Depending", " on", " the", " size", " of", " your", " R", "DM", " this", " can", " take", " some", " time", ".", "\n", "\n", "Once", " done", ",", " the", " VM", " is", " converted", " entirely", " to", " V", "V", "ols", ".", " Both", " the", " boot", " virtual", " disk", " I", " have", " and", " the", " R", "DM", ".", " The", " 200", " GB", " virtual", " disk", " is", " now", " a", " 200", " GB", " V", "Vol", " and", " the", " 50", " GB", " R", "DM", " is", " now", " a", " 50", " GB", " V", "Vol", "!", "\n", "\n", "On", " my", " array", ":", "\n", "\n", "In", " the", " VM", " settings", ":", "\n\n", "\n", "\n", "Now", " the", " old", " R", "DM", " has", " not", " been", " deleted", "\u2013", "it", " is", " just", " no", " longer", " presented", " to", " the", " VM", ".", " So", " you", " can", " dispose", " of", " the", " R", "DM", " volume", " as", " you", " normally", " would", ".", "\n", "\n", "You", " can", " now", " power", "-", "on", " the", " VM", " and", " log", " back", " in", ".", " Since", " the", " boot", " V", "MD", "K", " was", " a", " virtual", " disk", " before", " and", " goes", " through", " the", " v", "SC", "SI", " stack", ",", " it", " will", " look", " the", " same", " as", " before", ".", " The", " R", "DM", " though", " is", " now", " a", " new", " volume", ",", " with", " the", " same", " data", " on", " it", ",", " so", " you", " will", " need", " to", " online", " it", ",", " in", " the", " case", " of", " Windows", ".", " Different", " OS", "es", " will", " have", " different", " processes", ":", "\n", "\n", "Make", " it", " online", ":", "\n", "\n", "Now", " the", " E", ":", " drive", " is", " automatically", " back", " and", " ready", " to", " go", "!", "\n", "\n", "Pros", " of", " this", " method", ":", "\n", "\n", "All", " migration", " done", " in", " VMware", ".", " Migration", " in", " this", " way", " will", " work", " with", " all", " storage", " vendors", " that", " support", " V", "V", "ols", ".", " No", " need", " to", " add", " or", " remove", " any", " storage", " manually", " to", " the", " VM", ".", "\n", "\n", "Cons", " of", " this", " method", ":", "\n", "\n", "M", "ight", " take", " the", " longest", ".", " Still", " need", " to", " delete", " the", " R", "DM", "(", "s", ").", " Totally", " offline", " process", ".", "\n", "\n", "Option", " 3", ":", " Convert", " the", " R", "DM", " to", " a", " V", "Vol", "\n", "\n", "The", " next", " option", " is", " the", " clean", "est", ",", " but", " also", " may", " or", " may", " not", " work", " with", " all", " V", "Vol", " implementations", ".", " This", " requires", " turning", " the", " R", "DM", " into", " a", " V", "Vol", ".", "\n", "\n", "A", " V", "Vol", " is", " not", " really", " a", " special", " volume", ".", " A", " V", "Vol", " is", " really", " only", " defined", " by", " two", " things", ":", " how", " it", " is", " accessed", " via", " L", "UN", " IDs", " (", "it", " is", " a", " sub", "-", "l", "un", ").", " And", " that", " it", " has", " a", " V", "Vol", " U", "UID", ".", " But", " this", " means", " that", " if", " the", " array", " allows", " you", " to", " connect", " any", " volume", " as", " a", " sub", "l", "un", " and", " you", " can", " assign", " any", " volume", " a", " U", "UID", ",", " any", " array", " volume", " can", " be", " a", " V", "Vol", ".", "\n", "\n", "So", " to", " turn", " a", " R", "DM", " into", " a", " V", "Vol", ",", " you", " just", " need", " to", " disconnect", " it", " from", " the", " host", ",", " assign", " it", " a", " U", "UID", " and", " then", " tell", " VMware", " that", " it", " exists", ".", " VMware", " will", " then", " (", "as", " needed", ")", " connect", " the", " volume", " up", " to", " a", " host", " as", " sub", "-", "l", "un", " and", " disconnect", " it", " as", " needed", ".", "\n", "\n", "I", " wrote", " a", " blog", " post", " on", " this", " process", " here", ".", "\n", "\n", "In", " short", ",", " VMware", " has", " a", " SDK", " operation", " that", " can", " take", " an", " existing", " volume", " and", " \ufffd", "\ufffd", "turn", "\ufffd", "\ufffd", " it", " into", " a", " V", "Vol", ".", " All", " that", " means", " is", " creating", " a", " V", "MD", "K", " pointer", " file", " that", " tells", " VMware", " what", " underlying", " volume", " is", " to", " host", " the", " data", " written", " by", " the", " guest", ".", " When", " that", " volume", " is", " needed", " by", " a", " VM", ",", " ES", "Xi", " tells", " the", " array", " to", " connect", " it", " as", " needed", ".", "\n", "\n", "There", " is", " a", " method", " called", " import", "Un", "managed", "Snap", "shot", " under", " the", " virtual", "Disk", "Manager", " in", " v", "Center", " that", " allows", " you", " to", " do", " this", ".", "\n", "\n", "This", " method", " takes", " in", " three", " parameters", ":", "\n", "\n", "Virtual", " disk", " path", ".", " So", " dat", "ast", "ore", " in", " brackets", " [", "my", "dat", "ast", "ore", "]", " and", " then", " the", " path", " folder", "/", "folder", "/", "my", "disk", ".", "v", "md", "k", " Dat", "ac", "enter", ".", " If", " you", " are", " connecting", " to", " a", " single", " ES", "Xi", " host", " this", " is", " optional", ",", " but", " otherwise", " you", " need", " to", " specify", " this", ".", " The", " SDK", " call", " needs", " to", " Mo", "Ref", " (", "managed", " object", " reference", ")", " of", " the", " dat", "ac", "enter", " V", "Vol", " ID", ".", " v", "Center", " needs", " to", " know", " the", " actual", " V", "Vol", " you", " want", " to", " import", " and", " you", " specify", " this", " via", " the", " V", "Vol", " ID", ",", " which", " is", " a", " unique", " identifier", " for", " a", " given", " V", "Vol", ".", "\n", "\n", "So", " I", " am", " back", " to", " having", " my", " p", "R", "DM", ":", "\n", "\n", "The", " first", " step", " is", " to", " remove", " the", " R", "DM", ":", "\n", "\n", "Then", " disconnect", " it", " as", " a", " standard", " L", "UN", ":", "\n", "\n", "Conf", "irm", " the", " disconnect", ":", "\n", "\n", "The", " next", " step", " is", " to", " assign", " a", " U", "UID", ".", " Valid", " V", "Vol", " U", "UID", "s", " are", " in", " one", " of", " the", " following", " formats", ":", "\n", "\n", "RFC", " 4", "122", " format", ",", " \ufffd", "\ufffd", "r", "fc", "4", "122", ".", "xxxxxxxx", "\u2010", "xxxx", "\u2010", "xxxx", "\u2010", "xxxx", "\u2010", "xxxxxxxx", "xxxx", "\ufffd", "\ufffd", "\n", "\n", "N", "AA", " 128", "\u2010", "bit", " U", "UID", ",", " \ufffd", "\ufffd", "na", "a", ".", "xxxxxxxx", "xxxxxxxx", "xxxxxxxx", "xxxxxxxx", "\ufffd", "\ufffd", "\n", "\n", "N", "AA", " 64", "\u2010", "bit", " U", "UID", ",", " \ufffd", "\ufffd", "na", "a", ".", "xxxxxxxx", "xxxxxxxx", "\ufffd", "\ufffd", "\n", "\n", "E", "UI", " 64", "\u2010", "bit", " U", "UID", " \ufffd", "\ufffd", "e", "ui", ".", "xxxxxxxx", "xxxxxxxx", "\ufffd", "\ufffd", "\n", "\n", "Talk", " to", " your", " array", " vendor", " for", " what", " they", " use", " and", " how", " it", " can", " be", " assigned", ".", " I", " assigned", " my", " volume", " that", " was", " formerly", " used", " as", " a", " R", "DM", " a", " RFC", " 4", "122", " U", "UID", ":", "\n", "\n", "r", "fc", "4", "122", ".", "9", "ab", "7", "efe", "9", "-", "6", "121", "-", "40", "80", "-", "b", "05", "c", "-", "456", "ca", "11", "d", "12", "12", "\n", "\n", "I", " used", " this", " site", " to", " do", " it", " https", "://", "www", ".", "uu", "id", "gener", "ator", ".", "net", "/,", " though", " most", " scripting", " tools", " have", " the", " ability", " to", " do", " it", " for", " you", " too", ".", "\n", "\n", "Now", " I", " can", " use", " the", " import", "Un", "managed", "Snap", "shot", " SDK", " call", " to", " import", " it", " in", ".", "\n", "\n", "If", " I", " look", " at", " the", " home", " directory", " of", " my", " V", "Vol", " VM", " I", " see", " one", " V", "MD", "K", " pointer", " file", " to", " its", " boot", " V", "Vol", ".", "\n", "\n", "It", "\ufffd", "\ufffd", "s", " path", "/", "name", " is", " [", "Flash", "Array", "-", "SC", "1", "]", " R", "DM", "VM", "/", "R", "DM", "VM", ".", "v", "md", "k", ".", " So", " I", " will", " make", " my", " new", " one", " [", "Flash", "Array", "-", "SC", "1", "]", " R", "DM", "VM", "/", "R", "DM", "VM", "_", "1", ".", "v", "md", "k", ".", "\n", "\n", "I", " ran", " the", " following", " Power", "CL", "I", " (", "after", " connecting", " to", " my", " v", "Center", "):", "\n", "\n", "$", "virtual", "Disk", "Manager", " =", " Get", "-", "View", " (", "Get", "-", "View", " Service", "Instance", ").", "Content", ".", "virtual", "Disk", "Manager", " $", "v", "vol", "path", " =", " \"[", "Flash", "Array", "-", "SC", "1", "]", " R", "DM", "VM", "/", "R", "DM", "VM", "_", "1", ".", "v", "md", "k", "\"", " $", "dc", " =", " get", "-", "dat", "ac", "enter", " \"", "M", "ountain", " View", "\"", " $", "uu", "id", " =", " \"", "r", "fc", "4", "122", ".", "9", "ab", "7", "efe", "9", "-", "6", "121", "-", "40", "80", "-", "b", "05", "c", "-", "456", "ca", "11", "d", "12", "12", "\"", " $", "virtual", "Disk", "Manager", ".", "Import", "Un", "managed", "Snap", "shot", "($", "v", "vol", "path", ",", "$", "dc", ".", "Ext", "ension", "Data", ".", "Mo", "Ref", ",", "$", "uu", "id", ")", "\n", "\n", "If", " I", " refresh", " my", " VM", " directory", " I", " see", " a", " V", "MD", "K", ":", "\n", "\n", "Because", " remember", ",", " in", " a", " V", "Vol", " world", " all", " a", " V", "MD", "K", " is", " is", " a", " pointer", " to", " the", " physical", " volume", ".", "\n", "\n", "So", " now", " I", " can", " connect", " my", " V", "Vol", " to", " my", " VM", " by", " just", " adding", " it", " as", " an", " existing", " virtual", " disk", " in", " the", " VM", " settings", ":", "\n", "\n", "Then", " navigating", " to", " my", " V", "Vol", " dat", "ast", "ore", " and", " choosing", " that", " V", "MD", "K", " in", " the", " directory", " I", " placed", " it", ":", "\n", "\n", "Once", " again", " we", " will", " see", " my", " file", " system", " available", " on", " that", " volume", " in", " my", " VM", ":", "\n", "\n", "Now", " since", " it", " is", " in", " use", " by", " a", " powered", "-", "on", " VM", ",", " we", " can", " see", " on", " the", " array", " it", " is", " connected", " automatically", " to", " that", " host", " as", " a", " sub", "-", "l", "un", ":", "\n", "\n", "Pros", " of", " this", " method", ":", "\n", "\n", "Fast", " option", "\u2013", "just", " a", " few", " more", " operations", " than", " the", " previous", ".", " Eas", "ily", " script", "able", ".", " No", " need", " to", " delete", " the", " R", "DM", "\u2013", "you", " can", " re", "-", "use", " it", ".", "\n", "\n", "Cons", " of", " this", " method", ":", "\n", "\n", "Your", " array", " may", " not", " have", " a", " method", " to", " assign", " an", " existing", " volume", " a", " U", "UID", ".", " You", " need", " to", " figure", " out", " how", " to", " generate", " one", ".", " You", " still", " need", " to", " disconnect", " and", " remove", " the", " R", "DM", " from", " the", " VM", ".", " Requires", " use", " of", " both", " VMware", " tools", " and", " array", " tools", ".", " Semi", "-", "off", "line", "\u2013", "you", " don", "\ufffd", "\ufffd", "t", " need", " to", " shut", " the", " VM", " down", ",", " but", " the", " data", " being", " copied", " can", "\ufffd", "\ufffd", "t", " be", " accessed", " through", " the", " process", ".", "\n", "\n", "Option", " 4", ":", " Host", "-", "based", " Cop", "ying", "\n", "\n", "This", " is", " the", " last", " resort", ".", " You", " can", " simply", " have", " both", " present", " and", " copy", " the", " files", " using", " host", " tools", ".", " Though", " this", " could", " potentially", " be", " the", " only", " fully", " online", " method", " too", ".", " If", " the", " application", " using", " those", " files", " has", " some", " way", " of", " rel", "ocating", " files", " on", " the", " fly", "\u2013", "this", " could", " be", " the", " only", " option", " if", " you", " want", " to", " move", " it", " online", ".", " Though", " if", " the", " files", " are", " large", " it", " could", " be", " slow", " and", " resource", " intensive", ".", "\n", "\n", "Conclusion", "\n", "\n", "I", " think", " my", " vote", " is", " for", " option", " 1", ".", " This", " is", " this", " simplest", " and", " easiest", " to", " script", ".", " But", " in", " the", " end", " all", " of", " them", " work", " great", "\u2013", "and", " there", " are", " plenty", " of", " options", " for", " moving", " RD", "Ms", " to", " V", "V", "ols", ".", " Once", " it", " is", " a", " V", "Vol", ",", " you", " can", " now", " clone", ",", " Storage", " v", "Motion", ",", " snapshot", " etc", ",", " etc", "."]