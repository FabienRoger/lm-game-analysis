["During", " our", " inaugural", " Uber", " Technology", " Day", ",", " software", " engineer", " A", "ime", "e", " Luc", "ido", " delivered", " a", " presentation", " on", " the", " history", " of", " Uber", " Engineering", "\ufffd", "\ufffd", "s", " Android", " code", "base", ".", " In", " this", " article", ",", " she", " expands", " on", " the", " reasons", " behind", " Uber", "\ufffd", "\ufffd", "s", " decision", " to", " build", " a", " mon", "ore", "po", " to", " support", " the", " growth", " of", " our", " Android", " development", ".", "\n", "\n", "Today", " is", " the", " day", " you", " are", " going", " to", " build", " a", " brand", " new", " Android", " app", "\u2014", "and", " good", " for", " you", ",", " getting", " started", " is", " always", " the", " hardest", " part", ".", " What", " is", " the", " first", " thing", " you", " do", "?", "\n", "\n", "If", " you", " are", " like", " me", ",", " you", " will", " create", " a", " new", " project", " in", " Android", " Studio", ".", " You", " make", " a", " main", " activity", ",", " hook", " up", " Grad", "le", ",", " and", " maybe", " even", " create", " a", " git", " repository", " so", " that", " your", " friends", " can", " collaborate", " with", " you", " on", " the", " app", ".", " Congratulations", "!", " Your", " code", " organization", " now", " resembles", " the", " first", " version", " of", " the", " Uber", " Android", " rider", " app", ".", "\n", "\n", "When", " we", " launched", " our", " Android", " rider", " app", " in", " 2010", ",", " we", " were", " a", " small", " company", ".", " Uber", " Engineering", " was", " under", " a", " dozen", " people", ".", " We", " had", " one", " contractor", " working", " on", " the", " Android", " platform", ",", " and", "\u2014", "if", " you", " can", " believe", " it", "\u2014", "we", " did", " not", " even", " have", " an", " Android", " driver", " app", ".", " So", ",", " our", " single", " Android", " engineer", " wrote", " the", " first", " version", " of", " the", " rider", " app", " in", " a", " single", " repository", ":", " one", " big", " box", " of", " code", ".", "\n", "\n", "Creating", " a", " new", " app", " using", " a", " single", " repository", " had", " some", " benefits", " early", " on", ":", "\n", "\n", "Out", " of", " the", " Box", " Android", ":", " A", " single", " repo", " is", " the", " free", " code", " structure", " offered", " in", " Eclipse", ",", " the", " IDE", " used", " for", " the", " first", " version", " of", " the", " Android", " rider", " app", ".", " Today", " in", " 2017", ",", " building", " an", " early", " code", "base", " in", " a", " single", " repository", " is", " even", " easier", " than", " it", " was", " in", " 2010", " because", " we", " have", " Android", " Studio", ",", " which", " partners", " closely", " with", " Android", " libraries", ".", " But", " no", " matter", " which", " IDE", " you", " use", ",", " an", " IDE", " will", " provide", " a", " single", " repository", " structure", " out", " of", " the", " box", " and", " basic", " tool", "ing", ",", " like", " build", " scripts", " and", " git", " integration", "\n", "\n", "Fast", " Development", " for", " Small", " Teams", ":", " Since", " all", " dependencies", " are", " in", " one", " place", ",", " u", " sing", " a", " single", " repository", " allows", " things", " to", " move", " fast", " for", " a", " small", " team", " of", " engineers", " by", " simpl", "ifying", " code", "-", "sharing", " and", " ref", "act", "oring", ".", "\n", "\n", "For", " several", " years", ",", " the", " state", " of", " Android", " at", " Uber", " was", " small", " scale", ".", " By", " 2013", ",", " we", " had", " hired", " our", " first", " full", "-", "time", " Android", " engineer", ",", " and", " over", " this", " period", " our", " engineering", " team", " had", " more", " than", " doubled", ".", " Only", " then", " did", " we", " start", " building", " an", " Android", " driver", " app", ".", "\n", "\n", "Building", " the", " driver", " app", " gave", " us", " the", " opportunity", " to", " improve", " our", " code", "base", " organization", ".", " The", " rider", " app", " still", " existed", " in", " a", " single", " code", "base", ",", " but", " since", " we", " now", " had", " the", " resources", " and", " tool", "ing", " to", " extract", " reusable", " components", ",", " we", " did", " just", " that", ".", " The", " core", " partner", " code", " existed", " in", " its", " own", " separate", " repository", ",", " but", " we", " also", " built", " out", " a", " library", " full", " of", " reusable", " components", " for", " the", " two", " apps", ".", "\n", "\n", "This", " general", " structure", " served", " us", " well", " for", " awhile", ",", " but", " in", " 2014", ",", " our", " subsequent", " growth", " called", " for", " a", " different", " solution", ".", " Uber", " had", " over", " a", " hundred", " engineers", ".", " The", " Android", " engineering", " team", " had", " grown", " in", " size", " from", " one", " to", " eight", " engineers", ".", " As", " our", " number", " of", " engineers", " was", " growing", ",", " so", " too", " did", " our", " code", "base", ".", "\n", "\n", "We", " took", " a", " look", " at", " the", " direction", " that", " we", " were", " heading", " and", " we", " realized", " that", " if", " we", " did", " not", " change", ",", " we", " were", " going", " to", " encounter", " the", " following", " issues", ":", "\n", "\n", "Long", " Build", " Times", ":", " Our", " initial", " Eclipse", " project", " used", " Ant", " as", " its", " default", " build", " tool", ",", " which", " has", " a", " tendency", " to", " slow", " down", " when", " dealing", " with", " large", " code", "b", "ases", ".", "\n", "\n", "Feature", " Cou", "pling", ":", " A", " downside", " of", " sharing", " code", " easily", " is", " that", " it", " sometimes", " can", " be", " over", " shared", ".", " As", " the", " number", " of", " Android", " app", " features", " increased", ",", " we", " worried", " that", " features", " would", " start", " unnecessarily", " coupling", " together", ".", "\n", "\n", "Bro", "ken", " Master", ":", " How", " often", " have", " you", " re", "based", " your", " change", " onto", " the", " latest", " master", ",", " hit", " a", " build", " failure", "\u2026", " and", " then", " spent", " an", " hour", " debugging", " it", ".", " Then", " you", " realized", " that", " your", " build", " failure", " had", " nothing", " to", " do", " with", " your", " own", " code", ",", " and", " everything", " to", " do", " with", " the", " person", " reb", "asing", " their", " code", " without", " re", "-", "running", " tests", " right", " before", " you", "!", " If", " you", " are", " like", " me", ",", " you", " have", " been", " on", " both", " sides", " of", " that", " equation", ".", " With", " multiple", " engineers", " contributing", " to", " the", " same", " code", "base", " and", " without", " investing", " heavily", " in", " continuous", " integration", " tool", "ing", " (", "see", " Submit", " Que", "ue", " below", "),", " you", " risk", " people", " landing", " diff", "s", " at", " the", " same", " time", " that", " lie", " in", " conflict", " with", " one", " another", ".", " This", " means", " a", " broken", " master", " and", " wasted", " hours", ".", "\n", "\n", "So", " during", " the", " 2013", "-", "2014", " time", " period", ",", " we", " made", " a", " series", " of", " changes", " to", " transition", " to", " a", " mult", "ire", "po", " code", "base", " in", " order", " to", " preempt", " these", " problems", ".", " In", " 2013", " we", " moved", " our", " rider", " app", " from", " Eclipse", " with", " Ant", " to", " Int", "elli", "J", " with", " M", "aven", ",", " allowing", " us", " to", " pull", " artifacts", " from", " a", " server", " and", " breaking", " our", " library", " code", "base", " into", " 20", "+", " smaller", " dec", "ou", "pled", " rep", "os", ".", " (", "For", " example", ",", " networking", " was", " moved", " to", " its", " own", " repository", ",", " later", " to", " be", " pulled", " into", " the", " consumer", " apps", " via", " a", " M", "aven", " repository", " at", " compile", " time", ".)", " Sim", "ultane", "ously", ",", " we", " transitioned", " our", " build", " scripts", " to", " Grad", "le", ",", " marking", " our", " first", " foray", " into", " a", " mult", "ire", "po", " world", ".", "\n", "\n", "Our", " Uber", " mult", "ire", "po", " code", "base", " consisted", " of", " several", " little", " code", "b", "ases", " each", " representing", " a", " single", ",", " discrete", " idea", " stored", " as", " artifacts", " that", " are", " pulled", " in", " at", " compile", " time", " by", " the", " rider", " and", " driver", " apps", ".", " Each", " repository", " is", " like", " a", " smaller", " box", " of", " code", ",", " with", " its", " own", " IDE", " project", ",", " git", " repository", ",", " and", " build", " script", ".", " By", " moving", " to", " mult", "ire", "po", ",", " we", " ensured", " a", " solid", ",", " future", "-", "proof", " architecture", ",", " circumvent", "ing", " problems", " like", " long", " build", " times", ",", " feature", " coupling", ",", " and", " a", " broken", " master", ".", "\n", "\n", "So", " the", " question", " now", " becomes", ":", " why", " did", " we", " not", " start", " with", " a", " mult", "ire", "po", " from", " the", " beginning", "?", " In", " one", " word", ":", " overhead", ".", " Breaking", " features", " out", " in", " their", " own", " repositories", " requires", " a", " significant", " amount", " of", " time", " and", " expertise", " to", " set", " up", ".", " It", " requires", " in", "-", "depth", " knowledge", " touching", " multiple", " areas", " such", " as", " M", "aven", ",", " Grad", "le", ",", " VPN", "s", ",", " and", " artifact", " management", ".", " This", " knowledge", " down", " payment", " only", " becomes", " worthwhile", " as", " the", " scale", " of", " the", " company", " increases", ".", "\n", "\n", "For", " nearly", " three", " years", " we", " operated", ",", " scaled", ",", " and", " thri", "ved", " with", " a", " mult", "ire", "po", " organization", ".", " But", " by", " 2016", ",", " our", " mult", "ire", "po", " setup", " began", " to", " reach", " its", " limits", ",", " and", " our", " developers", " but", "ted", " up", " against", " the", " following", " new", " issues", ":", "\n", "\n", "Arch", "itect", "ure", " Sil", "os", ":", " With", " strong", " dec", "ou", "pling", " of", " features", ",", " architecture", " sil", "os", " began", " to", " form", ".", " We", " built", " a", " uniform", " l", "int", " system", " early", " on", " that", " prevented", " styl", "istic", " sil", "os", ",", " but", " that", " did", " nothing", " to", " prevent", " different", " teams", " from", " using", " a", " wide", " variety", " of", " patterns", " from", " Activities", " and", " Frag", "ments", ",", " to", " M", "VC", " architecture", " and", " our", " own", " homegrown", " architecture", ".", " On", " some", " level", ",", " architectural", " sil", "os", " are", " expected", " and", " even", " good", ":", " engineers", " should", " be", " able", " to", " choose", " an", " architecture", " that", " fits", " their", " use", " case", ".", " But", " as", " we", " scaled", ",", " our", " team", " began", " to", " work", " between", " libraries", " more", " and", " more", ".", " This", " in", " turn", " meant", " learning", " new", " architectures", " on", " a", " regular", " basis", ",", " which", " meant", " a", " steep", " and", " consistent", " learning", " curve", ".", " As", " a", " cor", "oll", "ary", ",", " a", " specific", " library", "\ufffd", "\ufffd", "s", " architecture", " implemented", " incorrectly", " could", " make", " integration", " with", " the", " consumer", " apps", " or", " other", " features", " difficult", " or", " even", " impossible", " without", " significant", " code", " ref", "act", "oring", ".", "\n", "\n", "D", "epend", "ency", " Hell", ":", " Over", " time", ",", " our", " dependency", " graph", " grew", " in", " complexity", ",", " and", " eventually", " we", " built", " out", " a", " tool", " to", " ensure", " that", " new", " diff", "s", " were", " not", " causing", " breaking", " changes", ".", " This", " solution", " definitely", " reduced", " the", " effects", " of", " dependency", " hell", ",", " but", " depending", " on", " how", " many", " libraries", " your", " change", " affected", ",", " even", " running", " the", " tool", " over", " a", " code", "base", " could", " take", " frustrating", "ly", " long", ".", " Moreover", ",", " fixing", " whatever", " problems", " we", " found", " could", " require", " days", " of", " engineering", " work", ":", " identifying", " the", " problem", " dependency", ",", " fixing", " the", " offending", " code", ",", " and", " cutting", " new", " versions", " of", " the", " affected", " repositories", ".", "\n", "\n", "Long", " Build", " Times", ":", " Our", " code", "base", " size", " started", " to", " reach", " the", " limits", " of", " what", " Grad", "le", " could", " quickly", " build", ".", " A", " fresh", " app", " build", " could", " take", " 15", "+", " minutes", ";", " a", " series", " of", " small", " XML", " tweaks", " could", " cum", "ul", "atively", " waste", " hours", " of", " build", " time", " over", " a", " day", " of", " development", ".", "\n", "\n", "So", " what", " did", " we", " do", "?", "\n", "\n", "The", " answer", " to", " our", " problems", ":", " investing", " in", " a", " mon", "ore", "po", ",", " a", " single", " repository", " containing", " multiple", ",", " independent", " projects", ".", " A", " mon", "ore", "po", " exists", " in", " one", " code", "base", ",", " just", " like", " our", " initial", " rider", " app", ".", " But", " unlike", " our", " initial", " rider", " app", ",", " this", " new", " instant", "iation", " of", " all", " code", " in", " one", " box", " contained", " multiple", " logical", " components", " that", " operate", " independently", ".", " Thus", ",", " we", " can", " now", " invest", " the", " time", " and", " resources", " into", " tool", "ing", " and", " architecture", " necessary", " to", " fix", " many", " drawbacks", " of", " a", " large", ",", " single", " repo", ":", "\n", "\n", "IDE", " Support", ":", " Android", " Studio", " is", " now", " considered", " the", " default", ",", " lightweight", " Android", " developer", " platform", ",", " but", " it", " is", " hardly", " the", " only", " one", ".", " With", " a", " large", " mon", "ore", "po", ",", " we", " have", " found", " that", " Int", "elli", "J", " works", " very", " well", " for", " our", " current", " size", " \u2014", " with", " a", " few", " adjustments", " made", " possible", " by", " Int", "elli", "J", " being", " open", " source", ".", "\n", "\n", "Long", " Build", " Times", ":", " Uber", " recently", " switched", " from", " Grad", "le", " to", " Buck", ",", " which", " is", " a", " modular", " build", " system", ".", " Buck", " was", " easy", " to", " integrate", " with", " because", " our", " code", " was", " already", " broken", " out", " into", " discrete", " components", ".", " Our", " home", "-", "grown", " Grad", "le", " plugin", " Ok", "B", "uck", " gave", " us", " a", " smooth", " transition", " which", " resulted", " in", " build", " times", " of", " fifteen", " plus", " minutes", " an", " app", " reduced", " to", " below", " five", " minutes", " for", " a", " fresh", " build", ",", " and", " under", " one", " minute", " for", " an", " incremental", " build", ".", "\n", "\n", "Bro", "ken", " Master", ":", " We", " recently", " introduced", " a", " system", " called", " Submit", " Que", "ue", " which", " reb", "ases", " changes", " on", " master", " and", " runs", " a", " customizable", " set", " of", " tests", " before", " merging", " them", ".", " This", " prevents", " engineers", " from", " pushing", " code", " that", " breaks", " the", " build", ",", " keeping", " master", " sque", "aky", " clean", " for", " everyone", " else", " using", " it", ".", "\n", "\n", "This", " may", " seem", " like", " a", " lot", " of", " overhead", ",", " and", " it", " is", ".", " There", " is", " no", " out", " of", " the", " box", " way", " to", " create", " a", " mon", "ore", "po", ",", " because", " there", " are", " only", " a", " handful", " of", " companies", " right", " now", " that", " have", " the", " scale", " requiring", " it", ".", " But", " for", " every", " pain", " point", " that", " we", " predicted", " back", " in", " 2013", ",", " we", " now", " have", " the", " time", ",", " expertise", ",", " and", " resources", " to", " build", " tool", "ing", " to", " prevent", " them", " from", " ham", "pering", " our", " productivity", ".", "\n", "\n", "As", " you", " can", " see", ",", " it", " took", " Uber", " many", " years", " to", " get", " to", " this", " latest", " stage", " of", " development", ".", " When", " we", " were", " a", " small", ",", " scra", "ppy", " team", " of", " just", " a", " few", " engineers", ",", " we", " did", " not", " have", " the", " time", " or", " resources", " to", " create", " Submit", " Que", "ue", " or", " set", " up", " Buck", ".", " But", " our", " early", " fore", "sight", " encouraged", " architectural", " decisions", " that", " have", " allowed", " us", " to", " scale", " as", " quickly", " as", " we", " have", ".", " Now", " that", " we", " have", " scaled", " even", " further", ",", " we", " can", " invest", " in", " a", " development", " down", " payment", " to", " ensure", " that", " the", " future", " service", " growth", " is", " seamless", " and", " efficient", ".", "\n", "\n", "Developer", " productivity", " is", " hard", " but", " important", " work", ",", " and", " with", " every", " incremental", " improvement", ",", " we", " are", " not", " just", " better", "ing", " Uber", " but", " the", " Android", " community", " at", " large", ".", " If", " growing", " Uber", "\ufffd", "\ufffd", "s", " Android", " mon", "ore", "po", " sounds", " interesting", " to", " you", ",", " considering", " joining", " our", " mobile", " engineering", " team", "\u2014", "we", " are", " hiring", "!", "\n", "\n", "Software", " engineers", " JJ", " Ford", " and", " G", "aut", "am", " Kor", "lam", " also", " contributed", " to", " this", " article", ".", "\n", "\n", "Photo", " Header", " Credit", ":", " \ufffd", "\ufffd", "Rest", "ing", " re", "ed", "bucks", " in", " late", " afternoon", "\ufffd", "\ufffd", " by", " Conor", " My", "hr", "v", "old", ",", " South", " Lu", "ang", "wa", " National", " Park", ",", " Zamb", "ia", "."]