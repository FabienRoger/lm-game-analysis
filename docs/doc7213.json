["Error", " should", " compute", ".", "stack", " and", " friends", " laz", "ily", "\n", "\n", "\u200b", "https", "://", "bugs", ".", "webkit", ".", "org", "/", "show", "_", "bug", ".", "cgi", "?", "id", "=", "17", "66", "45", "\n\n", "\n", "\n", "Reviewed", " by", " Sa", "am", " Bar", "ati", ".", "\n", "\n", "J", "ST", "ests", ":", "\n\n", "\n", "\n", "Ch", "akra", "Core", ".", "y", "aml", ":", " Skip", " test", " that", " was", " testing", " non", "-", "standard", " behavior", " of", " these", " fields", ".", "\n", "\n", "micro", "bench", "marks", "/", "new", "-", "error", ".", "js", ":", " Added", ".", "\n", "\n", "micro", "bench", "marks", "/", "throw", ".", "js", ":", " Added", ".", "\n", "\n", "Source", "/", "Java", "Script", "Core", ":", "\n\n", "\n\n", "\n", "\n", "Building", " the", " string", " portion", " of", " the", " stack", " trace", " after", " we", " walk", " the", " stack", " accounts", " for", " most", " of", "\n", "\n", "the", " cost", " of", " computing", " the", ".", "stack", " property", ".", " So", ",", " this", " patch", " makes", " Error", "Instance", " hold", " onto", " the", "\n", "\n", "Vector", "<", "Stack", "Frame", ">", " so", " that", " it", " can", " build", " the", " string", " only", " once", " it", "'s", " really", " needed", ".", "\n\n", "\n", "\n", "This", " is", " an", " enormous", " speed", "-", "up", " for", " programs", " that", " allocate", " and", " throw", " exceptions", ".", "\n\n", "\n", "\n", "It", "'s", " a", " 5", ".", "6", "x", " speed", "-", "up", " for", " \"", "new", " Error", "()", "\"", " with", " a", " stack", " that", " is", " 4", " functions", " deep", ".", "\n\n", "\n", "\n", "It", "'s", " a", " 2", ".", "2", "x", " speed", "-", "up", " for", " throwing", " and", " catching", " an", " Error", ".", "\n\n", "\n", "\n", "It", "'s", " a", " 1", ".", "17", "x", " speed", "-", "up", " for", " the", " W", "SL", " test", " suite", " (", "which", " throws", " a", " lot", ").", "\n\n", "\n", "\n", "It", "'s", " a", " significant", " speed", "-", "up", " on", " many", " of", " our", " existing", " try", "-", "catch", " micro", "bench", "marks", ".", " For", " example", ",", "\n", "\n", "d", "elta", "-", "blue", "-", "try", "-", "catch", " is", " 1", ".", "16", "x", " faster", ".", "\n\n", "\n", "\n", "inter", "pre", "ter", "/", "Inter", "pre", "ter", ".", "cpp", ":", "\n", "\n", "(", "J", "SC", "::", "Get", "Stack", "Tr", "ace", "Fun", "ctor", "::", "Get", "Stack", "Tr", "ace", "Fun", "ctor", "):", "\n", "\n", "(", "J", "SC", "::", "Get", "Stack", "Tr", "ace", "Fun", "ctor", "::", "operator", "()", " const", "):", "\n", "\n", "(", "J", "SC", "::", "Inter", "pre", "ter", "::", "get", "Stack", "Tr", "ace", "):", "\n\n", "\n", "\n", "inter", "pre", "ter", "/", "Inter", "pre", "ter", ".", "h", ":", "\n", "\n", "runtime", "/", "Error", ".", "cpp", ":", "\n", "\n", "(", "J", "SC", "::", "get", "Stack", "Tr", "ace", "):", "\n", "\n", "(", "J", "SC", "::", "get", "Byte", "code", "Offset", "):", "\n", "\n", "(", "J", "SC", "::", "add", "Error", "Info", "):", "\n", "\n", "(", "J", "SC", "::", "add", "Error", "Info", "And", "Get", "Byte", "code", "Offset", "):", " De", "leted", ".", "\n\n", "\n", "\n", "runtime", "/", "Error", ".", "h", ":", "\n", "\n", "runtime", "/", "Error", "Instance", ".", "cpp", ":", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "Error", "Instance", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "fin", "ish", "Cre", "ation", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "material", "ize", "Error", "Info", "If", "Need", "ed", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "vis", "it", "Children", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "get", "Own", "Property", "Slot", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "get", "Own", "Non", "Index", "Property", "Names", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "define", "Own", "Property", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "put", "):", "\n", "\n", "(", "J", "SC", "::", "Error", "Instance", "::", "delete", "Property", "):", "\n\n", "\n", "\n", "runtime", "/", "Error", "Instance", ".", "h", ":", "\n", "\n", "runtime", "/", "Exception", ".", "cpp", ":", "\n", "\n", "(", "J", "SC", "::", "Exception", "::", "vis", "it", "Children", "):", "\n", "\n", "(", "J", "SC", "::", "Exception", "::", "fin", "ish", "Cre", "ation", "):", "\n\n", "\n", "\n", "runtime", "/", "Exception", ".", "h", ":", "\n", "\n", "runtime", "/", "Stack", "Frame", ".", "cpp", ":", "\n", "\n", "(", "J", "SC", "::", "Stack", "Frame", "::", "vis", "it", "Children", "):", "\n\n", "\n", "\n", "runtime", "/", "Stack", "Frame", ".", "h", ":", "\n", "\n", "(", "J", "SC", "::", "Stack", "Frame", "::", "Stack", "Frame", "):", "\n\n"]